#ifndef COM_NGOS_DEVTOOLS_IMAGE_BUILDER_OTHER_SECTIONHEADERCHARACTERISTICSFLAGS_H                                                                                                                   // Colorize: green
#define COM_NGOS_DEVTOOLS_IMAGE_BUILDER_OTHER_SECTIONHEADERCHARACTERISTICSFLAGS_H                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <Qt>                                                                                                                                                                                            // Colorize: green
#include <stdio.h>                                                                                                                                                                                       // Colorize: green
#include <string.h>                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/bits/flags.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/bits/macros.h>                                                                                                                                                          // Colorize: green
#include <com/ngos/shared/common/ngos/linkage.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/devtools/shared/utils/string.h>                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
// Verified with PeSpecVerifier [BEGIN] // https://docs.microsoft.com/en-us/windows/win32/debug/pe-format                                                                                                // Colorize: green
typedef quint32 section_header_characteristics_flags;                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
enum class SectionHeaderCharacteristicsFlag: section_header_characteristics_flags                                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    NONE                   = 0,                                                                                                                                                                          // Colorize: green
    TYPE_NO_PAD            = BIT_3,      // The section should not be padded to the next boundary. This flag is obsolete and is replaced by IMAGE_SCN_ALIGN_1BYTES. This is valid only for object files. // Colorize: green
    CNT_CODE               = BIT_5,      // The section contains executable code.                                                                                                                      // Colorize: green
    CNT_INITIALIZED_DATA   = BIT_6,      // The section contains initialized data.                                                                                                                     // Colorize: green
    CNT_UNINITIALIZED_DATA = BIT_7,      // The section contains uninitialized data.                                                                                                                   // Colorize: green
    LNK_OTHER              = BIT_8,      // Reserved for future use.                                                                                                                                   // Colorize: green
    LNK_INFO               = BIT_9,      // The section contains comments or other information. The .drectve section has this type. This is valid for object files only.                               // Colorize: green
    LNK_REMOVE             = BIT_11,     // The section will not become part of the image. This is valid only for object files.                                                                        // Colorize: green
    LNK_COMDAT             = BIT_12,     // The section contains COMDAT data. For more information, see <a href="#comdat-sections-object-only" data-linktype="self-bookmark">COMDAT Sections (Object Only)</a>. This is valid only for object files. // Colorize: green
    NO_DEFER_SPEC_EXC      = BIT_14,     // Reset speculative exceptions handling bits in the TLB entries for this section                                                                             // Colorize: green
    GPREL                  = BIT_15,     // The section contains data referenced through the global pointer (GP).                                                                                      // Colorize: green
    MEM_PURGEABLE          = BIT_17,     // Reserved for future use.                                                                                                                                   // Colorize: green
    MEM_LOCKED             = BIT_18,     // Reserved for future use.                                                                                                                                   // Colorize: green
    MEM_PRELOAD            = BIT_19,     // Reserved for future use.                                                                                                                                   // Colorize: green
    ALIGN_BIT_0            = BIT_20,     // Align bit                                                                                                                                                  // Colorize: green
    ALIGN_BIT_1            = BIT_21,     // Align bit                                                                                                                                                  // Colorize: green
    ALIGN_BIT_2            = BIT_22,     // Align bit                                                                                                                                                  // Colorize: green
    ALIGN_BIT_3            = BIT_23,     // Align bit                                                                                                                                                  // Colorize: green
    ALIGN_1BYTES           = 0x00100000, // Align data on a 1-byte boundary. Valid only for object files.                                                                                              // Colorize: green
    ALIGN_2BYTES           = 0x00200000, // Align data on a 2-byte boundary. Valid only for object files.                                                                                              // Colorize: green
    ALIGN_4BYTES           = 0x00300000, // Align data on a 4-byte boundary. Valid only for object files.                                                                                              // Colorize: green
    ALIGN_8BYTES           = 0x00400000, // Align data on an 8-byte boundary. Valid only for object files.                                                                                             // Colorize: green
    ALIGN_16BYTES          = 0x00500000, // Align data on a 16-byte boundary. Valid only for object files.                                                                                             // Colorize: green
    ALIGN_32BYTES          = 0x00600000, // Align data on a 32-byte boundary. Valid only for object files.                                                                                             // Colorize: green
    ALIGN_64BYTES          = 0x00700000, // Align data on a 64-byte boundary. Valid only for object files.                                                                                             // Colorize: green
    ALIGN_128BYTES         = 0x00800000, // Align data on a 128-byte boundary. Valid only for object files.                                                                                            // Colorize: green
    ALIGN_256BYTES         = 0x00900000, // Align data on a 256-byte boundary. Valid only for object files.                                                                                            // Colorize: green
    ALIGN_512BYTES         = 0x00A00000, // Align data on a 512-byte boundary. Valid only for object files.                                                                                            // Colorize: green
    ALIGN_1024BYTES        = 0x00B00000, // Align data on a 1024-byte boundary. Valid only for object files.                                                                                           // Colorize: green
    ALIGN_2048BYTES        = 0x00C00000, // Align data on a 2048-byte boundary. Valid only for object files.                                                                                           // Colorize: green
    ALIGN_4096BYTES        = 0x00D00000, // Align data on a 4096-byte boundary. Valid only for object files.                                                                                           // Colorize: green
    ALIGN_8192BYTES        = 0x00E00000, // Align data on an 8192-byte boundary. Valid only for object files.                                                                                          // Colorize: green
    LNK_NRELOC_OVFL        = BIT_24,     // The section contains extended relocations.                                                                                                                 // Colorize: green
    MEM_DISCARDABLE        = BIT_25,     // The section can be discarded as needed.                                                                                                                    // Colorize: green
    MEM_NOT_CACHED         = BIT_26,     // The section cannot be cached.                                                                                                                              // Colorize: green
    MEM_NOT_PAGED          = BIT_27,     // The section is not pageable.                                                                                                                               // Colorize: green
    MEM_SHARED             = BIT_28,     // The section can be shared in memory.                                                                                                                       // Colorize: green
    MEM_EXECUTE            = BIT_29,     // The section can be executed as code.                                                                                                                       // Colorize: green
    MEM_READ               = BIT_30,     // The section can be read.                                                                                                                                   // Colorize: green
    MEM_WRITE              = BIT_31      // The section can be written to.                                                                                                                             // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DEFINE_FLAGS(SectionHeaderCharacteristicsFlags, section_header_characteristics_flags); // TEST: NO                                                                                            // Colorize: green
// Verified with PeSpecVerifier [END] // https://docs.microsoft.com/en-us/windows/win32/debug/pe-format                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define SECTION_HEADER_CHARACTERISTICS_FLAG_ALIGN_BITS FLAGS( \
        SectionHeaderCharacteristicsFlag::ALIGN_BIT_0, \
        SectionHeaderCharacteristicsFlag::ALIGN_BIT_1, \
        SectionHeaderCharacteristicsFlag::ALIGN_BIT_2, \
        SectionHeaderCharacteristicsFlag::ALIGN_BIT_3 \
    )                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToString(SectionHeaderCharacteristicsFlag flag) // TEST: NO                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    switch (flag)                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        case SectionHeaderCharacteristicsFlag::NONE: return "NONE";                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        default: return "UNKNOWN";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToFullString(SectionHeaderCharacteristicsFlag flag) // TEST: NO                                                                                                             // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[24];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    sprintf(res, "0x%08X (%s)", (section_header_characteristics_flags)flag, flagToString(flag));                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToString(const SectionHeaderCharacteristicsFlags &characteristicsFlags) // TEST: NO                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[48];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    section_header_characteristics_flags flags = characteristicsFlags.flags & ~SECTION_HEADER_CHARACTERISTICS_FLAG_ALIGN_BITS;                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    char8 *start;                                                                                                                                                                                        // Colorize: green
    char8 *cur;                                                                                                                                                                                          // Colorize: green
    u8     unknownCount;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    __FLAGS_TO_STRING_START_PART(flags, res, cur);                                                                                                                                                       // Colorize: green
    __FLAGS_TO_STRING_COMMON_PART(start, cur, unknownCount, flags, SectionHeaderCharacteristicsFlag);                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (cur != start)                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cur = strapp(cur, " | ");                                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    cur = strapp(cur, flagToString(static_cast<SectionHeaderCharacteristicsFlag>(characteristicsFlags.flags & SECTION_HEADER_CHARACTERISTICS_FLAG_ALIGN_BITS)));                                         // Colorize: green
    __FLAGS_TO_STRING_END_PART(start, cur, unknownCount);                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToFullString(const SectionHeaderCharacteristicsFlags &characteristicsFlags) // TEST: NO                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[48];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    section_header_characteristics_flags flags = characteristicsFlags.flags & ~SECTION_HEADER_CHARACTERISTICS_FLAG_ALIGN_BITS;                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    char8 *start;                                                                                                                                                                                        // Colorize: green
    char8 *cur;                                                                                                                                                                                          // Colorize: green
    u8     unknownCount;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    __FLAGS_TO_FULL_STRING_START_PART(flags, res, cur, "0x%08X");                                                                                                                                                  // Colorize: green
    __FLAGS_TO_STRING_COMMON_PART(start, cur, unknownCount, flags, SectionHeaderCharacteristicsFlag);                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (cur != start)                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cur = strapp(cur, " | ");                                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    cur = strapp(cur, flagToString(static_cast<SectionHeaderCharacteristicsFlag>(characteristicsFlags.flags & SECTION_HEADER_CHARACTERISTICS_FLAG_ALIGN_BITS)));                                         // Colorize: green
    __FLAGS_TO_FULL_STRING_END_PART(start, cur, unknownCount);                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_DEVTOOLS_IMAGE_BUILDER_OTHER_SECTIONHEADERCHARACTERISTICSFLAGS_H                                                                                                                 // Colorize: green
