#ifndef COM_NGOS_DEVTOOLS_IMAGE_BUILDER_PE_PEOPTIONALHEADER_H                                                                                                                                            // Colorize: green
#define COM_NGOS_DEVTOOLS_IMAGE_BUILDER_PE_PEOPTIONALHEADER_H                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <Qt>                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/devtools/image_builder/other/datadirectorytype.h>                                                                                                                                     // Colorize: green
#include <com/ngos/devtools/image_builder/other/peoptionalheaderdllcharacteristicsflags.h>                                                                                                               // Colorize: green
#include <com/ngos/devtools/image_builder/other/peoptionalheadermagic.h>                                                                                                                                 // Colorize: green
#include <com/ngos/devtools/image_builder/other/peoptionalheadersubsystem.h>                                                                                                                             // Colorize: green
#include <com/ngos/devtools/image_builder/pe/datadirectory.h>                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define NUMBER_OF_RVA_AND_SIZES (static_cast<good_Enum_t>(DataDirectoryType::BASE_RELOCATION_TABLE) + 1)                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
// Verified with PeSpecVerifier [BEGIN] // https://docs.microsoft.com/en-us/windows/win32/debug/pe-format                                                                                                // Colorize: green
struct PeOptionalHeader                                                                                                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    void print(); // TEST: NO                                                                                                                                                                            // Colorize: green
    bool verify(); // TEST: NO                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    PeOptionalHeaderMagic                   magic;                                    // The unsigned integer that identifies the state of the image file. The most common number is 0x10B, which identifies it as a normal executable file. 0x107 identifies it as a ROM image, and 0x20B identifies it as a PE32+ executable. // Colorize: green
    quint8                                  majorLinkerVersion;                       // The linker major version number.                                                                               // Colorize: green
    quint8                                  minorLinkerVersion;                       // The linker minor version number.                                                                               // Colorize: green
    quint32                                 sizeOfCode;                               // The size of the code (text) section, or the sum of all code sections if there are multiple sections.           // Colorize: green
    quint32                                 sizeOfInitializedData;                    // The size of the initialized data section, or the sum of all such sections if there are multiple data sections. // Colorize: green
    quint32                                 sizeOfUninitializedData;                  // The size of the uninitialized data section (BSS), or the sum of all such sections if there are multiple BSS sections. // Colorize: green
    quint32                                 addressOfEntryPoint;                      // The address of the entry point relative to the image base when the executable file is loaded into memory. For program images, this is the starting address. For device drivers, this is the address of the initialization function. An entry point is optional for DLLs. When no entry point is present, this field must be zero. // Colorize: green
    quint32                                 baseOfCode;                               // The address that is relative to the image base of the beginning-of-code section when it is loaded into memory. // Colorize: green
    quint64                                 imageBase;                                // The preferred address of the first byte of image when loaded into memory; must be a multiple of 64 K. The default for DLLs is 0x10000000. The default for Windows CE EXEs is 0x00010000. The default for Windows NT, Windows 2000, Windows XP, Windows 95, Windows 98, and Windows Me is 0x00400000. // Colorize: green
    quint32                                 sectionAlignment;                         // The alignment (in bytes) of sections when they are loaded into memory. It must be greater than or equal to FileAlignment. The default is the page size for the architecture. // Colorize: green
    quint32                                 fileAlignment;                            // The alignment factor (in bytes) that is used to align the raw data of sections in the image file. The value should be a power of 2 between 512 and 64 K, inclusive. The default is 512. If the SectionAlignment is less than the architecture's page size, then FileAlignment must match SectionAlignment. // Colorize: green
    quint16                                 majorOperatingSystemVersion;              // The major version number of the required operating system.                                                     // Colorize: green
    quint16                                 minorOperatingSystemVersion;              // The minor version number of the required operating system.                                                     // Colorize: green
    quint16                                 majorImageVersion;                        // The major version number of the image.                                                                         // Colorize: green
    quint16                                 minorImageVersion;                        // The minor version number of the image.                                                                         // Colorize: green
    quint16                                 majorSubsystemVersion;                    // The major version number of the subsystem.                                                                     // Colorize: green
    quint16                                 minorSubsystemVersion;                    // The minor version number of the subsystem.                                                                     // Colorize: green
    quint32                                 win32VersionValue;                        // Reserved, must be zero.                                                                                        // Colorize: green
    quint32                                 sizeOfImage;                              // The size (in bytes) of the image, including all headers, as the image is loaded in memory. It must be a multiple of SectionAlignment. // Colorize: green
    quint32                                 sizeOfHeaders;                            // The combined size of an MS-DOS stub, PE header, and section headers rounded up to a multiple of FileAlignment. // Colorize: green
    quint32                                 checkSum;                                 // The image file checksum. The algorithm for computing the checksum is incorporated into IMAGHELP.DLL. The following are checked for validation at load time: all drivers, any DLL loaded at boot time, and any DLL that is loaded into a critical Windows process. // Colorize: green
    PeOptionalHeaderSubsystem               subsystem;                                // The subsystem that is required to run this image. For more information, see <a href="#windows-subsystem" data-linktype="self-bookmark">Windows Subsystem</a>. // Colorize: green
    PeOptionalHeaderDllCharacteristicsFlags dllCharacteristics;                       // For more information, see <a href="#dll-characteristics" data-linktype="self-bookmark">DLL Characteristics</a> later in this specification. // Colorize: green
    quint64                                 sizeOfStackReserve;                       // The size of the stack to reserve. Only SizeOfStackCommit is committed; the rest is made available one page at a time until the reserve size is reached. // Colorize: green
    quint64                                 sizeOfStackCommit;                        // The size of the stack to commit.                                                                               // Colorize: green
    quint64                                 sizeOfHeapReserve;                        // The size of the local heap space to reserve. Only SizeOfHeapCommit is committed; the rest is made available one page at a time until the reserve size is reached. // Colorize: green
    quint64                                 sizeOfHeapCommit;                         // The size of the local heap space to commit.                                                                    // Colorize: green
    quint32                                 loaderFlags;                              // Reserved, must be zero.                                                                                        // Colorize: green
    quint32                                 numberOfRvaAndSizes;                      // The number of data-directory entries in the remainder of the optional header. Each describes a location and size. // Colorize: green
    DataDirectory                           dataDirectories[NUMBER_OF_RVA_AND_SIZES];                                                                                                                    // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
// Verified with PeSpecVerifier [END] // https://docs.microsoft.com/en-us/windows/win32/debug/pe-format                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_DEVTOOLS_IMAGE_BUILDER_PE_PEOPTIONALHEADER_H                                                                                                                                          // Colorize: green
