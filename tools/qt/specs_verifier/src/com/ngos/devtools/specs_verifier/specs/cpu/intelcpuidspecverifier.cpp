#include "intelcpuidspecverifier.h"                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define INTEL_SPECIFICATION_URL "https://cdrdv2.intel.com/v1/dl/getContent/671199" // Version: April 2022                                                                                                           // Colorize: green
#define INTEL_PDF               "intelcpuid.pdf"                                                                                                                                                             // Colorize: green
#define INTEL_TXT               "intelcpuid.txt"                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define CPUID00000000EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000000eax.h"                                                                                        // Colorize: green
#define CPUID_VENDOR_H         "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuidvendor.h"                                                                                        // Colorize: green
#define CPUID00000001EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000001eax.h"                                                                                        // Colorize: green
#define CPUID_PROCESSOR_TYPE_H "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/lib/cpuidprocessortype.h"                                                                                        // Colorize: green
#define CPUID00000001EBX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000001ebx.h"                                                                                        // Colorize: green
#define CPUID00000004EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000004eax.h"                                                                                        // Colorize: green
#define CPUID_CACHE_TYPE_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/lib/cpuidcachetype.h"                                                                                        // Colorize: green
#define CPUID0000000BEBX0_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000bebx0.h"                                                                                        // Colorize: green
#define CPUID0000000BEBX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000bebx1.h"                                                                                        // Colorize: green
#define CPUID0000000FEBX0_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000febx0.h"                                                                                        // Colorize: green
#define CPUID0000000FEBX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000febx1.h"                                                                                        // Colorize: green
#define CPUID0000000FECX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000fecx1.h"                                                                                        // Colorize: green
#define CPUID_LEAF_H           "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuidleaf.h"                                                                                        // Colorize: green
#define CPUID_SUBLEAF_H        "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuidsubleaf.h"                                                                                        // Colorize: green
#define X86_FEATURE_H          "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/x86feature.h"                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
IntelCpuidSpecVerifier::IntelCpuidSpecVerifier()                                                                                                                                                             // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mHexRegExp(".* ([0-9a-fA-F]+)h .*")                                                                                                                                                                // Colorize: green
    , mBitDefinitionRegExp("Bit(?:s)? +(\\d+(?: *- *\\d+)?):(.*)")                                                                                                                                       // Colorize: green
    , mLeafDefinitionRegExp("INPUT EAX = ([0-9a-fA-F]+)H:(.*)")                                                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // Nothing                                                                                                                                                                                           // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, INTEL_SPECIFICATION_URL, specContent))                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                            // Colorize: green
        specContent.replace(QChar(0x00AE), "(R)");  // Replace registered sign character    // https://www.compart.com/en/unicode/U+00AE                                                                 // Colorize: green
        specContent.replace(QChar(0x2014), '-');    // Replace em dash                      // https://www.compart.com/en/unicode/U+2014                                                                 // Colorize: green
        specContent.replace(QChar(0x2018), '\'');   // Replace left single quotation mark   // https://www.compart.com/en/unicode/U+2018                                                                 // Colorize: green
        specContent.replace(QChar(0x2019), '\'');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+2019                                                                 // Colorize: green
        specContent.replace(QChar(0x201C), '\"');   // Replace left double quotation mark   // https://www.compart.com/en/unicode/U+201C                                                                 // Colorize: green
        specContent.replace(QChar(0x201D), '\"');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+201D                                                                 // Colorize: green
        specContent.replace(QChar(0x2022), '*');    // Replace bullet                       // https://www.compart.com/en/unicode/U+2022                                                                 // Colorize: green
        specContent.replace(QChar(0x2122), "(TM)"); // Replace trade mark sign character    // https://www.compart.com/en/unicode/U+2122                                                                 // Colorize: green
        specContent.replace(QChar(0x2260), "!=");   // Replace not equal sign character     // https://www.compart.com/en/unicode/U+2160                                                                 // Colorize: green
    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool IntelCpuidSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for INTEL CPUID specification");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get INTEL CPUID specification from: %1")                                                                                                               // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + INTEL_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for INTEL CPUID specification");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << INTEL_PDF << INTEL_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + INTEL_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open INTEL CPUID specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkIntelSpecification(thread, specContent);                                                                                                                                                    // Colorize: green
        checkCpuid00000000Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidVendor(thread, specContent);                                                                                                                                                           // Colorize: green
        checkCpuid00000001Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidProcessorType(thread, specContent);                                                                                                                                                    // Colorize: green
        checkCpuid00000001Ebx(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuid00000004Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidCacheType(thread, specContent);                                                                                                                                                        // Colorize: green
        checkCpuid0000000bEbx0(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000bEbx1(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEbx0(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEbx1(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEcx1(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuidLeaf(thread, specContent);                                                                                                                                                             // Colorize: green
        checkCpuidSubLeaf(thread, specContent);                                                                                                                                                          // Colorize: green
        checkX86Feature(thread, specContent);                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with INTEL CPUID specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with INTEL CPUID specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkIntelSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "Intel(R) 64 and IA-32 Architectures\n"                                                                                                                                                        // Colorize: green
            "Software Developer's Manual\n"                                                                                                                                                              // Colorize: green
            "Volume 2A:\n"                                                                                                                                                                               // Colorize: green
            "Instruction Set Reference, A-L\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE: The Intel(R) 64 and IA-32 Architectures Software Developer's Manual consists of ten volumes:\n"                                                                                         // Colorize: green
            "Basic Architecture, Order Number 253665; Instruction Set Reference A-L, Order Number 253666;\n"                                                                                             // Colorize: green
            "Instruction Set Reference M-U, Order Number 253667; Instruction Set Reference V-Z, Order Number\n"                                                                                          // Colorize: green
            "326018; Instruction Set Reference, Order Number 334569; System Programming Guide, Part 1, Order\n"                                                                                          // Colorize: green
            "Number 253668; System Programming Guide, Part 2, Order Number 253669; System Programming\n"                                                                                                 // Colorize: green
            "Guide, Part 3, Order Number 326019; System Programming Guide, Part 4, Order Number 332831;\n"                                                                                               // Colorize: green
            "Model-Specific Registers, Order Number 335592. Refer to all ten volumes when evaluating your design\n"                                                                                      // Colorize: green
            "needs.\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Order Number: 253666-077US\n"                                                                                                                                                               // Colorize: green
            "April 2022";                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("INTEL CPUID specification version didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000000Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum Input Value for Basic CPUID Information.";                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 0: Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String\n"                                                                        // Colorize: green
            "When CPUID executes with EAX set to 0, the processor returns the highest value the CPUID recognizes for\n"                                                                                  // Colorize: green
            "returning basic processor information. The value is returned in the EAX register and is processor specific.";                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000000 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000000Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            CpuidLeaf largestFunction;");                                                                                                                                     // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID00000000EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000000 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidVendor(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
    QString cpuidText3;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1, cpuidText2 and cpuidText3                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                      // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"Genu\"\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ECX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"ntel\"\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EDX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"ineI\"";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 0: Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String\n"                                                                        // Colorize: green
            "When CPUID executes with EAX set to 0, the processor returns the highest value the CPUID recognizes for\n"                                                                                  // Colorize: green
            "returning basic processor information. The value is returned in the EAX register and is processor specific.";                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText3 =                                                                                                                                                                                      // Colorize: green
            "A vendor identification string is also returned in EBX, EDX, and ECX. For Intel processors, the string is \"GenuineIntel\" and is expressed:\n"                                               // Colorize: green
            "EBX := 756e6547h (* \"Genu\", with G in the low eight bits of BL *)\n"                                                                                                                        // Colorize: green
            "EDX := 49656e69h (* \"ineI\", with i in the low eight bits of DL *)\n"                                                                                                                        // Colorize: green
            "ECX := 6c65746eh (* \"ntel\", with n in the low eight bits of CL *)";                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Vendor specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct CpuidVendor");                                                                                                                                                         // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline bool isIntel() const");                                                                                                                                            // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                   // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return uints[0] == VENDOR_INTEL_1");                                                                                                                                  // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[1] == VENDOR_INTEL_2");                                                                                                                                 // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[2] == VENDOR_INTEL_3;");                                                                                                                                // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    inline bool isAMD() const");                                                                                                                                              // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                   // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return uints[0] == VENDOR_AMD_1");                                                                                                                                    // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[1] == VENDOR_AMD_2");                                                                                                                                   // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[2] == VENDOR_AMD_3;");                                                                                                                                  // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 uints[3];");                                                                                                                                             // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_Char8 chars[12];");                                                                                                                                              // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + CPUID_VENDOR_H);                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(cpuidLines, fileLines))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Vendor with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList vendorHexes;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get vendor hexes                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QStringList lines = cpuidText3.split('\n');                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < lines.size(); ++i)                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QRegularExpressionMatch match = mHexRegExp.match(lines.at(i));                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                vendorHexes.append(match.captured(1));                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList vendorLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        vendorLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < vendorHexes.size(); ++i)                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString     hex   = vendorHexes.at(i).toUpper();                                                                                                                                             // Colorize: green
            quint32     uint  = hex.toULongLong(nullptr, 16);                                                                                                                                            // Colorize: green
            good_Char8 *chars = reinterpret_cast<good_Char8 *>(&uint);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            vendorLines.append(QString("#define VENDOR_INTEL_%1 0x%2   // %3%4%5%6")                                                                                                                     // Colorize: green
                                        .arg(i + 1)                                                                                                                                                      // Colorize: green
                                        .arg(hex, 8, QChar('0'))                                                                                                                                         // Colorize: green
                                        .arg(chars[0])                                                                                                                                                   // Colorize: green
                                        .arg(chars[1])                                                                                                                                                   // Colorize: green
                                        .arg(chars[2])                                                                                                                                                   // Colorize: green
                                        .arg(chars[3])                                                                                                                                                   // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        vendorLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(vendorLines, fileLines))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Intel Vendor with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000001Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
    QString cpuidText3;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1, cpuidText2 and cpuidText3                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version Information: Type, Family, Model, and Stepping ID (see Figure 3-6).";                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 01H: Returns Model, Family, Stepping Information\n"                                                                                                                             // Colorize: green
            "When CPUID executes with EAX set to 01H, version information is returned in EAX (see Figure 3-6). For example:\n"                                                                           // Colorize: green
            "model, family, and processor type for the Intel Xeon processor 5100 series is as follows:\n"                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Model - 1111B\n"                                                                                                                                                                            // Colorize: green
            "Family - 0101B\n"                                                                                                                                                                           // Colorize: green
            "Processor Type - 00B\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "See Table 3-9 for available processor type values. Stepping IDs are provided as needed.\n"                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "28 27\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "20 19\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended\n"                                                                                                                                                                                 // Colorize: green
            "Family ID\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16 15 14 13 12 11\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended\n"                                                                                                                                                                                 // Colorize: green
            "Model ID\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8 7\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Family\n"                                                                                                                                                                                   // Colorize: green
            "ID\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Model\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Stepping\n"                                                                                                                                                                                 // Colorize: green
            "ID\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended Family ID (0)\n"                                                                                                                                                                   // Colorize: green
            "Extended Model ID (0)\n"                                                                                                                                                                    // Colorize: green
            "Processor Type\n"                                                                                                                                                                           // Colorize: green
            "Family (0FH for the Pentium 4 Processor Family)\n"                                                                                                                                          // Colorize: green
            "Model\n"                                                                                                                                                                                    // Colorize: green
            "Reserved\n"                                                                                                                                                                                 // Colorize: green
            "OM16525\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Figure 3-6. Version Information Returned by CPUID in EAX\n"                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification";                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText3 =                                                                                                                                                                                      // Colorize: green
            "Table 3-9. Processor Type Field\n"                                                                                                                                                          // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Encoding\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Original OEM Processor\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "(R)\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel OverDrive Processor\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Dual processor (not applicable to Intel486 processors)\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "See Chapter 20 in the Intel(R) 64 and IA-32 Architectures Software Developer's Manual, Volume 1,\n"                                                                                           // Colorize: green
            "for information on identifying earlier IA-32 processors.\n"                                                                                                                                 // Colorize: green
            "The Extended Family ID needs to be examined only when the Family ID is 0FH. Integrate the fields into a display\n"                                                                          // Colorize: green
            "using the following rule:\n"                                                                                                                                                                // Colorize: green
            "IF Family_ID != 0FH\n"                                                                                                                                                                       // Colorize: green
            "THEN DisplayFamily = Family_ID;\n"                                                                                                                                                          // Colorize: green
            "ELSE DisplayFamily = Extended_Family_ID + Family_ID;\n"                                                                                                                                     // Colorize: green
            "(* Right justify and zero-extend 4-bit field. *)\n"                                                                                                                                         // Colorize: green
            "FI;\n"                                                                                                                                                                                      // Colorize: green
            "(* Show DisplayFamily as HEX field. *)\n"                                                                                                                                                   // Colorize: green
            "The Extended Model ID needs to be examined only when the Family ID is 06H or 0FH. Integrate the field into a\n"                                                                             // Colorize: green
            "display using the following rule:\n"                                                                                                                                                        // Colorize: green
            "IF (Family_ID = 06H or Family_ID = 0FH)\n"                                                                                                                                                  // Colorize: green
            "THEN DisplayModel = (Extended_Model_ID « 4) + Model_ID;\n"                                                                                                                                  // Colorize: green
            "(* Right justify and zero-extend 4-bit field; display Model_ID as HEX field.*)\n"                                                                                                           // Colorize: green
            "ELSE DisplayModel = Model_ID;\n"                                                                                                                                                            // Colorize: green
            "FI;\n"                                                                                                                                                                                      // Colorize: green
            "(* Show DisplayModel as HEX field. *)";                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000001 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000001Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline good_U16 familyReal() const");                                                                                                                                     // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        if (family == 15)");                                                                                                                                                  // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            return family + extendedFamily;");                                                                                                                                // Colorize: green
        cpuidLines.append("        }");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return family;");                                                                                                                                                     // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    inline good_U8 modelReal() const");                                                                                                                                       // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        if (family >= 6)");                                                                                                                                                   // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            return model + (extendedModel << 4);");                                                                                                                           // Colorize: green
        cpuidLines.append("        }");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return model;");                                                                                                                                                      // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32           stepping:       4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           model:          4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           family:         4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            CpuidProcessorType processorType:  2;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           _reserved:      2;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           extendedModel:  4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           extendedFamily: 8;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           _reserved2:     4;");                                                                                                                          // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID00000001EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000001 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidProcessorType(SpecVerifyThread *thread, const QString &specContent)                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                      // Colorize: green
            "Table 3-9. Processor Type Field\n"                                                                                                                                                          // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Encoding\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Original OEM Processor\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "(R)\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel OverDrive Processor\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Dual processor (not applicable to Intel486 processors)\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11B";                                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Processor Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidProcessorType: good_U8");                                                                                                                                     // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    ORIGINAL_EQUIPMENT_MANUFACTURER_PROCESSOR = 0,");                                                                                                                         // Colorize: green
        cpuidLines.append("    INTEL_OVERDRIVE_PROCESSOR                 = 1,");                                                                                                                         // Colorize: green
        cpuidLines.append("    DUAL_PROCESSOR                            = 2");                                                                                                                          // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_PROCESSOR_TYPE_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Processor Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000001Ebx(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 07 - 00: Brand Index.\n"                                                                                                                                                               // Colorize: green
            "Bits 15 - 08: CLFLUSH line size (Value ∗ 8 = cache line size in bytes; used also by CLFLUSHOPT).\n"                                                                                         // Colorize: green
            "Bits 23 - 16: Maximum number of addressable IDs for logical processors in this physical package*.\n"                                                                                        // Colorize: green
            "Bits 31 - 24: Initial APIC ID**.";                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "INPUT EAX = 01H: Returns Additional Information in EBX\n"                                                                                                                                   // Colorize: green
            "When CPUID executes with EAX set to 01H, additional information is returned to the EBX register:\n"                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Brand index (low byte of EBX) - this number provides an entry into a brand string table that contains brand\n"                                                                              // Colorize: green
            "strings for IA-32 processors. More information about this field is provided later in this section.\n"                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CLFLUSH instruction cache line size (second byte of EBX) - this number indicates the size of the cache line\n"                                                                              // Colorize: green
            "flushed by the CLFLUSH and CLFLUSHOPT instructions in 8-byte increments. This field was introduced in the\n"                                                                                // Colorize: green
            "Pentium 4 processor.\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Local APIC ID (high byte of EBX) - this number is the 8-bit ID that is assigned to the local APIC on the\n"                                                                                 // Colorize: green
            "processor during power up. This field was introduced in the Pentium 4 processor.";                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000001 EBX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000001Ebx");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline good_U16 cacheLineFlushSizeReal() const");                                                                                                                         // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return cacheLineFlushSize * 8;");                                                                                                                                     // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 brandIndex:                8; // This number provides an entry into a brand string table that contains brand strings for IA-32 processors");             // Colorize: green
        cpuidLines.append("            good_U32 cacheLineFlushSize:        8; // This number indicates the size of the cache line flushed by the CLFLUSH and CLFLUSHOPT instructions in 8-byte increments"); // Colorize: green
        cpuidLines.append("            good_U32 numberOfApicIdsPerPackage: 8; // Maximum number of addressable IDs for logical processors in this physical package");                                    // Colorize: green
        cpuidLines.append("            good_U32 localApicId:               8; // This number is the 8-bit ID that is assigned to the local APIC on the processor during power up");                      // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID00000001EBX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000001 EBX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000004Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 04 - 00: Cache Type Field.\n"                                                                                                                                                          // Colorize: green
            "0 = Null - No more caches.\n"                                                                                                                                                               // Colorize: green
            "1 = Data Cache.\n"                                                                                                                                                                          // Colorize: green
            "2 = Instruction Cache.\n"                                                                                                                                                                   // Colorize: green
            "3 = Unified Cache.\n"                                                                                                                                                                       // Colorize: green
            "4-31 = Reserved.";                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "Table 3-8. Information Returned by CPUID Instruction (Contd.)\n"                                                                                                                            // Colorize: green
            "Initial EAX\n"                                                                                                                                                                              // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Information Provided about the Processor\n"                                                                                                                                                 // Colorize: green
            "Bits 07 - 05: Cache Level (starts at 1).\n"                                                                                                                                                 // Colorize: green
            "Bit 08: Self Initializing cache level (does not need SW initialization).\n"                                                                                                                 // Colorize: green
            "Bit 09: Fully Associative cache.\n"                                                                                                                                                         // Colorize: green
            "Bits 13 - 10: Reserved.\n"                                                                                                                                                                  // Colorize: green
            "Bits 25 - 14: Maximum number of addressable IDs for logical processors sharing this cache**, ***.\n"                                                                                        // Colorize: green
            "Bits 31 - 26: Maximum number of addressable IDs for processor cores in the physical\n"                                                                                                      // Colorize: green
            "package**, ****, *****.";                                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000004 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(2) != "CPUID-CPU Identification" || lines.at(3) != "")                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 00000004 EAX specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 4;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (line == "Bits 04 - 00: Cache Type Field.")                                                                                                                                            // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    i += 11;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    continue;                                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Cache Type Field.",                                                              "cacheType");                                                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Cache Level (starts at 1).",                                                     "cacheLevel");                                                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Self Initializing cache level (does not need SW initialization).",               "selfInitializingCacheLevel");                                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Fully Associative cache.",                                                       "fullyAssociativeCache");                                               // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                      "_reserved");                                                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum number of addressable IDs for logical processors sharing this cache.",   "maximumNumberOfThreads");                                              // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum number of addressable IDs for processor cores in the physical package.", "maximumNumberOfCores");                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000004Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32       %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 26 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.replaceInStrings("            good_U32       cacheType:",  "            CpuidCacheType cacheType:");                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID00000004EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000004 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidCacheType(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 04 - 00: Cache Type Field.\n"                                                                                                                                                          // Colorize: green
            "0 = Null - No more caches.\n"                                                                                                                                                               // Colorize: green
            "1 = Data Cache.\n"                                                                                                                                                                          // Colorize: green
            "2 = Instruction Cache.\n"                                                                                                                                                                   // Colorize: green
            "3 = Unified Cache.\n"                                                                                                                                                                       // Colorize: green
            "4-31 = Reserved.";                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Cache Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(2) != "CPUID-CPU Identification"                                                                                                                                                    // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(3) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(4) != "Bits 04 - 00: Cache Type Field."                                                                                                                                             // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID Cache Type specification");                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 5;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            qint64 index = line.indexOf('=');                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (index >= 0)                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString value       = line.left(index).trimmed();                                                                                                                                        // Colorize: green
                QString description = line.mid(index + 1).trimmed();                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (description != "Reserved.")                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString field = description;                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    field = field.toUpper().remove("NULL - ").remove('.').replace(' ', '_');                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    fields.append(field);                                                                                                                                                                // Colorize: green
                    values.append(value);                                                                                                                                                                // Colorize: green
                    descriptions.append(description);                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidCacheType: good_U8");                                                                                                                                         // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            cpuidLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                             // Colorize: green
                                        .arg(fields.at(i), -17, QChar(' '))                                                                                                                              // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                          // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                         // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_CACHE_TYPE_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Cache Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000bEbx0(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 15 - 00: Number of logical processors at this level type. The number reflects configuration as shipped\n"                                                                              // Colorize: green
            "by Intel**.\n"                                                                                                                                                                              // Colorize: green
            "Bits 31- 16: Reserved.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000B EBX/0 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000B EBX/0 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Number of logical processors at this level type. The number reflects configuration as shipped by Intel.",  "numberOfThreadsPerCore");                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                                                "_reserved");                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000BEbx0");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 22 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID0000000BEBX0_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000B EBX/0 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000bEbx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 15 - 00: Number of logical processors at this level type. The number reflects configuration as shipped\n"                                                                              // Colorize: green
            "by Intel**.\n"                                                                                                                                                                              // Colorize: green
            "Bits 31- 16: Reserved.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000B EBX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000B EBX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Number of logical processors at this level type. The number reflects configuration as shipped by Intel.",  "numberOfThreads");                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                                                "_reserved");                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000BEbx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 15 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID0000000BEBX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000B EBX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEbx0(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 31 - 00: Maximum range (zero-based) of RMID within this physical processor of all types.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F EBX/0 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F EBX/0 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum range (zero-based) of RMID within this physical processor of all types.", "cacheMaxRmid");                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEbx0");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID0000000FEBX0_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F EBX/0 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEbx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 31 - 00: Conversion factor from reported IA32_QM_CTR value to occupancy metric (bytes) and Memory Bandwidth Monitoring (MBM) metrics.";                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F EBX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F EBX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Conversion factor from reported IA32_QM_CTR value to occupancy metric (bytes) and Memory Bandwidth Monitoring (MBM) metrics.", "cacheOccScale");         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEbx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID0000000FEBX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F EBX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEcx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "ECX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum range (zero-based) of RMID of this resource type.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F ECX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "ECX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F ECX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(line);                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum range (zero-based) of RMID of this resource type.",  "cacheMaxRmid");                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEcx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID0000000FECX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F ECX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidLeaf(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = specContent.split('\n');                                                                                                                                                         // Colorize: green
    QStringList leaves;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get leaves                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < lines.size(); ++i)                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (line.startsWith("INPUT EAX = "))                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                leaves.append(line);                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 i = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            leaves.at(0) != "INPUT EAX = 0: Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String"                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            leaves.at(1) != "INPUT EAX = 80000000H: Returns CPUID's Highest Value for Extended Processor Information"                                                                                    // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            leaves.at(2) != "INPUT EAX = 01H: Returns Model, Family, Stepping Information"                                                                                                               // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            leaves.at(3) != "INPUT EAX = 01H: Returns Additional Information in EBX"                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            leaves.at(4) != "INPUT EAX = 01H: Returns Feature Information in ECX and EDX"                                                                                                                // Colorize: green
           )                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID Leaves specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 5;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < leaves.size())                                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QRegularExpressionMatch match = mLeafDefinitionRegExp.match(leaves.at(i));                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString hex         = match.captured(1).simplified();                                                                                                                                                 // Colorize: green
                QString description = match.captured(2).simplified();                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
                values.append(hex);                                                                                                                                                                      // Colorize: green
                descriptions.append(description);                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        fields.insert(0, "VENDOR_ID_AND_LARGEST_STANDARD_FUNCTION");                                                                                                                                     // Colorize: green
        values.insert(0, "0");                                                                                                                                                                           // Colorize: green
        descriptions.insert(0, "Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String");                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        fields.insert(1, "MODEL_AND_FEATURE_INFORMATION");                                                                                                                                               // Colorize: green
        values.insert(1, "1");                                                                                                                                                                           // Colorize: green
        descriptions.insert(1, "Returns Model, Family, Stepping Information in EAX, Returns Additional Information in EBX, Returns Feature Information in ECX and EDX");                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        fields.insert(3, "PROCESSOR_SERIAL_NUMBER");                                                                                                                                                     // Colorize: green
        values.insert(3, "3");                                                                                                                                                                           // Colorize: green
        descriptions.insert(3, "96 bit processor serial number. (Available in Pentium III processor only; otherwise, the value in this register is reserved.)");                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("VENDOR_ID_AND_LARGEST_STANDARD_FUNCTION",                                                   "VENDOR_ID_AND_LARGEST_STANDARD_FUNCTION");                  // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("MODEL_AND_FEATURE_INFORMATION",                                                             "MODEL_AND_FEATURE_INFORMATION");                            // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("TLB/Cache/Prefetch Information Returned in EAX, EBX, ECX, EDX",                             "CACHE_INFORMATION");                                        // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("PROCESSOR_SERIAL_NUMBER",                                                                   "PROCESSOR_SERIAL_NUMBER");                                  // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Deterministic Cache Parameters for Each Level",                                     "DETERMINISTIC_CACHE_PARAMETERS");                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns MONITOR and MWAIT Features",                                                        "MONITOR_AND_MWAIT_FEATURES");                               // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Thermal and Power Management Features",                                             "THERMAL_AND_POWER_MANAGEMENT_FEATURES");                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Structured Extended Feature Enumeration Information",                               "STRUCTURED_EXTENDED_FEATURE");                              // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Direct Cache Access Information",                                                   "DIRECT_CACHE_ACCESS_INFORMATION");                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Architectural Performance Monitoring Features",                                     "ARCHITECTUAL_PERFORMANCE_MONITORING_FEATURES");             // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Extended Topology Information",                                                     "EXTENDED_TOPOLOGY_INFORMATION");                            // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Processor Extended States Enumeration Information",                                 "XSAVE_FEATURES");                                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Intel Resource Director Technology (Intel RDT) Monitoring Enumeration Information", "RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING");                  // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Intel Resource Director Technology (Intel RDT) Allocation Enumeration Information", "RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION");                  // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Intel SGX Enumeration Information",                                                 "SGX");                                                      // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Intel Processor Trace Enumeration Information",                                     "PROCESSOR_TRACE");                                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Time Stamp Counter and Nominal Core Crystal Clock Information",                     "TSC_AND_NOMINAL_CORE_CRYSTAL_CLOCK_INFORMATION");           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Processor Frequency Information",                                                   "PROCESSOR_FREQUENCY_INFORMATION");                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns System-On-Chip Information",                                                        "SYSTEM_ON_CHIP_INFORMATION");                               // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Deterministic Address Translation Parameters Information",                          "DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION"); // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Key Locker Information",                                                            "KEY_LOCKER_INFORMATION");                                   // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Hybrid Information",                                                                "HYBRID_INFORMATION");                                       // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns PCONFIG Information",                                                               "PCONFIG_INFORMATION");                                      // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns Last Branch Record Information",                                                    "LAST_BRANCH_RECORD_INFORMATION");                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns V2 Extended Topology Information",                                                  "V2_EXTENDED_TOPOLOGY_INFORMATION");                         // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Returns History Reset Information",                                                         "HISTORY_RESET_INFORMATION");                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidLeaf: good_U32");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("    %1 = 0x%2, // %3")                                                                                                                    // Colorize: green
                                        .arg(field, -56, QChar(' '))                                                                                                                                                      // Colorize: green
                                        .arg(values.at(i), 8, QChar('0'))                                                                                                                        // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert AMD values                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.insert(29, "    LARGEST_EXTENDED_FUNCTION                                = 0x80000000,");                                                                                             // Colorize: green
        cpuidLines.insert(30, "    EXTENDED_FEATURE_BITS                                    = 0x80000001,");                                                                                             // Colorize: green
        cpuidLines.insert(31, "    PROCESSOR_BRAND_STRING_1                                 = 0x80000002,");                                                                                             // Colorize: green
        cpuidLines.insert(32, "    PROCESSOR_BRAND_STRING_2                                 = 0x80000003,");                                                                                             // Colorize: green
        cpuidLines.insert(33, "    PROCESSOR_BRAND_STRING_3                                 = 0x80000004,");                                                                                             // Colorize: green
        cpuidLines.insert(34, "    L1_CACHE_IDENTIFIERS                                     = 0x80000005,");                                                                                             // Colorize: green
        cpuidLines.insert(35, "    EXTENDED_L2_CACHE_FEATURES                               = 0x80000006,");                                                                                             // Colorize: green
        cpuidLines.insert(36, "    ADVANCED_POWER_MANAGEMENT                                = 0x80000007,");                                                                                             // Colorize: green
        cpuidLines.insert(37, "    VIRTUAL_AND_PHYSICAL_ADDRESS_SIZES                       = 0x80000008,");                                                                                             // Colorize: green
        cpuidLines.insert(38, "    SVM_FEATURES                                             = 0x8000000A,");                                                                                             // Colorize: green
        cpuidLines.insert(39, "    ENCRYPTED_MEMORY_CAPABILITIES                            = 0x8000001F");                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_LEAF_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Leaves with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidSubLeaf(SpecVerifyThread *thread, const QString &specContent)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidSubLeaf: good_U32 // Ignore CppEnumVerifier");                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                              // Colorize: green
        cpuidLines.append("    NONE = 0,");                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::DETERMINISTIC_CACHE_PARAMETERS                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 04H and ECX contains an index value, the processor returns encoded data\n"                                                                      // Colorize: green
                    "that describe a set of deterministic cache parameters (for the cache level associated with the input in ECX). Valid\n"                                                              // Colorize: green
                    "index values start from 0.\n"                                                                                                                                                       // Colorize: green
                    "Software can enumerate the deterministic cache parameters for each level of the cache hierarchy starting with an\n"                                                                 // Colorize: green
                    "index value of 0, until the parameters report the value associated with the cache type field is 0. The architecturally\n"                                                           // Colorize: green
                    "defined fields reported by deterministic cache parameters are documented in Table 3-8.\n"                                                                                           // Colorize: green
                    "This Cache Size in Bytes\n"                                                                                                                                                         // Colorize: green
                    "= (Ways + 1) * (Partitions + 1) * (Line_Size + 1) * (Sets + 1)\n"                                                                                                                   // Colorize: green
                    "= (EBX[31:22] + 1) * (EBX[21:12] + 1) * (EBX[11:0] + 1) * (ECX + 1)\n"                                                                                                              // Colorize: green
                    "The CPUID leaf 04H also reports data that can be used to derive the topology of processor cores in a physical\n"                                                                    // Colorize: green
                    "package. This information is constant for all valid index values. Software can query the raw data reported by\n"                                                                    // Colorize: green
                    "executing CPUID with EAX=04H and ECX=0 and use it as part of the topology enumeration algorithm described in\n"                                                                     // Colorize: green
                    "Chapter 8, \"Multiple-Processor Management,\" in the Intel(R) 64 and IA-32 Architectures Software Developer's\n"                                                                        // Colorize: green
                    "Manual, Volume 3A.";                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::DETERMINISTIC_CACHE_PARAMETERS didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::DETERMINISTIC_CACHE_PARAMETERS");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_0 = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_1 = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_2 = 2,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_3 = 3,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_4 = 4,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::STRUCTURED_EXTENDED_FEATURE                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 07H and ECX = 0, the processor returns information about the maximum\n"                                                                         // Colorize: green
                    "input value for sub-leaves that contain extended feature flags. See Table 3-8.\n"                                                                                                   // Colorize: green
                    "When CPUID executes with EAX set to 07H and the input value of ECX is invalid (see leaf 07H entry in Table 3-8),\n"                                                                 // Colorize: green
                    "the processor returns 0 in EAX/EBX/ECX/EDX. In subleaf 0, EAX returns the maximum input value of the highest\n"                                                                     // Colorize: green
                    "leaf 7 sub-leaf, and EBX, ECX & EDX contain information of extended feature flags.";                                                                                                // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::STRUCTURED_EXTENDED_FEATURE didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::STRUCTURED_EXTENDED_FEATURE");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    STRUCTURED_EXTENDED_FEATURE_LEVEL_0 = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    STRUCTURED_EXTENDED_FEATURE_LEVEL_1 = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::EXTENDED_TOPOLOGY_INFORMATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "CPUID leaf 1FH is a preferred superset to leaf 0BH. Intel recommends first checking for the existence\n"                                                                            // Colorize: green
                    "of Leaf 1FH before using leaf 0BH.\n"                                                                                                                                               // Colorize: green
                    "Most of Leaf 0BH output depends on the initial value in ECX.\n"                                                                                                                     // Colorize: green
                    "The EDX output of leaf 0BH is always valid and does not vary with input value in ECX.\n"                                                                                            // Colorize: green
                    "Output value in ECX[7:0] always equals input value in ECX[7:0].\n"                                                                                                                  // Colorize: green
                    "Sub-leaf index 0 enumerates SMT level. Each subsequent higher sub-leaf index enumerates a higherlevel topological entity in hierarchical order.\n"                                  // Colorize: green
                    "For sub-leaves that return an invalid level-type of 0 in ECX[15:8]; EAX and EBX will return 0.\n"                                                                                   // Colorize: green
                    "If an input value n in ECX returns the invalid level-type of 0 in ECX[15:8], other input values with ECX >\n"                                                                       // Colorize: green
                    "n also return 0 in ECX[15:8].";                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::EXTENDED_TOPOLOGY_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::EXTENDED_TOPOLOGY_INFORMATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    EXTENDED_TOPOLOGY_INFORMATION_THREADS_PER_CORE = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    EXTENDED_TOPOLOGY_INFORMATION_THREADS          = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::XSAVE_FEATURES                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 0DH and ECX = 0, the processor returns information about the bit-vector\n"                                                                      // Colorize: green
                    "representation of all processor state extensions that are supported in the processor and storage size requirements\n"                                                               // Colorize: green
                    "of the XSAVE/XRSTOR area. See Table 3-8.\n"                                                                                                                                         // Colorize: green
                    "When CPUID executes with EAX set to 0DH and ECX = n (n > 1, and is a valid sub-leaf index), the processor returns\n"                                                                // Colorize: green
                    "information about the size and offset of each processor extended state save area within the XSAVE/XRSTOR area.\n"                                                                   // Colorize: green
                    "See Table 3-8. Software can use the forward-extendable technique depicted below to query the valid sub-leaves\n"                                                                    // Colorize: green
                    "and obtain size and offset information for each processor extended state save area:\n"                                                                                              // Colorize: green
                    "For i = 2 to 62 // sub-leaf 1 is reserved\n"                                                                                                                                        // Colorize: green
                    "IF (CPUID.(EAX=0DH, ECX=0):VECTOR[i] = 1 ) // VECTOR is the 64-bit value of EDX:EAX\n"                                                                                              // Colorize: green
                    "Execute CPUID.(EAX=0DH, ECX = i) to examine size and offset for sub-leaf i;\n"                                                                                                      // Colorize: green
                    "FI;";                                                                                                                                                                               // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::XSAVE_FEATURES didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::XSAVE_FEATURES");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PROCESSOR_EXTENDED_STATE_MAIN         = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PROCESSOR_EXTENDED_STATE_SUB          = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX                                   = 2,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_MPX_BOUND_REGISTERS                   = 3,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_MPX_BOUND_CONFIG_AND_STATUS_REGISTERS = 4,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_OPMASK                         = 5,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_ZMM_FROM_0_TO_15               = 6,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_ZMM_FROM_16_TO_31              = 7,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PT                                    = 8,");                                                                                                                        // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PKRU                                  = 9,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 0FH and ECX = 0, the processor returns information about the bit-vector\n"                                                                      // Colorize: green
                    "representation of QoS monitoring resource types that are supported in the processor and maximum range of RMID\n"                                                                    // Colorize: green
                    "values the processor can use to monitor of any supported resource types. Each bit, starting from bit 1, corresponds\n"                                                              // Colorize: green
                    "to a specific resource type if the bit is set. The bit position corresponds to the sub-leaf index (or ResID) that software must use to query QoS monitoring capability available for that type. See Table 3-8.\n" // Colorize: green
                    "When CPUID executes with EAX set to 0FH and ECX = n (n >= 1, and is a valid ResID), the processor returns information software can use to program IA32_PQR_ASSOC, IA32_QM_EVTSEL MSRs before reading QoS data from the\n" // Colorize: green
                    "IA32_QM_CTR MSR.";                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING          = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING_L3_CACHE = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 10H and ECX = 0, the processor returns information about the bit-vector\n"                                                                      // Colorize: green
                    "representation of QoS Enforcement resource types that are supported in the processor. Each bit, starting from bit\n"                                                                // Colorize: green
                    "1, corresponds to a specific resource type if the bit is set. The bit position corresponds to the sub-leaf index (or\n"                                                             // Colorize: green
                    "ResID) that software must use to query QoS enforcement capability available for that type. See Table 3-8.\n"                                                                        // Colorize: green
                    "When CPUID executes with EAX set to 10H and ECX = n (n >= 1, and is a valid ResID), the processor returns information about available classes of service and range of QoS mask MSRs that software can use to configure each\n" // Colorize: green
                    "class of services using capability bit masks in the QoS Mask registers, IA32_resourceType_Mask_n.";                                                                                 // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION                  = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_L3_CACHE         = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_L2_CACHE         = 2,");                                                                                                                        // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_MEMORY_BANDWIDTH = 3,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::SGX                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 12H and ECX = 0H, the processor returns information about Intel SGX capabilities. See Table 3-8.\n"                                             // Colorize: green
                    "When CPUID executes with EAX set to 12H and ECX = 1H, the processor returns information about Intel SGX attributes. See Table 3-8.\n"                                               // Colorize: green
                    "When CPUID executes with EAX set to 12H and ECX = n (n > 1), the processor returns information about Intel SGX\n"                                                                   // Colorize: green
                    "Enclave Page Cache. See Table 3-8.";                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::SGX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::SGX");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    SGX_CAPABILITIES       = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    SGX_ATTRIBUTES         = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    SGX_ENCLAVE_PAGE_CACHE = 2,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::PROCESSOR_TRACE                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "When CPUID executes with EAX set to 14H and ECX = 0H, the processor returns information about Intel Processor\n"                                                                    // Colorize: green
                    "Trace extensions. See Table 3-8.\n"                                                                                                                                                 // Colorize: green
                    "When CPUID executes with EAX set to 14H and ECX = n (n > 0 and less than the number of non-zero bits in\n"                                                                          // Colorize: green
                    "CPUID.(EAX=14H, ECX= 0H).EAX), the processor returns information about packet generation in Intel Processor\n"                                                                      // Colorize: green
                    "Trace. See Table 3-8.";                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::PROCESSOR_TRACE didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::PROCESSOR_TRACE");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    PROCESSOR_TRACE_MAIN = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    PROCESSOR_TRACE_SUB  = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::SYSTEM_ON_CHIP_INFORMATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "Leaf 17H main leaf (ECX = 0).\n"                                                                                                                                                    // Colorize: green
                    "Leaf 17H output depends on the initial value in ECX.\n"                                                                                                                             // Colorize: green
                    "Leaf 17H sub-leaves 1 through 3 reports SOC Vendor Brand String.\n"                                                                                                                 // Colorize: green
                    "Leaf 17H is valid if MaxSOCID_Index >= 3.\n"                                                                                                                                        // Colorize: green
                    "Leaf 17H sub-leaves 4 and above are reserved.";                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::SYSTEM_ON_CHIP_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::SYSTEM_ON_CHIP_INFORMATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_MAIN = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_0 = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_1 = 2,");                                                                                                                        // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_2 = 3,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "Each sub-leaf enumerates a different address translation structure.\n"                                                                                                              // Colorize: green
                    "If ECX contains an invalid sub-leaf index, EAX/EBX/ECX/EDX return 0. Sub-leaf index n is invalid if n\n"                                                                            // Colorize: green
                    "exceeds the value that sub-leaf 0 returns in EAX. A sub-leaf index is also invalid if EDX[4:0] returns 0.\n"                                                                        // Colorize: green
                    "Valid sub-leaves do not need to be contiguous or in any particular order. A valid sub-leaf may be in a\n"                                                                           // Colorize: green
                    "higher input ECX value than an invalid sub-leaf or than a valid sub-leaf of a higher or lower-level structure.\n"                                                                   // Colorize: green
                    "* Some unified TLBs will allow a single TLB entry to satisfy data read/write and instruction fetches.\n"                                                                            // Colorize: green
                    "Others will require separate entries (e.g., one loaded on data read/write and another loaded on an\n"                                                                               // Colorize: green
                    "instruction fetch) . Please see the Intel(R) 64 and IA-32 Architectures Optimization Reference Manual for\n"                                                                          // Colorize: green
                    "details of a particular product.\n"                                                                                                                                                 // Colorize: green
                    "** Add one to the return value to get the result.";                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION_MAIN = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION_SUB  = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::PCONFIG_INFORMATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                             // Colorize: green
                    "When CPUID executes with EAX set to 1BH, the processor returns information about PCONFIG capabilities. This\n"                                                                      // Colorize: green
                    "information is enumerated in sub-leaves selected by the value of ECX (starting with 0).";                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "Each sub-leaf of CPUID function 1BH enumerates its sub-leaf type in EAX. If a sub-leaf type is 0, the sub-leaf is\n"                                                                // Colorize: green
                    "invalid and zero is returned in EBX, ECX, and EDX. In this case, all subsequent sub-leaves (selected by larger input\n"                                                             // Colorize: green
                    "values of ECX) are also invalid.\n"                                                                                                                                                 // Colorize: green
                    "The only valid sub-leaf type currently defined is 1, meaning target identifier, indicating that the sub-leaf enumerates target identifiers for the PCONFIG instruction. Any non-zero value returned in EBX, ECX, or EDX indicates a\n" // Colorize: green
                    "valid target of the PCONFIG instruction (any value of zero should be ignored). The only target identifier currently\n"                                                              // Colorize: green
                    "defined is 1, indicating MKTME. See the \"PCONFIG - Platform Configuration\" instruction in Chapter 4 of the Intel(R)\n"                                                                // Colorize: green
                    "64 and IA-32 Architectures Software Developer's Manual, Volume 2B for more information.";                                                                                           // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::PCONFIG_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::PCONFIG_INFORMATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    PCONFIG_INFORMATION_LEVEL_0 = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    PCONFIG_INFORMATION_LEVEL_1 = 1,");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare lines for CpuidLeaf::V2_EXTENDED_TOPOLOGY_INFORMATION                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "CPUID leaf 1FH is a preferred superset to leaf 0BH. Intel recommends first checking for the existence\n"                                                                            // Colorize: green
                    "of Leaf 1FH and using this if available.\n"                                                                                                                                         // Colorize: green
                    "Most of Leaf 1FH output depends on the initial value in ECX.\n"                                                                                                                     // Colorize: green
                    "The EDX output of leaf 1FH is always valid and does not vary with input value in ECX.\n"                                                                                            // Colorize: green
                    "Output value in ECX[7:0] always equals input value in ECX[7:0].\n"                                                                                                                  // Colorize: green
                    "Sub-leaf index 0 enumerates SMT level. Each subsequent higher sub-leaf index enumerates a higherlevel topological entity in hierarchical order.\n"                                  // Colorize: green
                    "For sub-leaves that return an invalid level-type of 0 in ECX[15:8]; EAX and EBX will return 0.\n"                                                                                   // Colorize: green
                    "If an input value n in ECX returns the invalid level-type of 0 in ECX[15:8], other input values with ECX >\n"                                                                       // Colorize: green
                    "n also return 0 in ECX[15:8].";                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("CPUID Sub-leaves specification for CpuidLeaf::V2_EXTENDED_TOPOLOGY_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::V2_EXTENDED_TOPOLOGY_INFORMATION");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    V2_EXTENDED_TOPOLOGY_INFORMATION_THREADS_PER_CORE = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    V2_EXTENDED_TOPOLOGY_INFORMATION_THREADS          = 1");                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_SUBLEAF_H))                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Sub-leaves with specification");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkX86Feature(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList        groups;                                                                                                                                                                           // Colorize: green
    QList<QStringList> fieldGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> valueGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> descriptionGroups;                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get groups                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000001_ECX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "Table 3-10. Feature Information Returned in the ECX Register\n"                                                                                                                     // Colorize: green
                    "Bit #\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Mnemonic\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE3\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Streaming SIMD Extensions 3 (SSE3). A value of 1 indicates the processor supports this\n"                                                                                           // Colorize: green
                    "technology.\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PCLMULQDQ\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PCLMULQDQ. A value of 1 indicates the processor supports the PCLMULQDQ instruction.\n"                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DTES64\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "64-bit DS Area. A value of 1 indicates the processor supports DS area using 64-bit layout.\n"                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MONITOR\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MONITOR/MWAIT. A value of 1 indicates the processor supports this feature.\n"                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DS-CPL\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CPL Qualified Debug Store. A value of 1 indicates the processor supports the extensions to the\n"                                                                                   // Colorize: green
                    "Debug Store feature to allow for branch message storage qualified by CPL.\n"                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VMX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Virtual Machine Extensions. A value of 1 indicates that the processor supports this technology.\n"                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SMX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Safer Mode Extensions. A value of 1 indicates that the processor supports this technology. See\n"                                                                                   // Colorize: green
                    "Chapter 6, \"Safer Mode Extensions Reference\".\n"                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "EIST\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Enhanced Intel SpeedStep(R) technology. A value of 1 indicates that the processor supports this\n"                                                                                    // Colorize: green
                    "technology.\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TM2\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Thermal Monitor 2. A value of 1 indicates whether the processor supports this technology.\n"                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSSE3\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates the presence of the Supplemental Streaming SIMD Extensions 3 (SSSE3). A\n"                                                                                   // Colorize: green
                    "value of 0 indicates the instruction extensions are not present in the processor.\n"                                                                                                // Colorize: green
                    "";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                                    // Colorize: green
                    "Table 3-10. Feature Information Returned in the ECX Register (Contd.)\n"                                                                                                            // Colorize: green
                    "Bit #\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Mnemonic\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CNXT-ID\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "L1 Context ID. A value of 1 indicates the L1 data cache mode can be set to either adaptive mode\n"                                                                                  // Colorize: green
                    "or shared mode. A value of 0 indicates this feature is not supported. See definition of the\n"                                                                                      // Colorize: green
                    "IA32_MISC_ENABLE MSR Bit 24 (L1 Data Cache Context Mode) for details.\n"                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SDBG\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates the processor supports IA32_DEBUG_INTERFACE MSR for silicon debug.\n"                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FMA\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates the processor supports FMA extensions using YMM state.\n"                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMPXCHG16B\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMPXCHG16B Available. A value of 1 indicates that the feature is available. See the\n"                                                                                              // Colorize: green
                    "\"CMPXCHG8B/CMPXCHG16B-Compare and Exchange Bytes\" section in this chapter for a\n"                                                                                                  // Colorize: green
                    "description.\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "xTPR Update\n"                                                                                                                                                                      // Colorize: green
                    "Control\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "xTPR Update Control. A value of 1 indicates that the processor supports changing\n"                                                                                                 // Colorize: green
                    "IA32_MISC_ENABLE[bit 23].\n"                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PDCM\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Perfmon and Debug Capability: A value of 1 indicates the processor supports the performance\n"                                                                                      // Colorize: green
                    "and debug feature indication MSR IA32_PERF_CAPABILITIES.\n"                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PCID\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Process-context identifiers. A value of 1 indicates that the processor supports PCIDs and that\n"                                                                                   // Colorize: green
                    "software may set CR4.PCIDE to 1.\n"                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "18\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DCA\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates the processor supports the ability to prefetch data from a memory mapped\n"                                                                                  // Colorize: green
                    "device.\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE4_1\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports SSE4.1.\n"                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE4_2\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports SSE4.2.\n"                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "21\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "x2APIC\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports x2APIC feature.\n"                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "22\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MOVBE\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports MOVBE instruction.\n"                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "POPCNT\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports the POPCNT instruction.\n"                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TSC-Deadline\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor's local APIC timer supports one-shot operation using a\n"                                                                                 // Colorize: green
                    "TSC deadline value.\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "25\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AESNI\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports the AESNI instruction extensions.\n"                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "26\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "XSAVE\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the processor supports the XSAVE/XRSTOR processor extended states\n"                                                                                    // Colorize: green
                    "feature, the XSETBV/XGETBV instructions, and XCR0.\n"                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "27\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "OSXSAVE\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that the OS has set CR4.OSXSAVE[bit 18] to enable XSETBV/XGETBV\n"                                                                                           // Colorize: green
                    "instructions to access XCR0 and to support processor extended state management using\n"                                                                                             // Colorize: green
                    "XSAVE/XRSTOR.\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "28\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AVX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates the processor supports the AVX instruction extensions.\n"                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "29\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "F16C\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that processor supports 16-bit floating-point conversion instructions.\n"                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "30\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RDRAND\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "A value of 1 indicates that processor supports RDRAND instruction.\n"                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Not Used\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Always returns 0.";                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000001_ECX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "Table 3-10. Feature Information Returned in the ECX Register"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != "Bit #"                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "Mnemonic"                                                                                                                                                        // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Description"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000001_ECX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 7;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                         // Colorize: green
                        description.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (                                                                                                                                                                                 // Colorize: green
                        field != "Reserved"                                                                                                                                                              // Colorize: green
                        &&                                                                                                                                                                               // Colorize: green
                        field != "Not Used"                                                                                                                                                              // Colorize: green
                       )                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        fields.append(field.toUpper().replace('-', '_'));                                                                                                                                // Colorize: green
                        values.append("WORD_BIT(x86FeatureWord::CPUID_00000001_ECX, " + value + ')');                                                                                                    // Colorize: green
                        descriptions.append(description.simplified());                                                                                                                                   // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field == "SSSE3")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 9;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000001_ECX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000001_EDX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "Table 3-11. More on Feature Information Returned in the EDX Register\n"                                                                                                             // Colorize: green
                    "Bit #\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Mnemonic\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FPU\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Floating Point Unit On-Chip. The processor contains an x87 FPU.\n"                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VME\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Virtual 8086 Mode Enhancements. Virtual 8086 mode enhancements, including CR4.VME for controlling the\n"                                                                            // Colorize: green
                    "feature, CR4.PVI for protected mode virtual interrupts, software interrupt indirection, expansion of the TSS\n"                                                                     // Colorize: green
                    "with the software indirection bitmap, and EFLAGS.VIF and EFLAGS.VIP flags.\n"                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DE\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Debugging Extensions. Support for I/O breakpoints, including CR4.DE for controlling the feature, and optional\n"                                                                    // Colorize: green
                    "trapping of accesses to DR4 and DR5.\n"                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page Size Extension. Large pages of size 4 MByte are supported, including CR4.PSE for controlling the\n"                                                                            // Colorize: green
                    "feature, the defined dirty bit in PDE (Page Directory Entries), optional reserved bit trapping in CR3, PDEs, and\n"                                                                 // Colorize: green
                    "PTEs.\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TSC\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Time Stamp Counter. The RDTSC instruction is supported, including CR4.TSD for controlling privilege.\n"                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MSR\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Model Specific Registers RDMSR and WRMSR Instructions. The RDMSR and WRMSR instructions are\n"                                                                                      // Colorize: green
                    "supported. Some of the MSRs are implementation dependent.\n"                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PAE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Physical Address Extension. Physical addresses greater than 32 bits are supported: extended page table\n"                                                                           // Colorize: green
                    "entry formats, an extra level in the page translation tables is defined, 2-MByte pages are supported instead of\n"                                                                  // Colorize: green
                    "4 Mbyte pages if PAE bit is 1.\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Machine Check Exception. Exception 18 is defined for Machine Checks, including CR4.MCE for controlling the\n"                                                                       // Colorize: green
                    "feature. This feature does not define the model-specific implementations of machine-check error logging,\n"                                                                         // Colorize: green
                    "reporting, and processor shutdowns. Machine Check exception handlers may have to depend on processor\n"                                                                             // Colorize: green
                    "version to do model specific processing of the exception, or test for the presence of the Machine Check feature.\n"                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CX8\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMPXCHG8B Instruction. The compare-and-exchange 8 bytes (64 bits) instruction is supported (implicitly\n"                                                                           // Colorize: green
                    "locked and atomic).\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "APIC\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "APIC On-Chip. The processor contains an Advanced Programmable Interrupt Controller (APIC), responding to\n"                                                                         // Colorize: green
                    "memory mapped commands in the physical address range FFFE0000H to FFFE0FFFH (by default - some\n"                                                                                   // Colorize: green
                    "processors permit the APIC to be relocated).\n"                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEP\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SYSENTER and SYSEXIT Instructions. The SYSENTER and SYSEXIT and associated MSRs are supported.\n"                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MTRR\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Memory Type Range Registers. MTRRs are supported. The MTRRcap MSR contains feature bits that describe\n"                                                                            // Colorize: green
                    "what memory types are supported, how many variable MTRRs are supported, and whether fixed MTRRs are\n"                                                                              // Colorize: green
                    "supported.\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PGE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page Global Bit. The global bit is supported in paging-structure entries that map a page, indicating TLB entries\n"                                                                 // Colorize: green
                    "that are common to different processes and need not be flushed. The CR4.PGE bit controls this feature.\n"                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCA\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Machine Check Architecture. A value of 1 indicates the Machine Check Architecture of reporting machine\n"                                                                           // Colorize: green
                    "errors is supported. The MCG_CAP MSR contains feature bits describing how many banks of error reporting\n"                                                                          // Colorize: green
                    "MSRs are supported.\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMOV\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Conditional Move Instructions. The conditional move instruction CMOV is supported. In addition, if x87 FPU is\n"                                                                    // Colorize: green
                    "present as indicated by the CPUID.FPU feature bit, then the FCOMI and FCMOV instructions are supported\n"                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PAT\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page Attribute Table. Page Attribute Table is supported. This feature augments the Memory Type Range\n"                                                                             // Colorize: green
                    "Registers (MTRRs), allowing an operating system to specify attributes of memory accessed through a linear\n"                                                                        // Colorize: green
                    "address on a 4KB granularity.\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSE-36\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "36-Bit Page Size Extension. 4-MByte pages addressing physical memory beyond 4 GBytes are supported with\n"                                                                          // Colorize: green
                    "32-bit paging. This feature indicates that upper bits of the physical address of a 4-MByte page are encoded in\n"                                                                   // Colorize: green
                    "bits 20:13 of the page-directory entry. Such physical addresses are limited by MAXPHYADDR and may be up to\n"                                                                       // Colorize: green
                    "40 bits in size.\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "18\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSN\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor Serial Number. The processor supports the 96-bit processor identification number feature and the\n"                                                                       // Colorize: green
                    "feature is enabled.\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CLFSH\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CLFLUSH Instruction. CLFLUSH Instruction is supported.\n"                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                                    // Colorize: green
                    "Table 3-11. More on Feature Information Returned in the EDX Register (Contd.)\n"                                                                                                    // Colorize: green
                    "Bit #\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Mnemonic\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "21\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DS\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Debug Store. The processor supports the ability to write debug information into a memory resident buffer.\n"                                                                        // Colorize: green
                    "This feature is used by the branch trace store (BTS) and processor event-based sampling (PEBS) facilities (see\n"                                                                   // Colorize: green
                    "Chapter 23, \"Introduction to Virtual-Machine Extensions,\" in the Intel(R) 64 and IA-32 Architectures Software\n"                                                                      // Colorize: green
                    "Developer's Manual, Volume 3C).\n"                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "22\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ACPI\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Thermal Monitor and Software Controlled Clock Facilities. The processor implements internal MSRs that\n"                                                                            // Colorize: green
                    "allow processor temperature to be monitored and processor performance to be modulated in predefined duty\n"                                                                         // Colorize: green
                    "cycles under software control.\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MMX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Intel MMX Technology. The processor supports the Intel MMX technology.\n"                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FXSR\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FXSAVE and FXRSTOR Instructions. The FXSAVE and FXRSTOR instructions are supported for fast save and\n"                                                                             // Colorize: green
                    "restore of the floating point context. Presence of this bit also indicates that CR4.OSFXSR is available for an\n"                                                                   // Colorize: green
                    "operating system to indicate that it supports the FXSAVE and FXRSTOR instructions.\n"                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "25\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE. The processor supports the SSE extensions.\n"                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "26\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE2\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE2. The processor supports the SSE2 extensions.\n"                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "27\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SS\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Self Snoop. The processor supports the management of conflicting memory types by performing a snoop of its\n"                                                                       // Colorize: green
                    "own cache structure for transactions issued to the bus.\n"                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "28\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "HTT\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Max APIC IDs reserved field is Valid. A value of 0 for HTT indicates there is only a single logical processor in\n"                                                                 // Colorize: green
                    "the package and software should assume only a single APIC ID is reserved. A value of 1 for HTT indicates the\n"                                                                     // Colorize: green
                    "value in CPUID.1.EBX[23:16] (the Maximum number of addressable IDs for logical processors in this package) is\n"                                                                    // Colorize: green
                    "valid for the package.\n"                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "29\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TM\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Thermal Monitor. The processor implements the thermal monitor automatic thermal control circuitry (TCC).\n"                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "30\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PBE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Pending Break Enable. The processor supports the use of the FERR#/PBE# pin when the processor is in the\n"                                                                          // Colorize: green
                    "stop-clock state (STPCLK# is asserted) to signal the processor that an interrupt is pending and that the\n"                                                                         // Colorize: green
                    "processor should return to normal operation to handle the interrupt.";                                                                                                              // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000001_EDX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "Table 3-11. More on Feature Information Returned in the EDX Register"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != "Bit #"                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "Mnemonic"                                                                                                                                                        // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Description"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000001_EDX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 7;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                         // Colorize: green
                        description.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "Reserved")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        fields.append(field.toUpper().replace('-', '_'));                                                                                                                                // Colorize: green
                        values.append("WORD_BIT(x86FeatureWord::CPUID_00000001_EDX, " + value + ')');                                                                                                                                                            // Colorize: green
                        descriptions.append(description.simplified());                                                                                                                                   // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field == "Reserved" && value == "20")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 9;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000001_EDX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000006_EAX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "EAX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bit 00: Digital temperature sensor is supported if set.\n"                                                                                                                          // Colorize: green
                    "Bit 01: Intel Turbo Boost Technology available (see description of IA32_MISC_ENABLE[38]).\n"                                                                                        // Colorize: green
                    "Bit 02: ARAT. APIC-Timer-always-running feature is supported if set.\n"                                                                                                             // Colorize: green
                    "Bit 03: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 04: PLN. Power limit notification controls are supported if set.\n"                                                                                                             // Colorize: green
                    "Bit 05: ECMD. Clock modulation duty cycle extension is supported if set.\n"                                                                                                         // Colorize: green
                    "Bit 06: PTM. Package thermal management is supported if set.\n"                                                                                                                     // Colorize: green
                    "Bit 07: HWP. HWP base registers (IA32_PM_ENABLE[bit 0], IA32_HWP_CAPABILITIES,\n"                                                                                                   // Colorize: green
                    "IA32_HWP_REQUEST, IA32_HWP_STATUS) are supported if set.\n"                                                                                                                         // Colorize: green
                    "Bit 08: HWP_Notification. IA32_HWP_INTERRUPT MSR is supported if set.\n"                                                                                                            // Colorize: green
                    "Bit 09: HWP_Activity_Window. IA32_HWP_REQUEST[bits 41:32] is supported if set.\n"                                                                                                   // Colorize: green
                    "Bit 10: HWP_Energy_Performance_Preference. IA32_HWP_REQUEST[bits 31:24] is supported if set.\n"                                                                                     // Colorize: green
                    "Bit 11: HWP_Package_Level_Request. IA32_HWP_REQUEST_PKG MSR is supported if set.\n"                                                                                                 // Colorize: green
                    "Bit 12: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 13: HDC. HDC base registers IA32_PKG_HDC_CTL, IA32_PM_CTL1, IA32_THREAD_STALL MSRs are\n"                                                                                       // Colorize: green
                    "supported if set.\n"                                                                                                                                                                // Colorize: green
                    "Bit 14: Intel(R) Turbo Boost Max Technology 3.0 available.\n"                                                                                                                         // Colorize: green
                    "Bit 15: HWP Capabilities. Highest Performance change is supported if set.\n"                                                                                                        // Colorize: green
                    "Bit 16: HWP PECI override is supported if set.\n"                                                                                                                                   // Colorize: green
                    "Bit 17: Flexible HWP is supported if set.\n"                                                                                                                                        // Colorize: green
                    "Bit 18: Fast access mode for the IA32_HWP_REQUEST MSR is supported if set.\n"                                                                                                       // Colorize: green
                    "Bit 19: HW_FEEDBACK. IA32_HW_FEEDBACK_PTR MSR, IA32_HW_FEEDBACK_CONFIG MSR,\n"                                                                                                      // Colorize: green
                    "IA32_PACKAGE_THERM_STATUS MSR bit 26, and IA32_PACKAGE_THERM_INTERRUPT MSR bit 25 are\n"                                                                                            // Colorize: green
                    "supported if set.\n"                                                                                                                                                                // Colorize: green
                    "Bit 20: Ignoring Idle Logical Processor HWP request is supported if set.\n"                                                                                                         // Colorize: green
                    "Bits 22 - 21: Reserved.\n"                                                                                                                                                          // Colorize: green
                    "Bit 23: Intel(R) Thread Director supported if set. IA32_HW_FEEDBACK_CHAR and\n"                                                                                                       // Colorize: green
                    "IA32_HW_FEEDBACK_THREAD_CONFIG MSRs are supported if set.\n"                                                                                                                        // Colorize: green
                    "Bits 31 - 24: Reserved.";                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000006_EAX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = cpuidText.split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "EAX"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000006_EAX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 2;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                              // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Digital temperature sensor is supported if set.",                                      "DTHERM");                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Intel Turbo Boost Technology available (see description of IA32_MISC_ENABLE[38]).",    "IDA");                                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ARAT. APIC-Timer-always-running feature is supported if set.",                         "ARAT");                                                                          // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PLN. Power limit notification controls are supported if set.",                         "PLN");                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ECMD. Clock modulation duty cycle extension is supported if set.",                     "ECMD");                                                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PTM. Package thermal management is supported if set.",                                 "PTS");                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP. HWP base registers (IA32_PM_ENABLE[bit 0], IA32_HWP_CAPABILITIES,",               "HWP");                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP_Notification. IA32_HWP_INTERRUPT MSR is supported if set.",                        "HWP_NOTIFY");                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP_Activity_Window. IA32_HWP_REQUEST[bits 41:32] is supported if set.",               "HWP_ACT_WINDOW");                                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP_Energy_Performance_Preference. IA32_HWP_REQUEST[bits 31:24] is supported if set.", "HWP_EPP");                                               // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP_Package_Level_Request. IA32_HWP_REQUEST_PKG MSR is supported if set.",             "HWP_PKG_REQ");                                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HDC. HDC base registers IA32_PKG_HDC_CTL, IA32_PM_CTL1, IA32_THREAD_STALL MSRs are",   "HDC");                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Intel(R) Turbo Boost Max Technology 3.0 available.",                                   "TURBO_BOOST_MAX_3");                                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP Capabilities. Highest Performance change is supported if set.",                    "HWP_CAPABILITIES");                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWP PECI override is supported if set.",                                               "HWP_PECI");                                                                                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Flexible HWP is supported if set.",                                                    "FLEXIBLE_HWP");                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Fast access mode for the IA32_HWP_REQUEST MSR is supported if set.",                   "FAST_ACCESS_MODE_HWP_REQ");                                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HW_FEEDBACK. IA32_HW_FEEDBACK_PTR MSR, IA32_HW_FEEDBACK_CONFIG MSR,",                  "HW_FEEDBACK");                                                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Ignoring Idle Logical Processor HWP request is supported if set.",                     "IGNORE_IDLE_PROCESSOR");                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Intel(R) Thread Director supported if set. IA32_HW_FEEDBACK_CHAR and",                 "THREAD_DIRECTOR");                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                while (i < lines.size())                                                                                                                                                                         // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    if (match.hasMatch())                                                                                                                                                                        // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        QString bit         = match.captured(1);                                                                                                                                         // Colorize: green
                        QString field       = match.captured(2).simplified();                                                                                                                            // Colorize: green
                        QString description = field;                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                        // Colorize: green
                        if (field != "Reserved." && !bit.contains('-'))                                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            field = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                                    // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                            if (field == "")                                                                                                                                                                              // Colorize: green
                            {                                                                                                                                                                                            // Colorize: green
                                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                            .arg(line)                                                                                                                                           // Colorize: green
                                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                                return;                                                                                                                                                                                  // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append(field);                                                                                                                                                            // Colorize: green
                            values.append("WORD_BIT(x86FeatureWord::CPUID_00000006_EAX, " + QString::number(bit.toLongLong()) + ')');                                                                    // Colorize: green
                            descriptions.append(description);                                                                                                                                                            // Colorize: green
                        }                                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                    else                                                                                                                                                                                         // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        descriptions[descriptions.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    ++i;                                                                                                                                                                                         // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000006_EAX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000007_0_EBX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "EBX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bit 00: FSGSBASE. Supports RDFSBASE/RDGSBASE/WRFSBASE/WRGSBASE if 1.\n"                                                                                                             // Colorize: green
                    "Bit 01: IA32_TSC_ADJUST MSR is supported if 1.\n"                                                                                                                                   // Colorize: green
                    "Bit 02: SGX. Supports Intel(R) Software Guard Extensions (Intel(R) SGX Extensions) if 1.\n"                                                                                         // Colorize: green
                    "Bit 03: BMI1.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 04: HLE.\n"                                                                                                                                                                     // Colorize: green
                    "Bit 05: AVX2.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 06: FDP_EXCPTN_ONLY. x87 FPU Data Pointer updated only on x87 exceptions if 1.\n"                                                                                               // Colorize: green
                    "Bit 07: SMEP. Supports Supervisor-Mode Execution Prevention if 1.\n"                                                                                                                // Colorize: green
                    "Bit 08: BMI2.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 09: Supports Enhanced REP MOVSB/STOSB if 1.\n"                                                                                                                                  // Colorize: green
                    "Bit 10: INVPCID. If 1, supports INVPCID instruction for system software that manages process-context\n"                                                                             // Colorize: green
                    "identifiers.\n"                                                                                                                                                                     // Colorize: green
                    "Bit 11: RTM.\n"                                                                                                                                                                     // Colorize: green
                    "Bit 12: RDT-M. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Monitoring capability if 1.\n"                                                                         // Colorize: green
                    "Bit 13: Deprecates FPU CS and FPU DS values if 1.\n"                                                                                                                                // Colorize: green
                    "Bit 14: MPX. Supports Intel(R) Memory Protection Extensions if 1.\n"                                                                                                                // Colorize: green
                    "Bit 15: RDT-A. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Allocation capability if 1.\n"                                                                         // Colorize: green
                    "Bit 16: AVX512F.\n"                                                                                                                                                                 // Colorize: green
                    "Bit 17: AVX512DQ.\n"                                                                                                                                                                // Colorize: green
                    "Bit 18: RDSEED.\n"                                                                                                                                                                  // Colorize: green
                    "Bit 19: ADX.\n"                                                                                                                                                                     // Colorize: green
                    "Bit 20: SMAP. Supports Supervisor-Mode Access Prevention (and the CLAC/STAC instructions) if 1.\n"                                                                                  // Colorize: green
                    "Bit 21: AVX512_IFMA.\n"                                                                                                                                                             // Colorize: green
                    "Bit 22: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 23: CLFLUSHOPT.\n"                                                                                                                                                              // Colorize: green
                    "Bit 24: CLWB.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 25: Intel Processor Trace.\n"                                                                                                                                                   // Colorize: green
                    "Bit 26: AVX512PF. (Intel(R) Xeon Phi(TM) only.)\n"                                                                                                                                  // Colorize: green
                    "Bit 27: AVX512ER. (Intel(R) Xeon Phi(TM) only.)\n"                                                                                                                                  // Colorize: green
                    "Bit 28: AVX512CD.\n"                                                                                                                                                                // Colorize: green
                    "Bit 29: SHA. supports Intel(R) Secure Hash Algorithm Extensions (Intel(R) SHA Extensions) if 1.\n"                                                                                  // Colorize: green
                    "Bit 30: AVX512BW.\n"                                                                                                                                                                // Colorize: green
                    "Bit 31: AVX512VL.";                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000007_0_EBX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = cpuidText.split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "EBX"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000007_0_EBX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 2;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                              // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FSGSBASE. Supports RDFSBASE/RDGSBASE/WRFSBASE/WRGSBASE if 1.",                                     "FSGSBASE");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IA32_TSC_ADJUST MSR is supported if 1.",                                                           "TSC_ADJUST");                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SGX. Supports Intel(R) Software Guard Extensions (Intel(R) SGX Extensions) if 1.",                 "SGX");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("BMI1.",                                                                                            "BMI1");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HLE.",                                                                                             "HLE");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX2.",                                                                                            "AVX2");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FDP_EXCPTN_ONLY. x87 FPU Data Pointer updated only on x87 exceptions if 1.",                       "FDP_EXCPTN_ONLY");                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SMEP. Supports Supervisor-Mode Execution Prevention if 1.",                                        "SMEP");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("BMI2.",                                                                                            "BMI2");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Supports Enhanced REP MOVSB/STOSB if 1.",                                                          "ERMS");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("INVPCID. If 1, supports INVPCID instruction for system software that manages process-context",     "INVPCID");                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RTM.",                                                                                             "RTM");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDT-M. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Monitoring capability if 1.", "CQM");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Deprecates FPU CS and FPU DS values if 1.",                                                        "DEPRECATE_FPU_CS_DS");                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MPX. Supports Intel(R) Memory Protection Extensions if 1.",                                        "MPX");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDT-A. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Allocation capability if 1.", "RDT_A");                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512F.",                                                                                         "AVX512F");                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512DQ.",                                                                                        "AVX512DQ");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDSEED.",                                                                                          "RDSEED");                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ADX.",                                                                                             "ADX");                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SMAP. Supports Supervisor-Mode Access Prevention (and the CLAC/STAC instructions) if 1.",          "SMAP");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_IFMA.",                                                                                     "AVX512IFMA");                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CLFLUSHOPT.",                                                                                      "CLFLUSHOPT");                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CLWB.",                                                                                            "CLWB");                                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Intel Processor Trace.",                                                                           "INTEL_PT");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512PF. (Intel(R) Xeon Phi(TM) only.)",                                                          "AVX512PF");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512ER. (Intel(R) Xeon Phi(TM) only.)",                                                          "AVX512ER");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512CD.",                                                                                        "AVX512CD");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SHA. supports Intel(R) Secure Hash Algorithm Extensions (Intel(R) SHA Extensions) if 1.",          "SHA_NI");                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512BW.",                                                                                        "AVX512BW");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512VL.",                                                                                        "AVX512VL");                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                while (i < lines.size())                                                                                                                                                                         // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    if (match.hasMatch())                                                                                                                                                                        // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        QString bit         = match.captured(1);                                                                                                                                         // Colorize: green
                        QString field       = match.captured(2).simplified();                                                                                                                            // Colorize: green
                        QString description = field;                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                        // Colorize: green
                        if (field != "Reserved." && !bit.contains('-'))                                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            field = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                                    // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                            if (field == "")                                                                                                                                                                              // Colorize: green
                            {                                                                                                                                                                                            // Colorize: green
                                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                            .arg(line)                                                                                                                                           // Colorize: green
                                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                                return;                                                                                                                                                                                  // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append(field);                                                                                                                                                            // Colorize: green
                            values.append("WORD_BIT(x86FeatureWord::CPUID_00000007_0_EBX, " + QString::number(bit.toLongLong()) + ')');                                                                    // Colorize: green
                            descriptions.append(description);                                                                                                                                                            // Colorize: green
                        }                                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                    else                                                                                                                                                                                         // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        descriptions[descriptions.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    ++i;                                                                                                                                                                                         // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000007_0_EBX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000007_0_ECX                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                                    // Colorize: green
                    "ECX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bit 00: PREFETCHWT1. (Intel(R) Xeon Phi(TM) only.)\n"                                                                                                                                    // Colorize: green
                    "Bit 01: AVX512_VBMI.\n"                                                                                                                                                             // Colorize: green
                    "Bit 02: UMIP. Supports user-mode instruction prevention if 1.\n"                                                                                                                    // Colorize: green
                    "Bit 03: PKU. Supports protection keys for user-mode pages if 1.\n"                                                                                                                  // Colorize: green
                    "Bit 04: OSPKE. If 1, OS has set CR4.PKE to enable protection keys (and the RDPKRU/WRPKRU instructions).\n"                                                                          // Colorize: green
                    "Bit 05: WAITPKG.\n"                                                                                                                                                                 // Colorize: green
                    "Bit 06: AVX512_VBMI2.\n"                                                                                                                                                            // Colorize: green
                    "Bit 07: CET_SS. Supports CET shadow stack features if 1. Processors that set this bit define bits 1:0 of the\n"                                                                     // Colorize: green
                    "IA32_U_CET and IA32_S_CET MSRs. Enumerates support for the following MSRs:\n"                                                                                                       // Colorize: green
                    "IA32_INTERRUPT_SPP_TABLE_ADDR, IA32_PL3_SSP, IA32_PL2_SSP, IA32_PL1_SSP, and\n"                                                                                                     // Colorize: green
                    "IA32_PL0_SSP.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 08: GFNI.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 09: VAES.\n"                                                                                                                                                                    // Colorize: green
                    "Bit 10: VPCLMULQDQ.\n"                                                                                                                                                              // Colorize: green
                    "Bit 11: AVX512_VNNI.\n"                                                                                                                                                             // Colorize: green
                    "Bit 12: AVX512_BITALG.\n"                                                                                                                                                           // Colorize: green
                    "Bits 13: TME_EN. If 1, the following MSRs are supported: IA32_TME_CAPABILITY, IA32_TME_ACTIVATE,\n"                                                                                 // Colorize: green
                    "IA32_TME_EXCLUDE_MASK, and IA32_TME_EXCLUDE_BASE.\n"                                                                                                                                // Colorize: green
                    "Bit 14: AVX512_VPOPCNTDQ.\n"                                                                                                                                                        // Colorize: green
                    "Bit 15: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 16: LA57. Supports 57-bit linear addresses and five-level paging if 1.\n"                                                                                                       // Colorize: green
                    "Bits 21 - 17: The value of MAWAU used by the BNDLDX and BNDSTX instructions in 64-bit mode.\n"                                                                                      // Colorize: green
                    "Bit 22: RDPID and IA32_TSC_AUX are available if 1.\n"                                                                                                                               // Colorize: green
                    "Bit 23: KL. Supports Key Locker if 1.\n"                                                                                                                                            // Colorize: green
                    "Bit 24: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 25: CLDEMOTE. Supports cache line demote if 1.\n"                                                                                                                               // Colorize: green
                    "Bit 26: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 27: MOVDIRI. Supports MOVDIRI if 1.\n"                                                                                                                                          // Colorize: green
                    "Bit 28: MOVDIR64B. Supports MOVDIR64B if 1.\n"                                                                                                                                      // Colorize: green
                    "Bit 29: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 30: SGX_LC. Supports SGX Launch Configuration if 1.\n"                                                                                                                          // Colorize: green
                    "Bit 31: PKS. Supports protection keys for supervisor-mode pages if 1.";                                                                                                             // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000007_0_ECX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = cpuidText.split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "ECX"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000007_0_ECX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 2;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                              // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PREFETCHWT1. (Intel(R) Xeon Phi(TM) only.)",                                                           "PREFETCHWT1");                          // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_VBMI.",                                                                                         "AVX512VBMI");                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("UMIP. Supports user-mode instruction prevention if 1.",                                                "UMIP");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PKU. Supports protection keys for user-mode pages if 1.",                                              "PKU");                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("OSPKE. If 1, OS has set CR4.PKE to enable protection keys (and the RDPKRU/WRPKRU instructions).",      "OSPKE");                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("WAITPKG.",                                                                                             "WAITPKG");                               // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_VBMI2.",                                                                                        "AVX512_VBMI2");                          // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CET_SS. Supports CET shadow stack features if 1. Processors that set this bit define bits 1:0 of the", "CET_SS");                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("GFNI.",                                                                                                "GFNI");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VAES.",                                                                                                "VAES");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VPCLMULQDQ.",                                                                                          "VPCLMULQDQ");                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_VNNI.",                                                                                         "AVX512_VNNI");                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_BITALG.",                                                                                       "AVX512_BITALG");                         // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TME_EN. If 1, the following MSRs are supported: IA32_TME_CAPABILITY, IA32_TME_ACTIVATE,",              "TME");                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_VPOPCNTDQ.",                                                                                    "AVX512_VPOPCNTDQ");                      // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LA57. Supports 57-bit linear addresses and five-level paging if 1.",                                   "LA57");                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDPID and IA32_TSC_AUX are available if 1.",                                                           "RDPID");                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("KL. Supports Key Locker if 1.",                                                                        "KL");                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CLDEMOTE. Supports cache line demote if 1.",                                                           "CLDEMOTE");                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MOVDIRI. Supports MOVDIRI if 1.",                                                                      "MOVDIRI");                               // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MOVDIR64B. Supports MOVDIR64B if 1.",                                                                  "MOVDIR64B");                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SGX_LC. Supports SGX Launch Configuration if 1.",                                                      "SGX_LC");                                // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PKS. Supports protection keys for supervisor-mode pages if 1.",                                        "PKS");                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                while (i < lines.size())                                                                                                                                                                         // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    if (match.hasMatch())                                                                                                                                                                        // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        QString bit         = match.captured(1);                                                                                                                                         // Colorize: green
                        QString field       = match.captured(2).simplified();                                                                                                                            // Colorize: green
                        QString description = field;                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                        // Colorize: green
                        if (field != "Reserved." && !bit.contains('-'))                                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            field = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                                    // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                            if (field == "")                                                                                                                                                                              // Colorize: green
                            {                                                                                                                                                                                            // Colorize: green
                                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                            .arg(line)                                                                                                                                           // Colorize: green
                                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                                return;                                                                                                                                                                                  // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append(field);                                                                                                                                                            // Colorize: green
                            values.append("WORD_BIT(x86FeatureWord::CPUID_00000007_0_ECX, " + QString::number(bit.toLongLong()) + ')');                                                                    // Colorize: green
                            descriptions.append(description);                                                                                                                                                            // Colorize: green
                        }                                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                    else                                                                                                                                                                                         // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        descriptions[descriptions.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    ++i;                                                                                                                                                                                         // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000007_0_ECX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for x86FeatureWord::CPUID_00000007_0_EDX                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "EDX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bit 01: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 02: AVX512_4VNNIW. (Intel(R) Xeon Phi(TM) only.)\n"                                                                                                                                  // Colorize: green
                    "Bit 03: AVX512_4FMAPS. (Intel(R) Xeon Phi(TM) only.)\n"                                                                                                                                  // Colorize: green
                    "Bit 04: Fast Short REP MOV.\n"                                                                                                                                                      // Colorize: green
                    "Bits 07-05: Reserved.\n"                                                                                                                                                            // Colorize: green
                    "Bit 08: AVX512_VP2INTERSECT.\n"                                                                                                                                                     // Colorize: green
                    "Bit 09: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 10: MD_CLEAR supported.\n"                                                                                                                                                      // Colorize: green
                    "Bits 13-11: Reserved.\n"                                                                                                                                                            // Colorize: green
                    "Bit 14: SERIALIZE.\n"                                                                                                                                                               // Colorize: green
                    "Bit 15: Hybrid. If 1, the processor is identified as a hybrid part.\n"                                                                                                              // Colorize: green
                    "Bits 17-16: Reserved.\n"                                                                                                                                                            // Colorize: green
                    "Bit 18: PCONFIG. Supports PCONFIG if 1.\n"                                                                                                                                          // Colorize: green
                    "Bit 19: Reserved.\n"                                                                                                                                                                // Colorize: green
                    "Bit 20: CET_IBT. Supports CET indirect branch tracking features if 1. Processors that set this bit define\n"                                                                        // Colorize: green
                    "bits 5:2 and bits 63:10 of the IA32_U_CET and IA32_S_CET MSRs.\n"                                                                                                                   // Colorize: green
                    "Bits 25 - 21: Reserved.\n"                                                                                                                                                          // Colorize: green
                    "Bit 26: Enumerates support for indirect branch restricted speculation (IBRS) and the indirect branch predictor barrier (IBPB). Processors that set this bit support the IA32_SPEC_CTRL MSR and the\n" // Colorize: green
                    "IA32_PRED_CMD MSR. They allow software to set IA32_SPEC_CTRL[0] (IBRS) and IA32_PRED_CMD[0]\n"                                                                                      // Colorize: green
                    "(IBPB).";                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "Table 3-8. Information Returned by CPUID Instruction (Contd.)\n"                                                                                                                    // Colorize: green
                    "Initial EAX\n"                                                                                                                                                                      // Colorize: green
                    "Value\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Information Provided about the Processor\n"                                                                                                                                         // Colorize: green
                    "Bit 27: Enumerates support for single thread indirect branch predictors (STIBP). Processors that set this\n"                                                                        // Colorize: green
                    "bit support the IA32_SPEC_CTRL MSR. They allow software to set IA32_SPEC_CTRL[1] (STIBP).\n"                                                                                        // Colorize: green
                    "Bit 28: Enumerates support for L1D_FLUSH. Processors that set this bit support the IA32_FLUSH_CMD\n"                                                                                // Colorize: green
                    "MSR. They allow software to set IA32_FLUSH_CMD[0] (L1D_FLUSH).\n"                                                                                                                   // Colorize: green
                    "Bit 29: Enumerates support for the IA32_ARCH_CAPABILITIES MSR.\n"                                                                                                                   // Colorize: green
                    "Bit 30: Enumerates support for the IA32_CORE_CAPABILITIES MSR.\n"                                                                                                                   // Colorize: green
                    "IA32_CORE_CAPABILITIES is an architectural MSR that enumerates model-specific features. A bit being\n"                                                                              // Colorize: green
                    "set in this MSR indicates that a model specific feature is supported; software must still consult CPUID\n"                                                                          // Colorize: green
                    "family/model/stepping to determine the behavior of the enumerated feature as features enumerated in\n"                                                                              // Colorize: green
                    "IA32_CORE_CAPABILITIES may have different behavior on different processor models.\n"                                                                                                // Colorize: green
                    "Additionally, on hybrid parts (CPUID.07H.0H:EDX[15]=1), software must consult the native model ID and\n"                                                                            // Colorize: green
                    "core type from the Hybrid Information Enumeration Leaf.\n"                                                                                                                          // Colorize: green
                    "Bit 31: Enumerates support for Speculative Store Bypass Disable (SSBD). Processors that set this bit support the IA32_SPEC_CTRL MSR. They allow software to set IA32_SPEC_CTRL[2] (SSBD)."; // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for x86FeatureWord::CPUID_00000007_0_EDX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "EDX"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for x86FeatureWord::CPUID_00000007_0_EDX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 2;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                              // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_4VNNIW. (Intel(R) Xeon Phi(TM) only.)",                                                                                                                                               "AVX512_4VNNIW"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_4FMAPS. (Intel(R) Xeon Phi(TM) only.)",                                                                                                                                               "AVX512_4FMAPS"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Fast Short REP MOV.",                                                                                                                                                                        "FAST_MOV"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVX512_VP2INTERSECT.",                                                                                                                                                                       "AVX512_VP2INTERSECT"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MD_CLEAR supported.",                                                                                                                                                                        "MD_CLEAR"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SERIALIZE.",                                                                                                                                                                                 "SERIALIZE"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Hybrid. If 1, the processor is identified as a hybrid part.",                                                                                                                                "HYBRID"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PCONFIG. Supports PCONFIG if 1.",                                                                                                                                                            "PCONFIG"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CET_IBT. Supports CET indirect branch tracking features if 1. Processors that set this bit define",                                                                                          "CET_IBT"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for indirect branch restricted speculation (IBRS) and the indirect branch predictor barrier (IBPB). Processors that set this bit support the IA32_SPEC_CTRL MSR and the", "SPEC_CTRL"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for single thread indirect branch predictors (STIBP). Processors that set this",                                                                                          "INTEL_STIBP"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for L1D_FLUSH. Processors that set this bit support the IA32_FLUSH_CMD",                                                                                                  "FLUSH_L1D"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for the IA32_ARCH_CAPABILITIES MSR.",                                                                                                                                     "ARCH_CAPABILITIES"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for the IA32_CORE_CAPABILITIES MSR.",                                                                                                                                     "CORE_CAPABILITIES"); // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Enumerates support for Speculative Store Bypass Disable (SSBD). Processors that set this bit support the IA32_SPEC_CTRL MSR. They allow software to set IA32_SPEC_CTRL[2] (SSBD).",          "SPEC_CTRL_SSBD"); // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                while (i < lines.size())                                                                                                                                                                         // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    QString line = lines.at(i);                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (line == "Table 3-8. Information Returned by CPUID Instruction (Contd.)")                                                                                                         // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                         i += 5;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                         continue;                                                                                                                                                                       // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    if (match.hasMatch())                                                                                                                                                                        // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        QString bit         = match.captured(1);                                                                                                                                         // Colorize: green
                        QString field       = match.captured(2).simplified();                                                                                                                            // Colorize: green
                        QString description = field;                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                        // Colorize: green
                        if (field != "Reserved." && !bit.contains('-'))                                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            field = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                                    // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                            if (field == "")                                                                                                                                                                              // Colorize: green
                            {                                                                                                                                                                                            // Colorize: green
                                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                            .arg(line)                                                                                                                                           // Colorize: green
                                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                         // Colorize: green
                                return;                                                                                                                                                                                  // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append(field);                                                                                                                                                            // Colorize: green
                            values.append("WORD_BIT(x86FeatureWord::CPUID_00000007_0_EDX, " + QString::number(bit.toLongLong()) + ')');                                                                    // Colorize: green
                            descriptions.append(description);                                                                                                                                                            // Colorize: green
                        }                                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                    else                                                                                                                                                                                         // Colorize: green
                    {                                                                                                                                                                                            // Colorize: green
                        descriptions[descriptions.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
                    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    ++i;                                                                                                                                                                                         // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("Intel-defined CPU features, x86FeatureWord::CPUID_00000007_0_EDX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class X86Feature: good_U16 // Ignore CppEnumVerifier");                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < groups.size(); ++i)                                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            if (i > 0)                                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                cpuidLines.append("");                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                              // Colorize: green
            cpuidLines.append("    // " + groups.at(i));                                                                                                                                                                              // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            const QStringList &fields       = fieldGroups.at(i);                                                                                                                                         // Colorize: green
            const QStringList &values       = valueGroups.at(i);                                                                                                                                         // Colorize: green
            const QStringList &descriptions = descriptionGroups.at(i);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            for (qint64 j = 0; j < fields.size(); ++j)                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                cpuidLines.append(QString("    %1 = %2%3%4 // %5")                                                                                                                                       // Colorize: green
                                            .arg(fields.at(j), -19, QChar(' '))                                                                                                                          // Colorize: green
                                            .arg(values.at(j))                                                                                                                                           // Colorize: green
                                            .arg((i != groups.size() - 1 || j < fields.size() - 1) ? "," : " ")                                                                                          // Colorize: green
                                            .arg("", 53 - values.at(j).length(), QChar(' '))                                                                                                             // Colorize: green
                                            .arg(descriptions.at(j))                                                                                                                                     // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qDebug() << cpuidLines.join('\n').toUtf8().data();                                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + X86_FEATURE_H))                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check X86 Features with specification");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
IntelCpuidSpecVerifier intelCpuidSpecVerifier;                                                                                                                                                               // Colorize: green
