#include "intelcpuidspecverifier.h"                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define INTEL_SPECIFICATION_URL "https://cdrdv2.intel.com/v1/dl/getContent/671199" // Version: April 2022                                                                                                           // Colorize: green
#define INTEL_PDF               "intelcpuid.pdf"                                                                                                                                                             // Colorize: green
#define INTEL_TXT               "intelcpuid.txt"                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define INTEL_CPUID00000000EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000000eax.h"                                                                                        // Colorize: green
#define INTEL_CPUID_VENDOR_H         "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuidvendor.h"                                                                                        // Colorize: green
#define INTEL_CPUID00000001EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000001eax.h"                                                                                        // Colorize: green
#define INTEL_CPUID_PROCESSOR_TYPE_H "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/lib/cpuidprocessortype.h"                                                                                        // Colorize: green
#define INTEL_CPUID00000001EBX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000001ebx.h"                                                                                        // Colorize: green
#define INTEL_CPUID00000004EAX_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid00000004eax.h"                                                                                        // Colorize: green
#define INTEL_CPUID_CACHE_TYPE_H     "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/lib/cpuidcachetype.h"                                                                                        // Colorize: green
#define INTEL_CPUID0000000BEBX0_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000bebx0.h"                                                                                        // Colorize: green
#define INTEL_CPUID0000000BEBX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000bebx1.h"                                                                                        // Colorize: green
#define INTEL_CPUID0000000FEBX0_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000febx0.h"                                                                                        // Colorize: green
#define INTEL_CPUID0000000FEBX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000febx1.h"                                                                                        // Colorize: green
#define INTEL_CPUID0000000FECX1_H    "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid0000000fecx1.h"                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
IntelCpuidSpecVerifier::IntelCpuidSpecVerifier()                                                                                                                                                             // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mHexRegExp(".* ([0-9a-fA-F]+)h .*")                                                                                                                                                                // Colorize: green
    , mBitDefinitionRegExp("Bit(?:s)? +(\\d+(?: *- *\\d+)?):(.*)")                                                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // Nothing                                                                                                                                                                                           // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, INTEL_SPECIFICATION_URL, specContent))                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                            // Colorize: green
        specContent.replace(QChar(0x00AE), "(R)");  // Replace registered sign character    // https://www.compart.com/en/unicode/U+00AE                                                                 // Colorize: green
        specContent.replace(QChar(0x2014), '-');    // Replace em dash                      // https://www.compart.com/en/unicode/U+2014                                                                 // Colorize: green
        specContent.replace(QChar(0x2018), '\'');   // Replace left single quotation mark   // https://www.compart.com/en/unicode/U+2018                                                                 // Colorize: green
        specContent.replace(QChar(0x2019), '\'');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+2019                                                                 // Colorize: green
        specContent.replace(QChar(0x201C), '\"');   // Replace left double quotation mark   // https://www.compart.com/en/unicode/U+201C                                                                 // Colorize: green
        specContent.replace(QChar(0x201D), '\"');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+201D                                                                 // Colorize: green
        specContent.replace(QChar(0x2022), '*');    // Replace bullet                       // https://www.compart.com/en/unicode/U+2022                                                                 // Colorize: green
        specContent.replace(QChar(0x2122), "(TM)"); // Replace trade mark sign character    // https://www.compart.com/en/unicode/U+2122                                                                 // Colorize: green
        specContent.replace(QChar(0x2260), "!=");   // Replace not equal sign character     // https://www.compart.com/en/unicode/U+2160                                                                 // Colorize: green
    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool IntelCpuidSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for INTEL CPUID specification");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get INTEL CPUID specification from: %1")                                                                                                               // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + INTEL_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for INTEL CPUID specification");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << INTEL_PDF << INTEL_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + INTEL_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open INTEL CPUID specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkIntelSpecification(thread, specContent);                                                                                                                                                    // Colorize: green
        checkCpuid00000000Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidVendor(thread, specContent);                                                                                                                                                           // Colorize: green
        checkCpuid00000001Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidProcessorType(thread, specContent);                                                                                                                                                    // Colorize: green
        checkCpuid00000001Ebx(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuid00000004Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidCacheType(thread, specContent);                                                                                                                                                        // Colorize: green
        checkCpuid0000000bEbx0(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000bEbx1(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEbx0(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEbx1(thread, specContent);                                                                                                                                                     // Colorize: green
        checkCpuid0000000fEcx1(thread, specContent);                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with INTEL CPUID specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with INTEL CPUID specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkIntelSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "Intel(R) 64 and IA-32 Architectures\n"                                                                                                                                                        // Colorize: green
            "Software Developer's Manual\n"                                                                                                                                                              // Colorize: green
            "Volume 2A:\n"                                                                                                                                                                               // Colorize: green
            "Instruction Set Reference, A-L\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE: The Intel(R) 64 and IA-32 Architectures Software Developer's Manual consists of ten volumes:\n"                                                                                         // Colorize: green
            "Basic Architecture, Order Number 253665; Instruction Set Reference A-L, Order Number 253666;\n"                                                                                             // Colorize: green
            "Instruction Set Reference M-U, Order Number 253667; Instruction Set Reference V-Z, Order Number\n"                                                                                          // Colorize: green
            "326018; Instruction Set Reference, Order Number 334569; System Programming Guide, Part 1, Order\n"                                                                                          // Colorize: green
            "Number 253668; System Programming Guide, Part 2, Order Number 253669; System Programming\n"                                                                                                 // Colorize: green
            "Guide, Part 3, Order Number 326019; System Programming Guide, Part 4, Order Number 332831;\n"                                                                                               // Colorize: green
            "Model-Specific Registers, Order Number 335592. Refer to all ten volumes when evaluating your design\n"                                                                                      // Colorize: green
            "needs.\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Order Number: 253666-077US\n"                                                                                                                                                               // Colorize: green
            "April 2022";                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("INTEL CPUID specification version didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000000Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum Input Value for Basic CPUID Information.";                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 0: Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String\n"                                                                        // Colorize: green
            "When CPUID executes with EAX set to 0, the processor returns the highest value the CPUID recognizes for\n"                                                                                  // Colorize: green
            "returning basic processor information. The value is returned in the EAX register and is processor specific.";                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000000 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000000Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            CpuidLeaf largestFunction;");                                                                                                                                     // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID00000000EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000000 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidVendor(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
    QString cpuidText3;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1, cpuidText2 and cpuidText3                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                      // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"Genu\"\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ECX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"ntel\"\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EDX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "\"ineI\"";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 0: Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String\n"                                                                        // Colorize: green
            "When CPUID executes with EAX set to 0, the processor returns the highest value the CPUID recognizes for\n"                                                                                  // Colorize: green
            "returning basic processor information. The value is returned in the EAX register and is processor specific.";                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText3 =                                                                                                                                                                                      // Colorize: green
            "A vendor identification string is also returned in EBX, EDX, and ECX. For Intel processors, the string is \"GenuineIntel\" and is expressed:\n"                                               // Colorize: green
            "EBX := 756e6547h (* \"Genu\", with G in the low eight bits of BL *)\n"                                                                                                                        // Colorize: green
            "EDX := 49656e69h (* \"ineI\", with i in the low eight bits of DL *)\n"                                                                                                                        // Colorize: green
            "ECX := 6c65746eh (* \"ntel\", with n in the low eight bits of CL *)";                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Vendor specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct CpuidVendor");                                                                                                                                                         // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline bool isIntel() const");                                                                                                                                            // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                   // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return uints[0] == VENDOR_INTEL_1");                                                                                                                                  // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[1] == VENDOR_INTEL_2");                                                                                                                                 // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[2] == VENDOR_INTEL_3;");                                                                                                                                // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    inline bool isAMD() const");                                                                                                                                              // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                   // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return uints[0] == VENDOR_AMD_1");                                                                                                                                    // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[1] == VENDOR_AMD_2");                                                                                                                                   // Colorize: green
        cpuidLines.append("                &&");                                                                                                                                                         // Colorize: green
        cpuidLines.append("                uints[2] == VENDOR_AMD_3;");                                                                                                                                  // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 uints[3];");                                                                                                                                             // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_Char8 chars[12];");                                                                                                                                              // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + INTEL_CPUID_VENDOR_H);                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(cpuidLines, fileLines))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Vendor with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList vendorHexes;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get vendor hexes                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QStringList lines = cpuidText3.split('\n');                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < lines.size(); ++i)                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QRegularExpressionMatch match = mHexRegExp.match(lines.at(i));                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                vendorHexes.append(match.captured(1));                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList vendorLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        vendorLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < vendorHexes.size(); ++i)                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString     hex   = vendorHexes.at(i).toUpper();                                                                                                                                             // Colorize: green
            quint32     uint  = hex.toULongLong(nullptr, 16);                                                                                                                                            // Colorize: green
            good_Char8 *chars = reinterpret_cast<good_Char8 *>(&uint);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            vendorLines.append(QString("#define VENDOR_INTEL_%1 0x%2   // %3%4%5%6")                                                                                                                     // Colorize: green
                                        .arg(i + 1)                                                                                                                                                      // Colorize: green
                                        .arg(hex, 8, QChar('0'))                                                                                                                                         // Colorize: green
                                        .arg(chars[0])                                                                                                                                                   // Colorize: green
                                        .arg(chars[1])                                                                                                                                                   // Colorize: green
                                        .arg(chars[2])                                                                                                                                                   // Colorize: green
                                        .arg(chars[3])                                                                                                                                                   // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        vendorLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(vendorLines, fileLines))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Intel Vendor with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000001Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
    QString cpuidText3;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1, cpuidText2 and cpuidText3                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version Information: Type, Family, Model, and Stepping ID (see Figure 3-6).";                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                      // Colorize: green
            "INPUT EAX = 01H: Returns Model, Family, Stepping Information\n"                                                                                                                             // Colorize: green
            "When CPUID executes with EAX set to 01H, version information is returned in EAX (see Figure 3-6). For example:\n"                                                                           // Colorize: green
            "model, family, and processor type for the Intel Xeon processor 5100 series is as follows:\n"                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Model - 1111B\n"                                                                                                                                                                            // Colorize: green
            "Family - 0101B\n"                                                                                                                                                                           // Colorize: green
            "Processor Type - 00B\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "See Table 3-9 for available processor type values. Stepping IDs are provided as needed.\n"                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "28 27\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "20 19\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended\n"                                                                                                                                                                                 // Colorize: green
            "Family ID\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16 15 14 13 12 11\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended\n"                                                                                                                                                                                 // Colorize: green
            "Model ID\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8 7\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Family\n"                                                                                                                                                                                   // Colorize: green
            "ID\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Model\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Stepping\n"                                                                                                                                                                                 // Colorize: green
            "ID\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended Family ID (0)\n"                                                                                                                                                                   // Colorize: green
            "Extended Model ID (0)\n"                                                                                                                                                                    // Colorize: green
            "Processor Type\n"                                                                                                                                                                           // Colorize: green
            "Family (0FH for the Pentium 4 Processor Family)\n"                                                                                                                                          // Colorize: green
            "Model\n"                                                                                                                                                                                    // Colorize: green
            "Reserved\n"                                                                                                                                                                                 // Colorize: green
            "OM16525\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Figure 3-6. Version Information Returned by CPUID in EAX\n"                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification";                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText3 =                                                                                                                                                                                      // Colorize: green
            "Table 3-9. Processor Type Field\n"                                                                                                                                                          // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Encoding\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Original OEM Processor\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "(R)\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel OverDrive Processor\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Dual processor (not applicable to Intel486 processors)\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "See Chapter 20 in the Intel(R) 64 and IA-32 Architectures Software Developer's Manual, Volume 1,\n"                                                                                           // Colorize: green
            "for information on identifying earlier IA-32 processors.\n"                                                                                                                                 // Colorize: green
            "The Extended Family ID needs to be examined only when the Family ID is 0FH. Integrate the fields into a display\n"                                                                          // Colorize: green
            "using the following rule:\n"                                                                                                                                                                // Colorize: green
            "IF Family_ID != 0FH\n"                                                                                                                                                                       // Colorize: green
            "THEN DisplayFamily = Family_ID;\n"                                                                                                                                                          // Colorize: green
            "ELSE DisplayFamily = Extended_Family_ID + Family_ID;\n"                                                                                                                                     // Colorize: green
            "(* Right justify and zero-extend 4-bit field. *)\n"                                                                                                                                         // Colorize: green
            "FI;\n"                                                                                                                                                                                      // Colorize: green
            "(* Show DisplayFamily as HEX field. *)\n"                                                                                                                                                   // Colorize: green
            "The Extended Model ID needs to be examined only when the Family ID is 06H or 0FH. Integrate the field into a\n"                                                                             // Colorize: green
            "display using the following rule:\n"                                                                                                                                                        // Colorize: green
            "IF (Family_ID = 06H or Family_ID = 0FH)\n"                                                                                                                                                  // Colorize: green
            "THEN DisplayModel = (Extended_Model_ID « 4) + Model_ID;\n"                                                                                                                                  // Colorize: green
            "(* Right justify and zero-extend 4-bit field; display Model_ID as HEX field.*)\n"                                                                                                           // Colorize: green
            "ELSE DisplayModel = Model_ID;\n"                                                                                                                                                            // Colorize: green
            "FI;\n"                                                                                                                                                                                      // Colorize: green
            "(* Show DisplayModel as HEX field. *)";                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000001 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000001Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline good_U16 familyReal() const");                                                                                                                                     // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        if (family == 15)");                                                                                                                                                  // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            return family + extendedFamily;");                                                                                                                                // Colorize: green
        cpuidLines.append("        }");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return family;");                                                                                                                                                     // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    inline good_U8 modelReal() const");                                                                                                                                       // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        if (family >= 6)");                                                                                                                                                   // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            return model + (extendedModel << 4);");                                                                                                                           // Colorize: green
        cpuidLines.append("        }");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return model;");                                                                                                                                                      // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32           stepping:       4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           model:          4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           family:         4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            CpuidProcessorType processorType:  2;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           _reserved:      2;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           extendedModel:  4;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           extendedFamily: 8;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32           _reserved2:     4;");                                                                                                                          // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID00000001EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000001 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidProcessorType(SpecVerifyThread *thread, const QString &specContent)                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                      // Colorize: green
            "Table 3-9. Processor Type Field\n"                                                                                                                                                          // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Encoding\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Original OEM Processor\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "(R)\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel OverDrive Processor\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Dual processor (not applicable to Intel486 processors)\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10B\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Intel reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11B";                                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Processor Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidProcessorType: good_U8");                                                                                                                                     // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    ORIGINAL_EQUIPMENT_MANUFACTURER_PROCESSOR = 0,");                                                                                                                         // Colorize: green
        cpuidLines.append("    INTEL_OVERDRIVE_PROCESSOR                 = 1,");                                                                                                                         // Colorize: green
        cpuidLines.append("    DUAL_PROCESSOR                            = 2");                                                                                                                          // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID_PROCESSOR_TYPE_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Processor Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000001Ebx(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 07 - 00: Brand Index.\n"                                                                                                                                                               // Colorize: green
            "Bits 15 - 08: CLFLUSH line size (Value ∗ 8 = cache line size in bytes; used also by CLFLUSHOPT).\n"                                                                                         // Colorize: green
            "Bits 23 - 16: Maximum number of addressable IDs for logical processors in this physical package*.\n"                                                                                        // Colorize: green
            "Bits 31 - 24: Initial APIC ID**.";                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "INPUT EAX = 01H: Returns Additional Information in EBX\n"                                                                                                                                   // Colorize: green
            "When CPUID executes with EAX set to 01H, additional information is returned to the EBX register:\n"                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Brand index (low byte of EBX) - this number provides an entry into a brand string table that contains brand\n"                                                                              // Colorize: green
            "strings for IA-32 processors. More information about this field is provided later in this section.\n"                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CLFLUSH instruction cache line size (second byte of EBX) - this number indicates the size of the cache line\n"                                                                              // Colorize: green
            "flushed by the CLFLUSH and CLFLUSHOPT instructions in 8-byte increments. This field was introduced in the\n"                                                                                // Colorize: green
            "Pentium 4 processor.\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Local APIC ID (high byte of EBX) - this number is the 8-bit ID that is assigned to the local APIC on the\n"                                                                                 // Colorize: green
            "processor during power up. This field was introduced in the Pentium 4 processor.";                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000001 EBX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000001Ebx");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline good_U16 cacheLineFlushSizeReal() const");                                                                                                                         // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return cacheLineFlushSize * 8;");                                                                                                                                     // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 brandIndex:                8; // This number provides an entry into a brand string table that contains brand strings for IA-32 processors");             // Colorize: green
        cpuidLines.append("            good_U32 cacheLineFlushSize:        8; // This number indicates the size of the cache line flushed by the CLFLUSH and CLFLUSHOPT instructions in 8-byte increments"); // Colorize: green
        cpuidLines.append("            good_U32 numberOfApicIdsPerPackage: 8; // Maximum number of addressable IDs for logical processors in this physical package");                                    // Colorize: green
        cpuidLines.append("            good_U32 localApicId:               8; // This number is the 8-bit ID that is assigned to the local APIC on the processor during power up");                      // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID00000001EBX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000001 EBX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid00000004Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 04 - 00: Cache Type Field.\n"                                                                                                                                                          // Colorize: green
            "0 = Null - No more caches.\n"                                                                                                                                                               // Colorize: green
            "1 = Data Cache.\n"                                                                                                                                                                          // Colorize: green
            "2 = Instruction Cache.\n"                                                                                                                                                                   // Colorize: green
            "3 = Unified Cache.\n"                                                                                                                                                                       // Colorize: green
            "4-31 = Reserved.";                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "Table 3-8. Information Returned by CPUID Instruction (Contd.)\n"                                                                                                                            // Colorize: green
            "Initial EAX\n"                                                                                                                                                                              // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Information Provided about the Processor\n"                                                                                                                                                 // Colorize: green
            "Bits 07 - 05: Cache Level (starts at 1).\n"                                                                                                                                                 // Colorize: green
            "Bit 08: Self Initializing cache level (does not need SW initialization).\n"                                                                                                                 // Colorize: green
            "Bit 09: Fully Associative cache.\n"                                                                                                                                                         // Colorize: green
            "Bits 13 - 10: Reserved.\n"                                                                                                                                                                  // Colorize: green
            "Bits 25 - 14: Maximum number of addressable IDs for logical processors sharing this cache**, ***.\n"                                                                                        // Colorize: green
            "Bits 31 - 26: Maximum number of addressable IDs for processor cores in the physical\n"                                                                                                      // Colorize: green
            "package**, ****, *****.";                                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 00000004 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(2) != "CPUID-CPU Identification" || lines.at(3) != "")                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 00000004 EAX specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 4;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (line == "Bits 04 - 00: Cache Type Field.")                                                                                                                                            // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    i += 11;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    continue;                                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Cache Type Field.",                                                              "cacheType");                                                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Cache Level (starts at 1).",                                                     "cacheLevel");                                                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Self Initializing cache level (does not need SW initialization).",               "selfInitializingCacheLevel");                                          // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Fully Associative cache.",                                                       "fullyAssociativeCache");                                               // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                      "_reserved");                                                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum number of addressable IDs for logical processors sharing this cache.",   "maximumNumberOfThreads");                                              // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum number of addressable IDs for processor cores in the physical package.", "maximumNumberOfCores");                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid00000004Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32       %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 26 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.replaceInStrings("            good_U32       cacheType:",  "            CpuidCacheType cacheType:");                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID00000004EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 00000004 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuidCacheType(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EAX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "CPUID-CPU Identification\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 04 - 00: Cache Type Field.\n"                                                                                                                                                          // Colorize: green
            "0 = Null - No more caches.\n"                                                                                                                                                               // Colorize: green
            "1 = Data Cache.\n"                                                                                                                                                                          // Colorize: green
            "2 = Instruction Cache.\n"                                                                                                                                                                   // Colorize: green
            "3 = Unified Cache.\n"                                                                                                                                                                       // Colorize: green
            "4-31 = Reserved.";                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Cache Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(2) != "CPUID-CPU Identification"                                                                                                                                                    // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(3) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(4) != "Bits 04 - 00: Cache Type Field."                                                                                                                                             // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID Cache Type specification");                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 5;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            qint64 index = line.indexOf('=');                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (index >= 0)                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString value       = line.left(index).trimmed();                                                                                                                                        // Colorize: green
                QString description = line.mid(index + 1).trimmed();                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (description != "Reserved.")                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString field = description;                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    field = field.remove("Null - ").remove('.').replace(' ', '_').toUpper();                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    fields.append(field);                                                                                                                                                                // Colorize: green
                    values.append(value);                                                                                                                                                                // Colorize: green
                    descriptions.append(description);                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidCacheType: good_U8");                                                                                                                                         // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            cpuidLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                             // Colorize: green
                                        .arg(fields.at(i), -17, QChar(' '))                                                                                                                              // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                          // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                         // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID_CACHE_TYPE_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Cache Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000bEbx0(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 15 - 00: Number of logical processors at this level type. The number reflects configuration as shipped\n"                                                                              // Colorize: green
            "by Intel**.\n"                                                                                                                                                                              // Colorize: green
            "Bits 31- 16: Reserved.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000B EBX/0 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000B EBX/0 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Number of logical processors at this level type. The number reflects configuration as shipped by Intel.",  "numberOfThreadsPerCore");                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                                                "_reserved");                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000BEbx0");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 22 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID0000000BEBX0_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000B EBX/0 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000bEbx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 15 - 00: Number of logical processors at this level type. The number reflects configuration as shipped\n"                                                                              // Colorize: green
            "by Intel**.\n"                                                                                                                                                                              // Colorize: green
            "Bits 31- 16: Reserved.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000B EBX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000B EBX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString bit   = match.captured(1);                                                                                                                                                       // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &bit   = bits[i];                                                                                                                                                                    // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Update bit                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index = bit.indexOf('-');                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    qint64 from = bit.mid(index + 1).trimmed().toLongLong();                                                                                                                             // Colorize: green
                    qint64 to   = bit.left(index).trimmed().toLongLong();                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    bit = QString::number(to - from + 1);                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                else                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    bit = "1";                                                                                                                                                                           // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Number of logical processors at this level type. The number reflects configuration as shipped by Intel.",  "numberOfThreads");                           // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Reserved.",                                                                                                "_reserved");                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000BEbx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1:%2 %3;%4 // %5")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg("", 15 - field.length(), QChar(' '))                                                                                                                        // Colorize: green
                                        .arg(bits.at(i))                                                                                                                                                 // Colorize: green
                                        .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID0000000BEBX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000B EBX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEbx0(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 31 - 00: Maximum range (zero-based) of RMID within this physical processor of all types.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F EBX/0 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F EBX/0 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum range (zero-based) of RMID within this physical processor of all types.", "cacheMaxRmid");                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEbx0");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID0000000FEBX0_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F EBX/0 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEbx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "EBX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 31 - 00: Conversion factor from reported IA32_QM_CTR value to occupancy metric (bytes) and Memory Bandwidth Monitoring (MBM) metrics.";                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F EBX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "EBX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F EBX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QRegularExpressionMatch match = mBitDefinitionRegExp.match(line);                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (match.hasMatch())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString field = match.captured(2);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                fields.append(field);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                fields[fields.size() - 1].append(' ' + line);                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Conversion factor from reported IA32_QM_CTR value to occupancy metric (bytes) and Memory Bandwidth Monitoring (MBM) metrics.", "cacheOccScale");         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEbx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID0000000FEBX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F EBX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void IntelCpuidSpecVerifier::checkCpuid0000000fEcx1(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "ECX\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum range (zero-based) of RMID of this resource type.";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 0000000F ECX/1 specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(0) != "ECX" || lines.at(1) != "")                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID 0000000F ECX/1 specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(line);                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update fields                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString &field = fields[i];                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            field = field.remove(',').remove('*').simplified().replace(" .", ".");                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> cpuidFieldNamesToNgosFieldNames; // CPUID field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidFieldNamesToNgosFieldNames.insert("Maximum range (zero-based) of RMID of this resource type.",  "cacheMaxRmid");                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid0000000FEcx1");                                                                                                                                                   // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = cpuidFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            cpuidLines.append(QString("            good_U32 %1; // %2")                                                                                                                    // Colorize: green
                                        .arg(field)                                                                                                                                                      // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with IntelCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(INTEL_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + INTEL_CPUID0000000FECX1_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 0000000F ECX/1 with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
IntelCpuidSpecVerifier intelCpuidSpecVerifier;                                                                                                                                                               // Colorize: green
