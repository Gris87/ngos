#include "dmispecverifier.h"                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define DMI_SPECIFICATION_URL "https://www.dmtf.org/sites/default/files/standards/documents/DSP0134_3.4.0.pdf" // Version: 3.4.0 / 2020-07-17                                                            // Colorize: green
#define DMI_PDF               "dmi.pdf"                                                                                                                                                                  // Colorize: green
#define DMI_TXT               "dmi.txt"                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define DMI_ENTRY_HEADER_H "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/dmientryheader.h"                                                                                                    // Colorize: green
#define DMI_STRING_ID_H    "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/dmistringid.h"                                                                                                    // Colorize: green
#define DMI_BIOS_ENTRY_H   "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/dmibiosentry.h"                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DmiSpecVerifier::DmiSpecVerifier()                                                                                                                                                                       // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mDmiTypeToNgosTypeMap()                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    mDmiTypeToNgosTypeMap.insert("BYTE",  "good_U8");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("WORD",  "good_U16");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("DWORD", "good_U32");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("QWORD", "good_U64");                                                                                                                                                // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, DMI_SPECIFICATION_URL, specContent))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        specContent.replace(QChar(0x2018), '\''); // Replace left single quotation mark  // https://www.compart.com/en/unicode/U+2018                                                                    // Colorize: green
        specContent.replace(QChar(0x2019), '\''); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+2019                                                                    // Colorize: green
        specContent.replace(QChar(0x201C), '\"'); // Replace left double quotation mark  // https://www.compart.com/en/unicode/U+201C                                                                    // Colorize: green
        specContent.replace(QChar(0x201D), '\"'); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+201D                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool DmiSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for DMI specification");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    tempDir.setAutoRemove(false);                                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get DMI specification from: %1")                                                                                                                     // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + DMI_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for DMI specification");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << DMI_PDF << DMI_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + DMI_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open DMI specification");                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkDmiSpecification(thread, specContent);                                                                                                                                                      // Colorize: green
        checkDmiEntryHeader(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiStringId(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosEntry(thread, specContent);                                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with DMI specification");                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with DMI specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Identifier: DSP0134\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Date: 2020-07-17\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version: 3.4.0\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System Management BIOS (SMBIOS) Reference\n"                                                                                                                                                // Colorize: green
            "Specification\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Supersedes: 3.3.0\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Class: Normative\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Status: Published\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "11\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Language: en-US";                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI specification version didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiEntryHeader(SpecVerifyThread *thread, const QString &specContent)                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString headerText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init headerText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerText =                                                                                                                                                                                     // Colorize: green
            "901\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6.1.2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "902\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Each SMBIOS structure begins with a four-byte header as shown in Table 3.\n"                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Structure header format\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 3  Structure header format description\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "903\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the type of structure. Types 0 through 127 (7Fh) are reserved for and\n"                                                                                                          // Colorize: green
            "defined by this specification. Types 128 through 256 (80h to FFh) are available for\n"                                                                                                      // Colorize: green
            "system- and OEM-specific information.\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the length of the formatted area of the structure, starting at the Type field.\n"                                                                                                 // Colorize: green
            "The length of the structure's string-set is not included.\n"                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the structure's handle, a unique 16-bit number in the range 0 to 0FFFEh\n"                                                                                                        // Colorize: green
            "(for version 2.0) or 0 to 0FEFFh (for version 2.1 and later). The handle can be used\n"                                                                                                     // Colorize: green
            "with the Get SMBIOS Structure function to retrieve a specific structure; the handle\n"                                                                                                      // Colorize: green
            "numbers are not required to be contiguous. For version 2.1 and later, handle\n"                                                                                                             // Colorize: green
            "values in the range 0FF00h to 0FFFFh are reserved for use by this specification. [1]\n"                                                                                                     // Colorize: green
            "If the system configuration changes, a previously assigned handle might no longer\n"                                                                                                        // Colorize: green
            "exist. However, after a handle has been assigned by the BIOS, the BIOS cannot\n"                                                                                                            // Colorize: green
            "re-assign that handle number to another structure.\n"                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "[1]\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The UEFI Platform Initialization Specification reserves handle number FFFEh for its EFI_SMBIOS_PROTOCOL.Add() function\n"                                                                   // Colorize: green
            "to mean \"assign an unused handle number automatically.\" This number is not used for any other purpose by the SMBIOS\n"                                                                      // Colorize: green
            "specification.";                                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(headerText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI header specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = headerText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(10) != "Table 3  Structure header format description"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(11) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(12) != "903"                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(13) != "Offset"                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(14) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(15) != "Name"                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(16) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(17) != "Length"                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(18) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(19) != "Description"                                                                                                                                                                // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(20) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 21;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldDescriptions;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (offset == "[1]")                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(name);                                                                                                                                                                     // Colorize: green
            fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
            fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i >= lines.size())                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Type",   "type");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Length", "length");                                                                                                                                     // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Handle", "handle");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList headerLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        headerLines.append("struct DmiEntryHeader");                                                                                                                                                          // Colorize: green
        headerLines.append("{");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldNames.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(i), fieldTypes.at(i));                                                                                                                            // Colorize: green
            QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(i), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldNames.at(i))                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            headerLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                        .arg(type, -12, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(name)                                                                                                                                                       // Colorize: green
                                        .arg("", 6 - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                        .arg(fieldDescriptions.at(i))                                                                                                                                    // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        headerLines.append("} __attribute__((packed));");                                                                                                                                                                        // Colorize: green
        headerLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.replaceInStrings("    good_U8      type;", "    DmiEntryType type;");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(headerLines, thread->getPath() + "/" + DMI_ENTRY_HEADER_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI header with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiStringId(SpecVerifyThread *thread, const QString &specContent)                                                                                                             // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString stringIdText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init stringIdText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        stringIdText =                                                                                                                                                                                     // Colorize: green
            "904\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6.1.3\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Text strings\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "905\n"                                                                                                                                                                                      // Colorize: green
            "906\n"                                                                                                                                                                                      // Colorize: green
            "907\n"                                                                                                                                                                                      // Colorize: green
            "908\n"                                                                                                                                                                                      // Colorize: green
            "909\n"                                                                                                                                                                                      // Colorize: green
            "910\n"                                                                                                                                                                                      // Colorize: green
            "911\n"                                                                                                                                                                                      // Colorize: green
            "912\n"                                                                                                                                                                                      // Colorize: green
            "913\n"                                                                                                                                                                                      // Colorize: green
            "914\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Text strings associated with a given SMBIOS structure are appended directly after the formatted portion\n"                                                                                  // Colorize: green
            "of the structure. This method of returning string information eliminates the need for application software to\n"                                                                            // Colorize: green
            "deal with pointers embedded in the SMBIOS structure. Each string is terminated with a null (00h) BYTE\n"                                                                                    // Colorize: green
            "and the set of strings is terminated with an additional null (00h) BYTE. When the formatted portion of an\n"                                                                                // Colorize: green
            "SMBIOS structure references a string, it does so by specifying a non-zero string number within the\n"                                                                                       // Colorize: green
            "structure's string-set. For example, if a string field contains 02h, it references the second string following\n"                                                                           // Colorize: green
            "the formatted portion of the SMBIOS structure. If a string field references no string, a null (0) is placed in\n"                                                                           // Colorize: green
            "that string field. If the formatted portion of the structure contains string-reference fields and all the string\n"                                                                         // Colorize: green
            "fields are set to 0 (no string references), the formatted section of the structure is followed by two null\n"                                                                               // Colorize: green
            "(00h) BYTES. See 6.1.1 for a string-containing example.\n"                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "915\n"                                                                                                                                                                                      // Colorize: green
            "916\n"                                                                                                                                                                                      // Colorize: green
            "917\n"                                                                                                                                                                                      // Colorize: green
            "918\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "There is no limit on the length of each individual text string. However, the length of the entire structure table\n"                                                                        // Colorize: green
            "(including all strings) must be reported in the Structure Table Length field of the 32-bit Structure Table Entry\n"                                                                         // Colorize: green
            "Point (see 5.2.1) and/or the Structure Table Maximum Size field of the 64-bit Structure Table Entry Point\n"                                                                                // Colorize: green
            "(see 5.2.2).";                                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(stringIdText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI String ID specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList stringIdLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        stringIdLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        stringIdLines.append("struct DmiStringId");                                                                                                                                                      // Colorize: green
        stringIdLines.append("{");                                                                                                                                                                       // Colorize: green
        stringIdLines.append("    DmiStringId()");                                                                                                                                                       // Colorize: green
        stringIdLines.append("        : id(0)");                                                                                                                                                         // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                     // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline DmiStringId& operator=(const DmiStringId &another)");                                                                                                           // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"another = ...\")); // Commented to avoid too frequent logs");                                                                                      // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        id = another.id;");                                                                                                                                                // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return *this;");                                                                                                                                                   // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline DmiStringId& operator++()");                                                                                                                                    // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        ++id;");                                                                                                                                                           // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return *this;");                                                                                                                                                   // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline bool operator==(const DmiStringId &another) const");                                                                                                            // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"another = ...\")); // Commented to avoid too frequent logs");                                                                                      // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return id == another.id;");                                                                                                                                        // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    good_U8 id;");                                                                                                                                                         // Colorize: green
        stringIdLines.append("} __attribute__((packed));");                                                                                                                                              // Colorize: green
        stringIdLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(stringIdLines, thread->getPath() + "/" + DMI_STRING_ID_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI String ID with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString entryText1;                                                                                                                                                                                  // Colorize: green
    QString entryText2;                                                                                                                                                                                  // Colorize: green
    QString entryText3;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init entryText1, entryText2 and entryText3                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryText1 =                                                                                                                                                                                     // Colorize: green
            "936\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.1\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "937\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 6 shows the BIOS Information structure.\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Information (Type 0)\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 6  BIOS Information (Type 0) structure\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "938\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Information indicator\n"                                                                                                                                                               // Colorize: green
            "";                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText2 =                                                                                                                                                                                     // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12h + number of BIOS Characteristics\n"                                                                                                                                                     // Colorize: green
            "Extension Bytes. If no Extension Bytes are\n"                                                                                                                                               // Colorize: green
            "used the Length is 12h. For version 2.1 and\n"                                                                                                                                              // Colorize: green
            "2.2 implementations, the length is 13h\n"                                                                                                                                                   // Colorize: green
            "because one extension byte is defined. For\n"                                                                                                                                               // Colorize: green
            "version 2.3 and later implementations, the\n"                                                                                                                                               // Colorize: green
            "length is at least 14h because two extension\n"                                                                                                                                             // Colorize: green
            "bytes are defined. For version 2.4 to 3.0,\n"                                                                                                                                               // Colorize: green
            "implementations, the length is at least 18h\n"                                                                                                                                              // Colorize: green
            "because bytes 14-17h are defined. For\n"                                                                                                                                                    // Colorize: green
            "version 3.1 and later implementations, the\n"                                                                                                                                               // Colorize: green
            "length is at least 1Ah because bytes 14-19h\n"                                                                                                                                              // Colorize: green
            "are defined.\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Vendor\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS Vendor's Name.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Version\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS Version. This\n"                                                                                                                                                  // Colorize: green
            "value is a free-form string that may contain\n"                                                                                                                                             // Colorize: green
            "Core and OEM version information.\n"                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Starting\n"                                                                                                                                                                            // Colorize: green
            "Address Segment\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Segment location of BIOS starting address\n"                                                                                                                                                // Colorize: green
            "(for example, 0E800h).\n"                                                                                                                                                                   // Colorize: green
            "NOTE: The size of the runtime BIOS image can\n"                                                                                                                                             // Colorize: green
            "be computed by subtracting the Starting\n"                                                                                                                                                  // Colorize: green
            "Address Segment from 10000h and\n"                                                                                                                                                          // Colorize: green
            "multiplying the result by 16.\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Release\n"                                                                                                                                                                             // Colorize: green
            "Date\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS release date.\n"                                                                                                                                                  // Colorize: green
            "The date string, if supplied, is in either\n"                                                                                                                                               // Colorize: green
            "mm/dd/yy or mm/dd/yyyy format. If the year\n"                                                                                                                                               // Colorize: green
            "portion of the string is two digits, the year is\n"                                                                                                                                         // Colorize: green
            "assumed to be 19yy.\n"                                                                                                                                                                      // Colorize: green
            "NOTE: The mm/dd/yyyy format is required for\n"                                                                                                                                              // Colorize: green
            "SMBIOS version 2.3 and later.\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "09h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS ROM Size\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies (n)\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size (n) where 64K * (n+1) is the size of the\n"                                                                                                                                            // Colorize: green
            "physical device containing the BIOS, in\n"                                                                                                                                                  // Colorize: green
            "bytes.\n"                                                                                                                                                                                   // Colorize: green
            "FFh - size is 16MB or greater, see Extended\n"                                                                                                                                              // Colorize: green
            "BIOS ROM Size for actual size\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Ah\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS\n"                                                                                                                                                                                     // Colorize: green
            "Characteristics\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "QWORD\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Defines which functions the BIOS supports:\n"                                                                                                                                               // Colorize: green
            "PCI, PCMCIA, Flash, etc. (see 7.1.1).\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS\n"                                                                                                                                                                                     // Colorize: green
            "Characteristics\n"                                                                                                                                                                          // Colorize: green
            "Extension Bytes\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Zero or more\n"                                                                                                                                                                             // Colorize: green
            "BYTEs\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Optional space reserved for future\n"                                                                                                                                                       // Colorize: green
            "supported functions. The number of\n"                                                                                                                                                       // Colorize: green
            "Extension Bytes that is present is indicated\n"                                                                                                                                             // Colorize: green
            "by the Length in offset 1 minus 12h. See\n"                                                                                                                                                 // Colorize: green
            "7.1.2 for extensions defined for version 2.1\n"                                                                                                                                             // Colorize: green
            "and later implementations. For version 2.4\n"                                                                                                                                               // Colorize: green
            "and later implementations, two BIOS\n"                                                                                                                                                      // Colorize: green
            "Characteristics Extension Bytes are defined\n"                                                                                                                                              // Colorize: green
            "(12-13h) and bytes 14-17h are also defined.\n"                                                                                                                                              // Colorize: green
            "";                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText3 =                                                                                                                                                                                     // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "14h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System BIOS\n"                                                                                                                                                                              // Colorize: green
            "Major Release\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the major release of the System\n"                                                                                                                                               // Colorize: green
            "BIOS; for example, the value is 0Ah for\n"                                                                                                                                                  // Colorize: green
            "revision 10.22 and 02h for revision 2.1.\n"                                                                                                                                                 // Colorize: green
            "This field or the System BIOS Minor\n"                                                                                                                                                      // Colorize: green
            "Release field or both are updated each time\n"                                                                                                                                              // Colorize: green
            "a System BIOS update for a given system is\n"                                                                                                                                               // Colorize: green
            "released.\n"                                                                                                                                                                                // Colorize: green
            "If the system does not support the use of\n"                                                                                                                                                // Colorize: green
            "this field, the value is 0FFh for both this field\n"                                                                                                                                        // Colorize: green
            "and the System BIOS Minor Release field.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System BIOS\n"                                                                                                                                                                              // Colorize: green
            "Minor Release\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the minor release of the System\n"                                                                                                                                               // Colorize: green
            "BIOS; for example, the value is 16h for\n"                                                                                                                                                  // Colorize: green
            "revision 10.22 and 01h for revision 2.1.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Embedded\n"                                                                                                                                                                                 // Colorize: green
            "Controller\n"                                                                                                                                                                               // Colorize: green
            "Firmware Major\n"                                                                                                                                                                           // Colorize: green
            "Release\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the major release of the\n"                                                                                                                                                      // Colorize: green
            "embedded controller firmware; for example,\n"                                                                                                                                               // Colorize: green
            "the value would be 0Ah for revision 10.22\n"                                                                                                                                                // Colorize: green
            "and 02h for revision 2.1.\n"                                                                                                                                                                // Colorize: green
            "This field or the Embedded Controller\n"                                                                                                                                                    // Colorize: green
            "Firmware Minor Release field or both are\n"                                                                                                                                                 // Colorize: green
            "updated each time an embedded controller\n"                                                                                                                                                 // Colorize: green
            "firmware update for a given system is\n"                                                                                                                                                    // Colorize: green
            "released.\n"                                                                                                                                                                                // Colorize: green
            "If the system does not have field\n"                                                                                                                                                        // Colorize: green
            "upgradeable embedded controller firmware,\n"                                                                                                                                                // Colorize: green
            "the value is 0FFh.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "17h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Embedded\n"                                                                                                                                                                                 // Colorize: green
            "Controller\n"                                                                                                                                                                               // Colorize: green
            "Firmware Minor\n"                                                                                                                                                                           // Colorize: green
            "Release\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the minor release of the\n"                                                                                                                                                      // Colorize: green
            "embedded controller firmware; for example,\n"                                                                                                                                               // Colorize: green
            "the value is 16h for revision 10.22 and 01h\n"                                                                                                                                              // Colorize: green
            "for revision 2.1.\n"                                                                                                                                                                        // Colorize: green
            "If the system does not have field\n"                                                                                                                                                        // Colorize: green
            "upgradeable embedded controller firmware,\n"                                                                                                                                                // Colorize: green
            "the value is 0FFh.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "18h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3.1+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended BIOS\n"                                                                                                                                                                            // Colorize: green
            "ROM Size\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended size of the physical device(s)\n"                                                                                                                                                  // Colorize: green
            "containing the BIOS, rounded up if needed.\n"                                                                                                                                               // Colorize: green
            "Bits 15:14\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unit\n"                                                                                                                                                                                     // Colorize: green
            "00b - megabytes\n"                                                                                                                                                                          // Colorize: green
            "01b - gigabytes\n"                                                                                                                                                                          // Colorize: green
            "10b - reserved\n"                                                                                                                                                                           // Colorize: green
            "11b - reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 13:0\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Examples: a 16 MB device would be\n"                                                                                                                                                        // Colorize: green
            "represented as 0010h. A 48 GB device set\n"                                                                                                                                                 // Colorize: green
            "would be represented as\n"                                                                                                                                                                  // Colorize: green
            "0100_0000_0011_0000b or 4030h.";                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(entryText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS entry specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (entryText1 + '\n' + entryText2 + '\n' + entryText3).split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(75) != "02h"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(76) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(77) != "2.0+"                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(78) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(79) != "Handle"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(80) != ""                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(81) != "WORD"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(82) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(83) != "Varies"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(84) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI BIOS entry specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 85;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList        versionGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> nameGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> typeGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> descriptionGroups;                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QString     lastVersion;                                                                                                                                                                      // Colorize: green
        QStringList fieldNames;                                                                                                                                                                              // Colorize: green
        QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
        QStringList fieldDescriptions;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (offset == "Offset")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 13;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                offset = lines.at(i);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString version = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                name.append(' ');                                                                                                                                                                 // Colorize: green
                name.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                type.append(' ');                                                                                                                                                                 // Colorize: green
                type.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1)                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString nextLine = lines.at(i + 1);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (nextLine == "")                                                                                                                                                                      // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString nextLine2 = i < lines.size() - 2 ? lines.at(i + 2) : "";                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2.length() == 3 && nextLine2.endsWith('h'))                                                                                                                              // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2 == "Offset")                                                                                                                                                           // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(nextLine);                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "BYTE" && value == "STRING")                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                type = "DmiStringId";                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill groups                                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                if (version != lastVersion)                                                                                                                                                                  // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    if (lastVersion != "")                                                                                                                                                                   // Colorize: green
                    {                                                                                                                                                                                        // Colorize: green
                        versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
                        nameGroups.append(fieldNames);                                                                                                                                                       // Colorize: green
                        typeGroups.append(fieldTypes);                                                                                                                                                       // Colorize: green
                        descriptionGroups.append(fieldDescriptions);                                                                                                                                         // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                        fieldNames.clear();                                                                                                                                                                  // Colorize: green
                        fieldTypes.clear();                                                                                                                                                                  // Colorize: green
                        fieldDescriptions.clear();                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    lastVersion = version;                                                                                                                                                                   // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                fieldNames.append(name);                                                                                                                                                                     // Colorize: green
                fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
                fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Add last group                                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
            nameGroups.append(fieldNames);                                                                                                                                                               // Colorize: green
            typeGroups.append(fieldTypes);                                                                                                                                                               // Colorize: green
            descriptionGroups.append(fieldDescriptions);                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update groups                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionGroups.insert(1,     "V21");                                                                                                                                                              // Colorize: green
        nameGroups.insert(1,        QStringList() << "BIOS Characteristics Extension Bytes (BIOS)");                                                                                                     // Colorize: green
        typeGroups.insert(1,        QStringList() << "Zero or more BYTEs");                                                                                                                              // Colorize: green
        descriptionGroups.insert(1, QStringList() << descriptionGroups.at(1).constFirst());                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        versionGroups.insert(2,     "V23");                                                                                                                                                              // Colorize: green
        nameGroups.insert(2,        QStringList() << "BIOS Characteristics Extension Bytes (System)");                                                                                                     // Colorize: green
        typeGroups.insert(2,        QStringList() << "Zero or more BYTEs");                                                                                                                              // Colorize: green
        descriptionGroups.insert(2, QStringList() << descriptionGroups.at(2).constFirst());                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        nameGroups[3].removeFirst();                                                                                                                                                                     // Colorize: green
        typeGroups[3].removeFirst();                                                                                                                                                                     // Colorize: green
        descriptionGroups[3].removeFirst();                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Vendor",                                        "vendor");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Version",                                  "biosVersion");                                                                                                                                     // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Starting Address Segment",                 "biosStartingAddressSegment");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Release Date",                             "biosReleaseDate");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS ROM Size",                                 "biosRomSize");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics",                          "biosCharacteristics");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics Extension Bytes (BIOS)",   "biosCharacteristicsExtensionBiosReserved");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics Extension Bytes (System)", "biosCharacteristicsExtensionSystemReserved");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("System BIOS Major Release",                     "systemBiosMajorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("System BIOS Minor Release",                     "systemBiosMinorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Embedded Controller Firmware Major Release",    "embeddedControllerFirmwareMajorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Embedded Controller Firmware Minor Release",    "embeddedControllerFirmwareMinorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Extended BIOS ROM Size",                        "extendedBiosRomSize");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    const QList<qint64> typeAlignment = { 27, 39, 41, 7,  22 };                                                                                                                                                             // Colorize: green
    const QList<qint64> nameAlignment = { 26, 40, 42, 38, 19 };                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList entryLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < versionGroups.size(); ++i)                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const QStringList &fieldNames        = nameGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldTypes        = typeGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldDescriptions = descriptionGroups.at(i);                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (i > 0)                                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            entryLines.append(QString("struct DmiBiosEntry%1")                                                                                                                                          // Colorize: green
                                        .arg(i > 0 ? (versionGroups.at(i) + ": public DmiBiosEntry" + (i > 1 ? versionGroups.at(i - 1) : "")) : "")                                                                     // Colorize: green
            );                                                                                                                                                   // Colorize: green
            entryLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            for (qint64 j = 0; j < fieldNames.size(); ++j)                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                                // Colorize: green
                QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(j), fieldTypes.at(j));                                                                                                                            // Colorize: green
                QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(j), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                if (name == "")                                                                                                                                                                              // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                                .arg(fieldNames.at(j))                                                                                                                                              // Colorize: green
                    );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    return;                                                                                                                                                                                  // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                entryLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                            .arg(type, -typeAlignment.at(i), QChar(' '))                                                                                                                                      // Colorize: green
                                            .arg(name)                                                                                                                                                       // Colorize: green
                                            .arg("", nameAlignment.at(i) - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                            .arg(fieldDescriptions.at(j))                                                                                                                                    // Colorize: green
                );                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            entryLines.append("} __attribute__((packed));");                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.insert(3, "    DmiEntryHeader              header;");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.replaceInStrings("    good_U8                     biosRomSize;",                                              "    DmiBiosRomSize              biosRomSize;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U64                    biosCharacteristics;",                                      "    DmiBiosCharacteristicsFlags biosCharacteristics;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    Zero or more BYTEs                      biosCharacteristicsExtensionBiosReserved;",     "    DmiBiosCharacteristicsBiosReservedFlags biosCharacteristicsExtensionBiosReserved;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    Zero or more BYTEs                        biosCharacteristicsExtensionSystemReserved;", "    DmiBiosCharacteristicsSystemReservedFlags biosCharacteristicsExtensionSystemReserved;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U16               extendedBiosRomSize;",                                           "    DmiBiosExtendedRomSize extendedBiosRomSize;");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + DMI_BIOS_ENTRY_H);                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(entryLines, fileLines))                                                                                                                                                                                                     // Colorize: green                                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS entry with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList constantLines;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        constantLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(DMI_SPECIFICATION_URL)                                                                                                                                      // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Constants                                                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Size (n) where 64K * (n+1) is the size of the\n"                                                                                                                                // Colorize: green
                        "physical device containing the BIOS, in\n"                                                                                                                                      // Colorize: green
                        "bytes.\n"                                                                                                                                                                       // Colorize: green
                        "FFh - size is 16MB or greater, see Extended\n"                                                                                                                                  // Colorize: green
                        "BIOS ROM Size for actual size";                                                                                                                                                 // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND                             0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE / DMI_BIOS_SYSTEM_BIOS_MINOR_RELEASE_NOT_AVAILABLE                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the major release of the System\n"                                                                                                                                   // Colorize: green
                        "BIOS; for example, the value is 0Ah for\n"                                                                                                                                      // Colorize: green
                        "revision 10.22 and 02h for revision 2.1.\n"                                                                                                                                     // Colorize: green
                        "This field or the System BIOS Minor\n"                                                                                                                                          // Colorize: green
                        "Release field or both are updated each time\n"                                                                                                                                  // Colorize: green
                        "a System BIOS update for a given system is\n"                                                                                                                                   // Colorize: green
                        "released.\n"                                                                                                                                                                    // Colorize: green
                        "If the system does not support the use of\n"                                                                                                                                    // Colorize: green
                        "this field, the value is 0FFh for both this field\n"                                                                                                                            // Colorize: green
                        "and the System BIOS Minor Release field.";                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE                  0xFF");                                                                                  // Colorize: green
                constantLines.append("#define DMI_BIOS_SYSTEM_BIOS_MINOR_RELEASE_NOT_AVAILABLE                  0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the major release of the\n"                                                                                                                                          // Colorize: green
                        "embedded controller firmware; for example,\n"                                                                                                                                   // Colorize: green
                        "the value would be 0Ah for revision 10.22\n"                                                                                                                                    // Colorize: green
                        "and 02h for revision 2.1.\n"                                                                                                                                                    // Colorize: green
                        "This field or the Embedded Controller\n"                                                                                                                                        // Colorize: green
                        "Firmware Minor Release field or both are\n"                                                                                                                                     // Colorize: green
                        "updated each time an embedded controller\n"                                                                                                                                     // Colorize: green
                        "firmware update for a given system is\n"                                                                                                                                        // Colorize: green
                        "released.\n"                                                                                                                                                                    // Colorize: green
                        "If the system does not have field\n"                                                                                                                                            // Colorize: green
                        "upgradeable embedded controller firmware,\n"                                                                                                                                    // Colorize: green
                        "the value is 0FFh.";                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE 0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the minor release of the\n"                                                                                                                                          // Colorize: green
                        "embedded controller firmware; for example,\n"                                                                                                                                   // Colorize: green
                        "the value is 16h for revision 10.22 and 01h\n"                                                                                                                                  // Colorize: green
                        "for revision 2.1.\n"                                                                                                                                                            // Colorize: green
                        "If the system does not have field\n"                                                                                                                                            // Colorize: green
                        "upgradeable embedded controller firmware,\n"                                                                                                                                    // Colorize: green
                        "the value is 0FFh.";                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE 0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        constantLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                     // Colorize: green
                                        .arg(DMI_SPECIFICATION_URL)                                                                                                                                      // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(constantLines, fileLines))                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS entry constants with specification");                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DmiSpecVerifier dmiSpecVerifierInstance;                                                                                                                                                                 // Colorize: green
