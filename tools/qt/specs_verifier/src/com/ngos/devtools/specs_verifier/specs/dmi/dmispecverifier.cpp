#include "dmispecverifier.h"                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define DMI_SPECIFICATION_URL "https://www.dmtf.org/sites/default/files/standards/documents/DSP0134_3.4.0.pdf" // Version: 3.4.0 / 2020-07-17                                                            // Colorize: green
#define DMI_PDF               "dmi.pdf"                                                                                                                                                                  // Colorize: green
#define DMI_TXT               "dmi.txt"                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define DMI_ENTRY_HEADER_H                               "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/dmientryheader.h"                                                                      // Colorize: green
#define DMI_STRING_ID_H                                  "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/dmistringid.h"                                                                         // Colorize: green
#define DMI_BIOS_ENTRY_H                                 "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/dmibiosentry.h"                                                                  // Colorize: green
#define DMI_BIOS_ROM_SIZE_H                              "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibiosromsize.h"                                                            // Colorize: green
#define DMI_BIOS_CHARACTERISTICS_FLAGS_H                 "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibioscharacteristicsflags.h"                                               // Colorize: green
#define DMI_BIOS_CHARACTERISTICS_BIOS_RESERVED_FLAGS_H   "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibioscharacteristicsbiosreservedflags.h"                                   // Colorize: green
#define DMI_BIOS_CHARACTERISTICS_SYSTEM_RESERVED_FLAGS_H "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibioscharacteristicssystemreservedflags.h"                                 // Colorize: green
#define DMI_BIOS_EXTENDED_ROM_SIZE_H                     "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibiosextendedromsize.h"                                                    // Colorize: green
#define DMI_BIOS_EXTENDED_ROM_SIZE_UNIT_H                "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibiosextendedromsizeunit.h"                                                // Colorize: green
#define DMI_SYSTEM_ENTRY_H                               "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/dmisystementry.h"                                                                // Colorize: green
#define DMI_SYSTEM_WAKE_UP_TYPE_H                        "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmisystemwakeuptype.h"                                                       // Colorize: green
#define DMI_BASEBOARD_ENTRY_H                            "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/dmibaseboardentry.h"                                                             // Colorize: green
#define DMI_BASEBOARD_FEATURE_FLAGS_H                    "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibaseboardfeatureflags.h"                                                  // Colorize: green
#define DMI_BASEBOARD_TYPE_H                             "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmibaseboardtype.h"                                                          // Colorize: green
#define DMI_CHASSIS_ENTRY_H                              "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/dmichassisentry.h"                                                               // Colorize: green
#define DMI_CHASSIS_TYPE_AND_LOCKED_H                    "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassistypeandlocked.h"                                                   // Colorize: green
#define DMI_CHASSIS_TYPE_H                               "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassistype.h"                                                            // Colorize: green
#define DMI_CHASSIS_STATE_H                              "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassisstate.h"                                                           // Colorize: green
#define DMI_CHASSIS_SECURITY_STATUS_H                    "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassissecuritystatus.h"                                                  // Colorize: green
#define DMI_CHASSIS_CONTAINED_ELEMENT_H                  "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassiscontainedelement.h"                                                // Colorize: green
#define DMI_CHASSIS_CONTAINED_ELEMENT_TYPE_H             "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassiscontainedelementtype.h"                                            // Colorize: green
#define DMI_CHASSIS_CONTAINED_ELEMENT_TYPE_SELECT_H      "src/os/shared/common/src/com/ngos/shared/common/dmi/lib/entry/lib/dmichassiscontainedelementtypeselect.h"                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DmiSpecVerifier::DmiSpecVerifier()                                                                                                                                                                       // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mDmiTypeToNgosTypeMap()                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    mDmiTypeToNgosTypeMap.insert("BYTE",  "good_U8");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("WORD",  "good_U16");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("DWORD", "good_U32");                                                                                                                                                // Colorize: green
    mDmiTypeToNgosTypeMap.insert("QWORD", "good_U64");                                                                                                                                                // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, DMI_SPECIFICATION_URL, specContent))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        specContent.replace(QChar(0x2014), '-');  // Replace em dash                     // https://www.compart.com/en/unicode/U+2014                                                                 // Colorize: green
        specContent.replace(QChar(0x2018), '\''); // Replace left single quotation mark  // https://www.compart.com/en/unicode/U+2018                                                                    // Colorize: green
        specContent.replace(QChar(0x2019), '\''); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+2019                                                                    // Colorize: green
        specContent.replace(QChar(0x201C), '\"'); // Replace left double quotation mark  // https://www.compart.com/en/unicode/U+201C                                                                    // Colorize: green
        specContent.replace(QChar(0x201D), '\"'); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+201D                                                                    // Colorize: green
        specContent.replace(QChar(0x2022), '*');  // Replace bullet                      // https://www.compart.com/en/unicode/U+2022                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool DmiSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for DMI specification");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get DMI specification from: %1")                                                                                                                     // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + DMI_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for DMI specification");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << DMI_PDF << DMI_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + DMI_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open DMI specification");                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkDmiSpecification(thread, specContent);                                                                                                                                                      // Colorize: green
        checkDmiEntryHeader(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiStringId(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosEntry(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosRomSize(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosCharacteristics(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosCharacteristicsBiosReserved(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosCharacteristicsSystemReserved(thread, specContent);                                                                                                                                                             // Colorize: green
        checkDmiBiosExtendedRomSize(thread, specContent);                                                                                                                                                // Colorize: green
        checkDmiBiosExtendedRomSizeUnit(thread, specContent);                                                                                                                                            // Colorize: green
        checkDmiSystemEntry(thread, specContent);                                                                                                                                                        // Colorize: green
        checkDmiSystemWakeUpType(thread, specContent);                                                                                                                                                   // Colorize: green
        checkDmiBaseboardEntry(thread, specContent);                                                                                                                                                     // Colorize: green
        checkDmiBaseboardFeatureFlags(thread, specContent);                                                                                                                                              // Colorize: green
        checkDmiBaseboardType(thread, specContent);                                                                                                                                                      // Colorize: green
        checkDmiChassisEntry(thread, specContent);                                                                                                                                                       // Colorize: green
        checkDmiChassisTypeAndLocked(thread, specContent);                                                                                                                                               // Colorize: green
        checkDmiChassisType(thread, specContent);                                                                                                                                                        // Colorize: green
        checkDmiChassisState(thread, specContent);                                                                                                                                                       // Colorize: green
        checkDmiChassisSecurityStatus(thread, specContent);                                                                                                                                              // Colorize: green
        checkDmiChassisContainedElement(thread, specContent);                                                                                                                                            // Colorize: green
        checkDmiChassisContainedElementType(thread, specContent);                                                                                                                                        // Colorize: green
        checkDmiChassisContainedElementTypeSelect(thread, specContent);                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with DMI specification");                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with DMI specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Identifier: DSP0134\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Date: 2020-07-17\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version: 3.4.0\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System Management BIOS (SMBIOS) Reference\n"                                                                                                                                                // Colorize: green
            "Specification\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Supersedes: 3.3.0\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Class: Normative\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Status: Published\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "11\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Document Language: en-US";                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI specification version didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiEntryHeader(SpecVerifyThread *thread, const QString &specContent)                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString headerText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init headerText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerText =                                                                                                                                                                                     // Colorize: green
            "901\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6.1.2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "902\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Each SMBIOS structure begins with a four-byte header as shown in Table 3.\n"                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Structure header format\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 3  Structure header format description\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "903\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the type of structure. Types 0 through 127 (7Fh) are reserved for and\n"                                                                                                          // Colorize: green
            "defined by this specification. Types 128 through 256 (80h to FFh) are available for\n"                                                                                                      // Colorize: green
            "system- and OEM-specific information.\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the length of the formatted area of the structure, starting at the Type field.\n"                                                                                                 // Colorize: green
            "The length of the structure's string-set is not included.\n"                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Specifies the structure's handle, a unique 16-bit number in the range 0 to 0FFFEh\n"                                                                                                        // Colorize: green
            "(for version 2.0) or 0 to 0FEFFh (for version 2.1 and later). The handle can be used\n"                                                                                                     // Colorize: green
            "with the Get SMBIOS Structure function to retrieve a specific structure; the handle\n"                                                                                                      // Colorize: green
            "numbers are not required to be contiguous. For version 2.1 and later, handle\n"                                                                                                             // Colorize: green
            "values in the range 0FF00h to 0FFFFh are reserved for use by this specification. [1]\n"                                                                                                     // Colorize: green
            "If the system configuration changes, a previously assigned handle might no longer\n"                                                                                                        // Colorize: green
            "exist. However, after a handle has been assigned by the BIOS, the BIOS cannot\n"                                                                                                            // Colorize: green
            "re-assign that handle number to another structure.\n"                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "[1]\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The UEFI Platform Initialization Specification reserves handle number FFFEh for its EFI_SMBIOS_PROTOCOL.Add() function\n"                                                                   // Colorize: green
            "to mean \"assign an unused handle number automatically.\" This number is not used for any other purpose by the SMBIOS\n"                                                                      // Colorize: green
            "specification.";                                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(headerText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI header specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = headerText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(10) != "Table 3  Structure header format description"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(11) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(12) != "903"                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(13) != "Offset"                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(14) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(15) != "Name"                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(16) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(17) != "Length"                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(18) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(19) != "Description"                                                                                                                                                                // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(20) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 21;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldDescriptions;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (offset == "[1]")                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(name);                                                                                                                                                                     // Colorize: green
            fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
            fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i >= lines.size())                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Type",   "type");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Length", "length");                                                                                                                                     // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Handle", "handle");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList headerLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        headerLines.append("struct DmiEntryHeader");                                                                                                                                                          // Colorize: green
        headerLines.append("{");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldNames.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(i), fieldTypes.at(i));                                                                                                                            // Colorize: green
            QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(i), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldNames.at(i))                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            headerLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                        .arg(type, -12, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(name)                                                                                                                                                       // Colorize: green
                                        .arg("", 6 - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                        .arg(fieldDescriptions.at(i))                                                                                                                                    // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        headerLines.append("} __attribute__((packed));");                                                                                                                                                                        // Colorize: green
        headerLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.replaceInStrings("    good_U8      type;", "    DmiEntryType type;");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(headerLines, thread->getPath() + "/" + DMI_ENTRY_HEADER_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI header with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiStringId(SpecVerifyThread *thread, const QString &specContent)                                                                                                             // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString stringIdText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init stringIdText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        stringIdText =                                                                                                                                                                                     // Colorize: green
            "904\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6.1.3\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Text strings\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "905\n"                                                                                                                                                                                      // Colorize: green
            "906\n"                                                                                                                                                                                      // Colorize: green
            "907\n"                                                                                                                                                                                      // Colorize: green
            "908\n"                                                                                                                                                                                      // Colorize: green
            "909\n"                                                                                                                                                                                      // Colorize: green
            "910\n"                                                                                                                                                                                      // Colorize: green
            "911\n"                                                                                                                                                                                      // Colorize: green
            "912\n"                                                                                                                                                                                      // Colorize: green
            "913\n"                                                                                                                                                                                      // Colorize: green
            "914\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Text strings associated with a given SMBIOS structure are appended directly after the formatted portion\n"                                                                                  // Colorize: green
            "of the structure. This method of returning string information eliminates the need for application software to\n"                                                                            // Colorize: green
            "deal with pointers embedded in the SMBIOS structure. Each string is terminated with a null (00h) BYTE\n"                                                                                    // Colorize: green
            "and the set of strings is terminated with an additional null (00h) BYTE. When the formatted portion of an\n"                                                                                // Colorize: green
            "SMBIOS structure references a string, it does so by specifying a non-zero string number within the\n"                                                                                       // Colorize: green
            "structure's string-set. For example, if a string field contains 02h, it references the second string following\n"                                                                           // Colorize: green
            "the formatted portion of the SMBIOS structure. If a string field references no string, a null (0) is placed in\n"                                                                           // Colorize: green
            "that string field. If the formatted portion of the structure contains string-reference fields and all the string\n"                                                                         // Colorize: green
            "fields are set to 0 (no string references), the formatted section of the structure is followed by two null\n"                                                                               // Colorize: green
            "(00h) BYTES. See 6.1.1 for a string-containing example.\n"                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "915\n"                                                                                                                                                                                      // Colorize: green
            "916\n"                                                                                                                                                                                      // Colorize: green
            "917\n"                                                                                                                                                                                      // Colorize: green
            "918\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "There is no limit on the length of each individual text string. However, the length of the entire structure table\n"                                                                        // Colorize: green
            "(including all strings) must be reported in the Structure Table Length field of the 32-bit Structure Table Entry\n"                                                                         // Colorize: green
            "Point (see 5.2.1) and/or the Structure Table Maximum Size field of the 64-bit Structure Table Entry Point\n"                                                                                // Colorize: green
            "(see 5.2.2).";                                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(stringIdText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI String ID specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList stringIdLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        stringIdLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        stringIdLines.append("struct DmiStringId");                                                                                                                                                      // Colorize: green
        stringIdLines.append("{");                                                                                                                                                                       // Colorize: green
        stringIdLines.append("    DmiStringId()");                                                                                                                                                       // Colorize: green
        stringIdLines.append("        : id(0)");                                                                                                                                                         // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                     // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline DmiStringId& operator=(const DmiStringId &another)");                                                                                                           // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"another = ...\")); // Commented to avoid too frequent logs");                                                                                      // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        id = another.id;");                                                                                                                                                // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return *this;");                                                                                                                                                   // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline DmiStringId& operator++()");                                                                                                                                    // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        ++id;");                                                                                                                                                           // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return *this;");                                                                                                                                                   // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    inline bool operator==(const DmiStringId &another) const");                                                                                                            // Colorize: green
        stringIdLines.append("    {");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("        // COMMON_LT((\"another = ...\")); // Commented to avoid too frequent logs");                                                                                      // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("        return id == another.id;");                                                                                                                                        // Colorize: green
        stringIdLines.append("    }");                                                                                                                                                                   // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("");                                                                                                                                                                        // Colorize: green
        stringIdLines.append("    good_U8 id;");                                                                                                                                                         // Colorize: green
        stringIdLines.append("} __attribute__((packed));");                                                                                                                                              // Colorize: green
        stringIdLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(stringIdLines, thread->getPath() + "/" + DMI_STRING_ID_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI String ID with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString entryText1;                                                                                                                                                                                  // Colorize: green
    QString entryText2;                                                                                                                                                                                  // Colorize: green
    QString entryText3;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init entryText1, entryText2 and entryText3                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryText1 =                                                                                                                                                                                     // Colorize: green
            "936\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.1\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "937\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 6 shows the BIOS Information structure.\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Information (Type 0)\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 6  BIOS Information (Type 0) structure\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "938\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Information indicator\n"                                                                                                                                                               // Colorize: green
            "";                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText2 =                                                                                                                                                                                     // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12h + number of BIOS Characteristics\n"                                                                                                                                                     // Colorize: green
            "Extension Bytes. If no Extension Bytes are\n"                                                                                                                                               // Colorize: green
            "used the Length is 12h. For version 2.1 and\n"                                                                                                                                              // Colorize: green
            "2.2 implementations, the length is 13h\n"                                                                                                                                                   // Colorize: green
            "because one extension byte is defined. For\n"                                                                                                                                               // Colorize: green
            "version 2.3 and later implementations, the\n"                                                                                                                                               // Colorize: green
            "length is at least 14h because two extension\n"                                                                                                                                             // Colorize: green
            "bytes are defined. For version 2.4 to 3.0,\n"                                                                                                                                               // Colorize: green
            "implementations, the length is at least 18h\n"                                                                                                                                              // Colorize: green
            "because bytes 14-17h are defined. For\n"                                                                                                                                                    // Colorize: green
            "version 3.1 and later implementations, the\n"                                                                                                                                               // Colorize: green
            "length is at least 1Ah because bytes 14-19h\n"                                                                                                                                              // Colorize: green
            "are defined.\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Vendor\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS Vendor's Name.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Version\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS Version. This\n"                                                                                                                                                  // Colorize: green
            "value is a free-form string that may contain\n"                                                                                                                                             // Colorize: green
            "Core and OEM version information.\n"                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Starting\n"                                                                                                                                                                            // Colorize: green
            "Address Segment\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Segment location of BIOS starting address\n"                                                                                                                                                // Colorize: green
            "(for example, 0E800h).\n"                                                                                                                                                                   // Colorize: green
            "NOTE: The size of the runtime BIOS image can\n"                                                                                                                                             // Colorize: green
            "be computed by subtracting the Starting\n"                                                                                                                                                  // Colorize: green
            "Address Segment from 10000h and\n"                                                                                                                                                          // Colorize: green
            "multiplying the result by 16.\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Release\n"                                                                                                                                                                             // Colorize: green
            "Date\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "String number of the BIOS release date.\n"                                                                                                                                                  // Colorize: green
            "The date string, if supplied, is in either\n"                                                                                                                                               // Colorize: green
            "mm/dd/yy or mm/dd/yyyy format. If the year\n"                                                                                                                                               // Colorize: green
            "portion of the string is two digits, the year is\n"                                                                                                                                         // Colorize: green
            "assumed to be 19yy.\n"                                                                                                                                                                      // Colorize: green
            "NOTE: The mm/dd/yyyy format is required for\n"                                                                                                                                              // Colorize: green
            "SMBIOS version 2.3 and later.\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "09h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS ROM Size\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies (n)\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size (n) where 64K * (n+1) is the size of the\n"                                                                                                                                            // Colorize: green
            "physical device containing the BIOS, in\n"                                                                                                                                                  // Colorize: green
            "bytes.\n"                                                                                                                                                                                   // Colorize: green
            "FFh - size is 16MB or greater, see Extended\n"                                                                                                                                              // Colorize: green
            "BIOS ROM Size for actual size\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Ah\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS\n"                                                                                                                                                                                     // Colorize: green
            "Characteristics\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "QWORD\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Defines which functions the BIOS supports:\n"                                                                                                                                               // Colorize: green
            "PCI, PCMCIA, Flash, etc. (see 7.1.1).\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS\n"                                                                                                                                                                                     // Colorize: green
            "Characteristics\n"                                                                                                                                                                          // Colorize: green
            "Extension Bytes\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Zero or more\n"                                                                                                                                                                             // Colorize: green
            "BYTEs\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Optional space reserved for future\n"                                                                                                                                                       // Colorize: green
            "supported functions. The number of\n"                                                                                                                                                       // Colorize: green
            "Extension Bytes that is present is indicated\n"                                                                                                                                             // Colorize: green
            "by the Length in offset 1 minus 12h. See\n"                                                                                                                                                 // Colorize: green
            "7.1.2 for extensions defined for version 2.1\n"                                                                                                                                             // Colorize: green
            "and later implementations. For version 2.4\n"                                                                                                                                               // Colorize: green
            "and later implementations, two BIOS\n"                                                                                                                                                      // Colorize: green
            "Characteristics Extension Bytes are defined\n"                                                                                                                                              // Colorize: green
            "(12-13h) and bytes 14-17h are also defined.\n"                                                                                                                                              // Colorize: green
            "";                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText3 =                                                                                                                                                                                     // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "14h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System BIOS\n"                                                                                                                                                                              // Colorize: green
            "Major Release\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the major release of the System\n"                                                                                                                                               // Colorize: green
            "BIOS; for example, the value is 0Ah for\n"                                                                                                                                                  // Colorize: green
            "revision 10.22 and 02h for revision 2.1.\n"                                                                                                                                                 // Colorize: green
            "This field or the System BIOS Minor\n"                                                                                                                                                      // Colorize: green
            "Release field or both are updated each time\n"                                                                                                                                              // Colorize: green
            "a System BIOS update for a given system is\n"                                                                                                                                               // Colorize: green
            "released.\n"                                                                                                                                                                                // Colorize: green
            "If the system does not support the use of\n"                                                                                                                                                // Colorize: green
            "this field, the value is 0FFh for both this field\n"                                                                                                                                        // Colorize: green
            "and the System BIOS Minor Release field.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System BIOS\n"                                                                                                                                                                              // Colorize: green
            "Minor Release\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the minor release of the System\n"                                                                                                                                               // Colorize: green
            "BIOS; for example, the value is 16h for\n"                                                                                                                                                  // Colorize: green
            "revision 10.22 and 01h for revision 2.1.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Embedded\n"                                                                                                                                                                                 // Colorize: green
            "Controller\n"                                                                                                                                                                               // Colorize: green
            "Firmware Major\n"                                                                                                                                                                           // Colorize: green
            "Release\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the major release of the\n"                                                                                                                                                      // Colorize: green
            "embedded controller firmware; for example,\n"                                                                                                                                               // Colorize: green
            "the value would be 0Ah for revision 10.22\n"                                                                                                                                                // Colorize: green
            "and 02h for revision 2.1.\n"                                                                                                                                                                // Colorize: green
            "This field or the Embedded Controller\n"                                                                                                                                                    // Colorize: green
            "Firmware Minor Release field or both are\n"                                                                                                                                                 // Colorize: green
            "updated each time an embedded controller\n"                                                                                                                                                 // Colorize: green
            "firmware update for a given system is\n"                                                                                                                                                    // Colorize: green
            "released.\n"                                                                                                                                                                                // Colorize: green
            "If the system does not have field\n"                                                                                                                                                        // Colorize: green
            "upgradeable embedded controller firmware,\n"                                                                                                                                                // Colorize: green
            "the value is 0FFh.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "17h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Embedded\n"                                                                                                                                                                                 // Colorize: green
            "Controller\n"                                                                                                                                                                               // Colorize: green
            "Firmware Minor\n"                                                                                                                                                                           // Colorize: green
            "Release\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the minor release of the\n"                                                                                                                                                      // Colorize: green
            "embedded controller firmware; for example,\n"                                                                                                                                               // Colorize: green
            "the value is 16h for revision 10.22 and 01h\n"                                                                                                                                              // Colorize: green
            "for revision 2.1.\n"                                                                                                                                                                        // Colorize: green
            "If the system does not have field\n"                                                                                                                                                        // Colorize: green
            "upgradeable embedded controller firmware,\n"                                                                                                                                                // Colorize: green
            "the value is 0FFh.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "18h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3.1+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended BIOS\n"                                                                                                                                                                            // Colorize: green
            "ROM Size\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Extended size of the physical device(s)\n"                                                                                                                                                  // Colorize: green
            "containing the BIOS, rounded up if needed.\n"                                                                                                                                               // Colorize: green
            "Bits 15:14\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unit\n"                                                                                                                                                                                     // Colorize: green
            "00b - megabytes\n"                                                                                                                                                                          // Colorize: green
            "01b - gigabytes\n"                                                                                                                                                                          // Colorize: green
            "10b - reserved\n"                                                                                                                                                                           // Colorize: green
            "11b - reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 13:0\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Examples: a 16 MB device would be\n"                                                                                                                                                        // Colorize: green
            "represented as 0010h. A 48 GB device set\n"                                                                                                                                                 // Colorize: green
            "would be represented as\n"                                                                                                                                                                  // Colorize: green
            "0100_0000_0011_0000b or 4030h.";                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(entryText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText2)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText3)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS entry specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (entryText1 + '\n' + entryText2 + '\n' + entryText3).split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(75) != "02h"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(76) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(77) != "2.0+"                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(78) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(79) != "Handle"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(80) != ""                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(81) != "WORD"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(82) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(83) != "Varies"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(84) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI BIOS entry specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 85;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList        versionGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> nameGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> typeGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> descriptionGroups;                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QString     lastVersion;                                                                                                                                                                      // Colorize: green
        QStringList fieldNames;                                                                                                                                                                              // Colorize: green
        QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
        QStringList fieldDescriptions;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (offset == "Offset")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 13;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                offset = lines.at(i);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString version = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                name.append(' ');                                                                                                                                                                 // Colorize: green
                name.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                type.append(' ');                                                                                                                                                                 // Colorize: green
                type.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1)                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString nextLine = lines.at(i + 1);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (nextLine == "")                                                                                                                                                                      // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString nextLine2 = i < lines.size() - 2 ? lines.at(i + 2) : "";                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2.length() == 3 && nextLine2.endsWith('h'))                                                                                                                              // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2 == "Offset")                                                                                                                                                           // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(nextLine);                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "BYTE" && value == "STRING")                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                type = "DmiStringId";                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill groups                                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                if (version != lastVersion)                                                                                                                                                                  // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    if (lastVersion != "")                                                                                                                                                                   // Colorize: green
                    {                                                                                                                                                                                        // Colorize: green
                        versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
                        nameGroups.append(fieldNames);                                                                                                                                                       // Colorize: green
                        typeGroups.append(fieldTypes);                                                                                                                                                       // Colorize: green
                        descriptionGroups.append(fieldDescriptions);                                                                                                                                         // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                        fieldNames.clear();                                                                                                                                                                  // Colorize: green
                        fieldTypes.clear();                                                                                                                                                                  // Colorize: green
                        fieldDescriptions.clear();                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    lastVersion = version;                                                                                                                                                                   // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                fieldNames.append(name);                                                                                                                                                                     // Colorize: green
                fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
                fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Add last group                                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
            nameGroups.append(fieldNames);                                                                                                                                                               // Colorize: green
            typeGroups.append(fieldTypes);                                                                                                                                                               // Colorize: green
            descriptionGroups.append(fieldDescriptions);                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Update groups                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionGroups.insert(1,     "V21");                                                                                                                                                              // Colorize: green
        nameGroups.insert(1,        QStringList() << "BIOS Characteristics Extension Bytes (BIOS)");                                                                                                     // Colorize: green
        typeGroups.insert(1,        QStringList() << "Zero or more BYTEs");                                                                                                                              // Colorize: green
        descriptionGroups.insert(1, QStringList() << descriptionGroups.at(1).constFirst());                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        versionGroups.insert(2,     "V23");                                                                                                                                                              // Colorize: green
        nameGroups.insert(2,        QStringList() << "BIOS Characteristics Extension Bytes (System)");                                                                                                     // Colorize: green
        typeGroups.insert(2,        QStringList() << "Zero or more BYTEs");                                                                                                                              // Colorize: green
        descriptionGroups.insert(2, QStringList() << descriptionGroups.at(2).constFirst());                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        nameGroups[3].removeFirst();                                                                                                                                                                     // Colorize: green
        typeGroups[3].removeFirst();                                                                                                                                                                     // Colorize: green
        descriptionGroups[3].removeFirst();                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Vendor",                                        "vendor");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Version",                                  "biosVersion");                                                                                                                                     // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Starting Address Segment",                 "biosStartingAddressSegment");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Release Date",                             "biosReleaseDate");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS ROM Size",                                 "biosRomSize");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics",                          "biosCharacteristics");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics Extension Bytes (BIOS)",   "biosCharacteristicsExtensionBiosReserved");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics Extension Bytes (System)", "biosCharacteristicsExtensionSystemReserved");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("System BIOS Major Release",                     "systemBiosMajorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("System BIOS Minor Release",                     "systemBiosMinorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Embedded Controller Firmware Major Release",    "embeddedControllerFirmwareMajorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Embedded Controller Firmware Minor Release",    "embeddedControllerFirmwareMinorRelease");                                                                                                                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Extended BIOS ROM Size",                        "extendedBiosRomSize");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    const QList<qint64> typeAlignment = { 27, 39, 41, 7,  22 };                                                                                                                                                             // Colorize: green
    const QList<qint64> nameAlignment = { 26, 40, 42, 38, 19 };                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList entryLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < versionGroups.size(); ++i)                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const QStringList &fieldNames        = nameGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldTypes        = typeGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldDescriptions = descriptionGroups.at(i);                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (i > 0)                                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            entryLines.append(QString("struct DmiBiosEntry%1")                                                                                                                                          // Colorize: green
                                        .arg(i > 0 ? (versionGroups.at(i) + ": public DmiBiosEntry" + (i > 1 ? versionGroups.at(i - 1) : "")) : "")                                                                     // Colorize: green
            );                                                                                                                                                   // Colorize: green
            entryLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            for (qint64 j = 0; j < fieldNames.size(); ++j)                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                                // Colorize: green
                QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(j), fieldTypes.at(j));                                                                                                                            // Colorize: green
                QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(j), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                if (name == "")                                                                                                                                                                              // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                                .arg(fieldNames.at(j))                                                                                                                                              // Colorize: green
                    );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    return;                                                                                                                                                                                  // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                entryLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                            .arg(type, -typeAlignment.at(i), QChar(' '))                                                                                                                                      // Colorize: green
                                            .arg(name)                                                                                                                                                       // Colorize: green
                                            .arg("", nameAlignment.at(i) - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                            .arg(fieldDescriptions.at(j))                                                                                                                                    // Colorize: green
                );                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            entryLines.append("} __attribute__((packed));");                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.insert(3, "    DmiEntryHeader              header;");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.replaceInStrings("    good_U8                     biosRomSize;",                                              "    DmiBiosRomSize              biosRomSize;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U64                    biosCharacteristics;",                                      "    DmiBiosCharacteristicsFlags biosCharacteristics;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    Zero or more BYTEs                      biosCharacteristicsExtensionBiosReserved;",     "    DmiBiosCharacteristicsBiosReservedFlags biosCharacteristicsExtensionBiosReserved;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    Zero or more BYTEs                        biosCharacteristicsExtensionSystemReserved;", "    DmiBiosCharacteristicsSystemReservedFlags biosCharacteristicsExtensionSystemReserved;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U16               extendedBiosRomSize;",                                           "    DmiBiosExtendedRomSize extendedBiosRomSize;");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + DMI_BIOS_ENTRY_H);                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(entryLines, fileLines))                                                                                                                                                                                                     // Colorize: green                                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS entry with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList constantLines;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        constantLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(DMI_SPECIFICATION_URL)                                                                                                                                      // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Constants                                                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Size (n) where 64K * (n+1) is the size of the\n"                                                                                                                                // Colorize: green
                        "physical device containing the BIOS, in\n"                                                                                                                                      // Colorize: green
                        "bytes.\n"                                                                                                                                                                       // Colorize: green
                        "FFh - size is 16MB or greater, see Extended\n"                                                                                                                                  // Colorize: green
                        "BIOS ROM Size for actual size";                                                                                                                                                 // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_BIOS_ROM_SIZE_NEED_TO_EXTEND                             0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE / DMI_BIOS_SYSTEM_BIOS_MINOR_RELEASE_NOT_AVAILABLE                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the major release of the System\n"                                                                                                                                   // Colorize: green
                        "BIOS; for example, the value is 0Ah for\n"                                                                                                                                      // Colorize: green
                        "revision 10.22 and 02h for revision 2.1.\n"                                                                                                                                     // Colorize: green
                        "This field or the System BIOS Minor\n"                                                                                                                                          // Colorize: green
                        "Release field or both are updated each time\n"                                                                                                                                  // Colorize: green
                        "a System BIOS update for a given system is\n"                                                                                                                                   // Colorize: green
                        "released.\n"                                                                                                                                                                    // Colorize: green
                        "If the system does not support the use of\n"                                                                                                                                    // Colorize: green
                        "this field, the value is 0FFh for both this field\n"                                                                                                                            // Colorize: green
                        "and the System BIOS Minor Release field.";                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_SYSTEM_BIOS_MAJOR_RELEASE_NOT_AVAILABLE                  0xFF");                                                                                  // Colorize: green
                constantLines.append("#define DMI_BIOS_SYSTEM_BIOS_MINOR_RELEASE_NOT_AVAILABLE                  0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the major release of the\n"                                                                                                                                          // Colorize: green
                        "embedded controller firmware; for example,\n"                                                                                                                                   // Colorize: green
                        "the value would be 0Ah for revision 10.22\n"                                                                                                                                    // Colorize: green
                        "and 02h for revision 2.1.\n"                                                                                                                                                    // Colorize: green
                        "This field or the Embedded Controller\n"                                                                                                                                        // Colorize: green
                        "Firmware Minor Release field or both are\n"                                                                                                                                     // Colorize: green
                        "updated each time an embedded controller\n"                                                                                                                                     // Colorize: green
                        "firmware update for a given system is\n"                                                                                                                                        // Colorize: green
                        "released.\n"                                                                                                                                                                    // Colorize: green
                        "If the system does not have field\n"                                                                                                                                            // Colorize: green
                        "upgradeable embedded controller firmware,\n"                                                                                                                                    // Colorize: green
                        "the value is 0FFh.";                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MAJOR_RELEASE_NOT_AVAILABLE 0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString constantText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Init constantText                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    constantText =                                                                                                                                                                       // Colorize: green
                        "Identifies the minor release of the\n"                                                                                                                                          // Colorize: green
                        "embedded controller firmware; for example,\n"                                                                                                                                   // Colorize: green
                        "the value is 16h for revision 10.22 and 01h\n"                                                                                                                                  // Colorize: green
                        "for revision 2.1.\n"                                                                                                                                                            // Colorize: green
                        "If the system does not have field\n"                                                                                                                                            // Colorize: green
                        "upgradeable embedded controller firmware,\n"                                                                                                                                    // Colorize: green
                        "the value is 0FFh.";                                                                                                                                                            // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Check that specification contains required text                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    if (!specContent.contains(constantText))                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        thread->addError("DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE specification didn't match with the stored one");                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        return;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                constantLines.append("#define DMI_BIOS_EMBEDDED_CONTROLLER_FIRMWARE_MINOR_RELEASE_NOT_AVAILABLE 0xFF");                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        constantLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                     // Colorize: green
                                        .arg(DMI_SPECIFICATION_URL)                                                                                                                                      // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(constantLines, fileLines))                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS entry constants with specification");                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosRomSize(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sizeText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sizeText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sizeText =                                                                                                                                                                                       // Colorize: green
            "Size (n) where 64K * (n+1) is the size of the\n"                                                                                                                                            // Colorize: green
            "physical device containing the BIOS, in\n"                                                                                                                                                  // Colorize: green
            "bytes.\n"                                                                                                                                                                                   // Colorize: green
            "FFh - size is 16MB or greater, see Extended\n"                                                                                                                                              // Colorize: green
            "BIOS ROM Size for actual size";                                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sizeText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS ROM Size specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sizeLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sizeLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        sizeLines.append("struct DmiBiosRomSize");                                                                                                                                                       // Colorize: green
        sizeLines.append("{");                                                                                                                                                                           // Colorize: green
        sizeLines.append("    inline good_U64 size() const");                                                                                                                                            // Colorize: green
        sizeLines.append("    {");                                                                                                                                                                       // Colorize: green
        sizeLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                         // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("        return (value + 1) * 64 * KB;");                                                                                                                                       // Colorize: green
        sizeLines.append("    }");                                                                                                                                                                       // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("    good_U8 value;");                                                                                                                                                          // Colorize: green
        sizeLines.append("} __attribute__((packed));");                                                                                                                                                  // Colorize: green
        sizeLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sizeLines, thread->getPath() + "/" + DMI_BIOS_ROM_SIZE_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS ROM Size with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosCharacteristics(SpecVerifyThread *thread, const QString &specContent)                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString flagsText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init flagsText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsText =                                                                                                                                                                                       // Colorize: green
            "Table 7  BIOS Characteristics\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "941\n"                                                                                                                                                                                      // Colorize: green
            "QWORD Bit Position\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning If Set\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 0\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 1\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unknown.\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 3\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Characteristics are not supported.\n"                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 4\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ISA is supported.\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 5\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "MCA is supported.\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 6\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EISA is supported.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 7\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PCI is supported.\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 8\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PC card (PCMCIA) is supported.\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 9\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Plug and Play is supported.\n"                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 10\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "APM is supported.\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 11\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS is upgradeable (Flash).\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 12\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS shadowing is allowed.\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 13\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "VL-VESA is supported.\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 14\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ESCD support is available.\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 15\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Boot from CD is supported.\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 16\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Selectable boot is supported.\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 17\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS ROM is socketed (e.g. PLCC or SOP socket).\n"                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 18\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Boot from PC card (PCMCIA) is supported.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 19\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EDD specification is supported.\n"                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 20\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - Japanese floppy for NEC 9800 1.2 MB (3.5\", 1K bytes/sector, 360 RPM) is\n"                                                                                                        // Colorize: green
            "supported.\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 21\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - Japanese floppy for Toshiba 1.2 MB (3.5\", 360 RPM) is supported.\n"                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 22\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - 5.25\" / 360 KB floppy services are supported.\n"                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 23\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - 5.25\" /1.2 MB floppy services are supported.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 24\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - 3.5\" / 720 KB floppy services are supported.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 25\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 13h - 3.5\" / 2.88 MB floppy services are supported.\n"                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 26\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 5h, print screen Service is supported.\n"                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 27\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 9h, 8042 keyboard services are supported.\n"                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 28\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 14h, serial services are supported.\n"                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 29\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 17h, printer services are supported.\n"                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 30\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Int 10h, CGA/Mono Video Services are supported.\n"                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 31\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NEC PC-98.\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits32:47\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved for BIOS vendor.\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 48:63\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved for system vendor.";                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(flagsText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS Characteristics specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = flagsText.split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(0) != "Table 7  BIOS Characteristics"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(1) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(2) != "941"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(3) != "QWORD Bit Position"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(4) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(5) != "Meaning If Set"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(6) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI BIOS Characteristics specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString bit = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (bit == "Bits32:47")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (bit.startsWith("Bit "))                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bit.remove(0, 4);                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Unknown.",                                                                                      "UNKNOWN");                                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Characteristics are not supported.",                                                       "BIOS_CHARACTERISTICS_NOT_SUPPORTED");                      // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("ISA is supported.",                                                                             "ISA_SUPPORTED");                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("MCA is supported.",                                                                             "MCA_SUPPORTED");                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("EISA is supported.",                                                                            "EISA_SUPPORTED");                                          // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("PCI is supported.",                                                                             "PCI_SUPPORTED");                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("PC card (PCMCIA) is supported.",                                                                "PCMCIA_SUPPORTED");                                        // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Plug and Play is supported.",                                                                   "PLUG_AND_PLAY_SUPPORTED");                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("APM is supported.",                                                                             "APM_SUPPORTED");                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS is upgradeable (Flash).",                                                                  "BIOS_UPGRADABLE");                                         // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS shadowing is allowed.",                                                                    "BIOS_SHADOWING_ALLOWED");                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("VL-VESA is supported.",                                                                         "VL_VESA_SUPPORTED");                                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("ESCD support is available.",                                                                    "ESCD_SUPPORT_AVAILABLE");                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Boot from CD is supported.",                                                                    "BOOT_FROM_CD_SUPPORTED");                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Selectable boot is supported.",                                                                 "SELECTABLE_BOOT_SUPPORTED");                               // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS ROM is socketed (e.g. PLCC or SOP socket).",                                               "BIOS_ROM_SOCKETED");                                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Boot from PC card (PCMCIA) is supported.",                                                      "BOOT_FROM_PCMCIA_SUPPORTED");                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("EDD specification is supported.",                                                               "EDD_SPECIFICATION_SUPPORTED");                             // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - Japanese floppy for NEC 9800 1.2 MB (3.5\", 1K bytes/sector, 360 RPM) is supported.", "JAPANESE_NEC_FLOPPY_SUPPORTED");                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - Japanese floppy for Toshiba 1.2 MB (3.5\", 360 RPM) is supported.",                   "JAPANESE_TOSHIBA_FLOPPY_SUPPORTED");                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - 5.25\" / 360 KB floppy services are supported.",                                      "FLOPPY_525_360_SUPPORTED");                                // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - 5.25\" /1.2 MB floppy services are supported.",                                       "FLOPPY_525_12_SUPPORTED");                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - 3.5\" / 720 KB floppy services are supported.",                                       "FLOPPY_35_720_SUPPORTED");                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 13h - 3.5\" / 2.88 MB floppy services are supported.",                                      "FLOPPY_35_288_SUPPORTED");                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 5h, print screen Service is supported.",                                                    "PRINT_SCREEN_SUPPORTED");                                  // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 9h, 8042 keyboard services are supported.",                                                 "KEYBOARD_8042_SUPPORTED");                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 14h, serial services are supported.",                                                       "SERIAL_SUPPORTED");                                        // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 17h, printer services are supported.",                                                      "PRINTER_SUPPORTED");                                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Int 10h, CGA/Mono Video Services are supported.",                                               "CGA_MONO_SUPPORTED");                                      // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("NEC PC-98.",                                                                                    "NEC_PC_98");                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList flagsLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        flagsLines.append("typedef good_U64 dmi_bios_characteristics_flags;");                                                                                                                      // Colorize: green
        flagsLines.append("");                                                                                                                                                                 // Colorize: green
        flagsLines.append("enum class DmiBiosCharacteristicsFlag: dmi_bios_characteristics_flags");                                                                                            // Colorize: green
        flagsLines.append("{");                                                                                                                                                                // Colorize: green
        flagsLines.append("    NONE                               = 0,");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            flagsLines.append(QString("    %1 = (1ULL << %2)%3%4 // %5")                                                                                                                                             // Colorize: green
                                                .arg(field, -34, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(bits.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg("", 2 - bits.at(i).length(), QChar(' '))                                                                                                                // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        flagsLines.append("};");                                                                                                                                                                  // Colorize: green
        flagsLines.append("");                                                                                                                                                                    // Colorize: green
        flagsLines.append("DEFINE_FLAGS(DmiBiosCharacteristicsFlags, dmi_bios_characteristics_flags); // TEST: NO");                                                                                                       // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(flagsLines, thread->getPath() + "/" + DMI_BIOS_CHARACTERISTICS_FLAGS_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS Characteristics with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosCharacteristicsBiosReserved(SpecVerifyThread *thread, const QString &specContent)                                                                                      // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString flagsText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init flagsText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsText =                                                                                                                                                                                       // Colorize: green
            "BIOS Characteristics Extension Byte 1\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "944\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.1.2.1\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "945\n"                                                                                                                                                                                      // Colorize: green
            "946\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 8 shows the BIOS Characteristics Extension Byte 1 layout. This information, available for SMBIOS\n"                                                                                   // Colorize: green
            "version 2.1 and later, appears at offset 12h within the BIOS Information structure.\n"                                                                                                      // Colorize: green
            "Table 8  BIOS Characteristics Extension Byte 1\n"                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "947\n"                                                                                                                                                                                      // Colorize: green
            "Byte Bit Position\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning If Set\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 0\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ACPI is supported.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 1\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "USB Legacy is supported.\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "AGP is supported.\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 3\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "I2O boot is supported.\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 4\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "LS-120 SuperDisk boot is supported.\n"                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 5\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ATAPI ZIP drive boot is supported.\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 6\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1394 boot is supported.\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 7\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Smart battery is supported.";                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(flagsText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS Characteristics BIOS Reserved specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = flagsText.split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(11) != "Table 8  BIOS Characteristics Extension Byte 1"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(12) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(13) != "947"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(14) != "Byte Bit Position"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(15) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(16) != "Meaning If Set"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(17) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI BIOS Characteristics BIOS Reserved specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 18;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString bit = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (bit.startsWith("Bit "))                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bit.remove(0, 4);                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("ACPI is supported.",                  "ACPI_SUPPORTED");                                                                                                   // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("USB Legacy is supported.",            "USB_LEGACY_SUPPORTED");                                                                                             // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("AGP is supported.",                   "AGP_SUPPORTED");                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("I2O boot is supported.",              "I2O_BOOT_SUPPORTED");                                                                                               // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("LS-120 SuperDisk boot is supported.", "LS120_BOOT_SUPPORTED");                                                                                             // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("ATAPI ZIP drive boot is supported.",  "ATAPI_ZIP_DRIVE_BOOT_SUPPORTED");                                                                                   // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("1394 boot is supported.",             "BOOT_1394_SUPPORTED");                                                                                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Smart battery is supported.",         "SMART_BATTERY_SUPPORTED");                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList flagsLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        flagsLines.append("typedef good_U8 dmi_bios_characteristics_bios_reserved_flags;");                                                                                                                      // Colorize: green
        flagsLines.append("");                                                                                                                                                                 // Colorize: green
        flagsLines.append("enum class DmiBiosCharacteristicsBiosReservedFlag: dmi_bios_characteristics_bios_reserved_flags");                                                                                            // Colorize: green
        flagsLines.append("{");                                                                                                                                                                // Colorize: green
        flagsLines.append("    NONE                           = 0,");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            flagsLines.append(QString("    %1 = (1ULL << %2)%3 // %4")                                                                                                                                             // Colorize: green
                                                .arg(field, -30, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(bits.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        flagsLines.append("};");                                                                                                                                                                  // Colorize: green
        flagsLines.append("");                                                                                                                                                                    // Colorize: green
        flagsLines.append("DEFINE_FLAGS(DmiBiosCharacteristicsBiosReservedFlags, dmi_bios_characteristics_bios_reserved_flags); // TEST: NO");                                                                                                       // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(flagsLines, thread->getPath() + "/" + DMI_BIOS_CHARACTERISTICS_BIOS_RESERVED_FLAGS_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS Characteristics BIOS Reserved with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosCharacteristicsSystemReserved(SpecVerifyThread *thread, const QString &specContent)                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString flagsText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init flagsText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsText =                                                                                                                                                                                       // Colorize: green
            "BIOS Characteristics Extension Byte 2\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "948\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.1.2.2\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "949\n"                                                                                                                                                                                      // Colorize: green
            "950\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 9 shows the BIOS Characteristics for Extension Byte 2 layout. This information, available for\n"                                                                                      // Colorize: green
            "SMBIOS version 2.3 and later, appears at offset 13h within the BIOS Information structure.\n"                                                                                               // Colorize: green
            "Table 9  BIOS Characteristics Extension Byte 2\n"                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "951\n"                                                                                                                                                                                      // Colorize: green
            "Byte Bit Position\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning If Set\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 0\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BIOS Boot Specification is supported.\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 1\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Function key-initiated network service boot is supported. When function key-uninitiated\n"                                                                                                  // Colorize: green
            "network service boot is not supported, a network adapter option ROM may choose to offer\n"                                                                                                  // Colorize: green
            "this functionality on its own, thus offering this capability to legacy systems. When the\n"                                                                                                 // Colorize: green
            "function is supported, the network adapter option ROM shall not offer this capability.\n"                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Enable targeted content distribution. The manufacturer has ensured that the SMBIOS data\n"                                                                                                  // Colorize: green
            "is useful in identifying the computer for targeted delivery of model-specific software and\n"                                                                                               // Colorize: green
            "firmware content through third-party content distribution services.\n"                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 3\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "UEFI Specification is supported.\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit 4\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SMBIOS table describes a virtual machine. (If this bit is not set, no inference can be made\n"                                                                                              // Colorize: green
            "about the virtuality of the system.)\n"                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 5:7\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved for future assignment by this specification.";                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(flagsText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS Characteristics System Reserved specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = flagsText.split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(11) != "Table 9  BIOS Characteristics Extension Byte 2"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(12) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(13) != "951"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(14) != "Byte Bit Position"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(15) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(16) != "Meaning If Set"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(17) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI BIOS Characteristics System Reserved specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 18;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString bit = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (bit.startsWith("Bit "))                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bit.remove(0, 4);                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bits.append(bit);                                                                                                                                                                        // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("BIOS Boot Specification is supported.",                                                                                                                                                                                                                                                                                                                           "BIOS_BOOT_SPECIFICATION_SUPPORTED"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Function key-initiated network service boot is supported. When function key-uninitiated network service boot is not supported, a network adapter option ROM may choose to offer this functionality on its own, thus offering this capability to legacy systems. When the function is supported, the network adapter option ROM shall not offer this capability.", "FUNCTION_KEY_NETWORK_BOOT_SUPPORTED"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Enable targeted content distribution. The manufacturer has ensured that the SMBIOS data is useful in identifying the computer for targeted delivery of model-specific software and firmware content through third-party content distribution services.",                                                                                                          "TARGET_CONTENT_DISTRIBUTION_ENABLED"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("UEFI Specification is supported.",                                                                                                                                                                                                                                                                                                                                "UEFI_SPECIFICATION_SUPPORTED"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("SMBIOS table describes a virtual machine. (If this bit is not set, no inference can be made about the virtuality of the system.)",                                                                                                                                                                                                                                "VIRTUAL_MACHINE_SUPPORTED"); // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList flagsLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        flagsLines.append("typedef good_U8 dmi_bios_characteristics_system_reserved_flags;");                                                                                                                      // Colorize: green
        flagsLines.append("");                                                                                                                                                                 // Colorize: green
        flagsLines.append("enum class DmiBiosCharacteristicsSystemReservedFlag: dmi_bios_characteristics_system_reserved_flags");                                                                                            // Colorize: green
        flagsLines.append("{");                                                                                                                                                                // Colorize: green
        flagsLines.append("    NONE                                = 0,");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            flagsLines.append(QString("    %1 = (1ULL << %2)%3 // %4")                                                                                                                                             // Colorize: green
                                                .arg(field, -35, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(bits.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        flagsLines.append("};");                                                                                                                                                                  // Colorize: green
        flagsLines.append("");                                                                                                                                                                    // Colorize: green
        flagsLines.append("DEFINE_FLAGS(DmiBiosCharacteristicsSystemReservedFlags, dmi_bios_characteristics_system_reserved_flags); // TEST: NO");                                                                                                       // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(flagsLines, thread->getPath() + "/" + DMI_BIOS_CHARACTERISTICS_SYSTEM_RESERVED_FLAGS_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS Characteristics System Reserved with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosExtendedRomSize(SpecVerifyThread *thread, const QString &specContent)                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sizeText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sizeText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sizeText =                                                                                                                                                                                       // Colorize: green
            "Extended size of the physical device(s)\n"                                                                                                                                                  // Colorize: green
            "containing the BIOS, rounded up if needed.\n"                                                                                                                                               // Colorize: green
            "Bits 15:14\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unit\n"                                                                                                                                                                                     // Colorize: green
            "00b - megabytes\n"                                                                                                                                                                          // Colorize: green
            "01b - gigabytes\n"                                                                                                                                                                          // Colorize: green
            "10b - reserved\n"                                                                                                                                                                           // Colorize: green
            "11b - reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 13:0\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Examples: a 16 MB device would be\n"                                                                                                                                                        // Colorize: green
            "represented as 0010h. A 48 GB device set\n"                                                                                                                                                 // Colorize: green
            "would be represented as\n"                                                                                                                                                                  // Colorize: green
            "0100_0000_0011_0000b or 4030h.";                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sizeText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS Extended ROM Size specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sizeLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sizeLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        sizeLines.append("struct DmiBiosExtendedRomSize");                                                                                                                                               // Colorize: green
        sizeLines.append("{");                                                                                                                                                                           // Colorize: green
        sizeLines.append("    inline good_U64 size() const");                                                                                                                                            // Colorize: green
        sizeLines.append("    {");                                                                                                                                                                       // Colorize: green
        sizeLines.append("        // COMMON_LT((\"\")); // Commented to avoid too frequent logs");                                                                                                       // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("        switch (unit)");                                                                                                                                                       // Colorize: green
        sizeLines.append("        {");                                                                                                                                                                   // Colorize: green
        sizeLines.append("            case DmiBiosExtendedRomSizeUnit::MEGABYTES: return static_cast<good_U64>(value) * MB;");                                                                           // Colorize: green
        sizeLines.append("            case DmiBiosExtendedRomSizeUnit::GIGABYTES: return static_cast<good_U64>(value) * GB;");                                                                           // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("            default:");                                                                                                                                                        // Colorize: green
        sizeLines.append("            {");                                                                                                                                                               // Colorize: green
        sizeLines.append("                COMMON_LF((\"Unknown BIOS extended rom size unit %s, %s:%u\", enumToFullString(unit), __FILE__, __LINE__));");                                                 // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("                return 0;");                                                                                                                                                   // Colorize: green
        sizeLines.append("            }");                                                                                                                                                               // Colorize: green
        sizeLines.append("            break;");                                                                                                                                                          // Colorize: green
        sizeLines.append("        }");                                                                                                                                                                   // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("        return value;");                                                                                                                                                       // Colorize: green
        sizeLines.append("    }");                                                                                                                                                                       // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("    union");                                                                                                                                                                   // Colorize: green
        sizeLines.append("    {");                                                                                                                                                                       // Colorize: green
        sizeLines.append("        struct");                                                                                                                                                              // Colorize: green
        sizeLines.append("        {");                                                                                                                                                                   // Colorize: green
        sizeLines.append("            good_U16                   value: 14;");                                                                                                                           // Colorize: green
        sizeLines.append("            DmiBiosExtendedRomSizeUnit unit:  2;");                                                                                                                            // Colorize: green
        sizeLines.append("        };");                                                                                                                                                                  // Colorize: green
        sizeLines.append("");                                                                                                                                                                            // Colorize: green
        sizeLines.append("        good_U16 value16;");                                                                                                                                                   // Colorize: green
        sizeLines.append("    };");                                                                                                                                                                      // Colorize: green
        sizeLines.append("} __attribute__((packed));");                                                                                                                                                  // Colorize: green
        sizeLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sizeLines, thread->getPath() + "/" + DMI_BIOS_EXTENDED_ROM_SIZE_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS Extended ROM Size with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBiosExtendedRomSizeUnit(SpecVerifyThread *thread, const QString &specContent)                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString unitText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init unitText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        unitText =                                                                                                                                                                                       // Colorize: green
            "Extended size of the physical device(s)\n"                                                                                                                                                  // Colorize: green
            "containing the BIOS, rounded up if needed.\n"                                                                                                                                               // Colorize: green
            "Bits 15:14\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unit\n"                                                                                                                                                                                     // Colorize: green
            "00b - megabytes\n"                                                                                                                                                                          // Colorize: green
            "01b - gigabytes\n"                                                                                                                                                                          // Colorize: green
            "10b - reserved\n"                                                                                                                                                                           // Colorize: green
            "11b - reserved\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bits 13:0\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Examples: a 16 MB device would be\n"                                                                                                                                                        // Colorize: green
            "represented as 0010h. A 48 GB device set\n"                                                                                                                                                 // Colorize: green
            "would be represented as\n"                                                                                                                                                                  // Colorize: green
            "0100_0000_0011_0000b or 4030h.";                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(unitText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI BIOS Extended ROM Size Unit specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList unitLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        unitLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        unitLines.append("enum class DmiBiosExtendedRomSizeUnit: good_U16");                                                                                                                             // Colorize: green
        unitLines.append("{");                                                                                                                                                                           // Colorize: green
        unitLines.append("    MEGABYTES = 0,");                                                                                                                                                          // Colorize: green
        unitLines.append("    GIGABYTES = 1");                                                                                                                                                           // Colorize: green
        unitLines.append("};");                                                                                                                                                                          // Colorize: green
        unitLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(unitLines, thread->getPath() + "/" + DMI_BIOS_EXTENDED_ROM_SIZE_UNIT_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI BIOS Extended ROM Size Unit with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiSystemEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString entryText1;                                                                                                                                                                                  // Colorize: green
    QString entryText2;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init entryText1 and entryText2                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryText1 =                                                                                                                                                                                     // Colorize: green
            "952\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.2\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "953\n"                                                                                                                                                                                      // Colorize: green
            "954\n"                                                                                                                                                                                      // Colorize: green
            "955\n"                                                                                                                                                                                      // Colorize: green
            "956\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The information in this structure defines attributes of the overall system and is intended to be associated\n"                                                                              // Colorize: green
            "with the Component ID group of the system's MIF. An SMBIOS implementation is associated with a single\n"                                                                                    // Colorize: green
            "system instance and contains one and only one System Information (Type 1) structure. Table 10 shows\n"                                                                                      // Colorize: green
            "the contents of this structure.\n"                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "36\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System Information (Type 1)\n"                                                                                                                                                              // Colorize: green
            "";                                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText2 =                                                                                                                                                                                     // Colorize: green
            "Table 10  System Information (Type 1) structure\n"                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "957\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Spec.\n"                                                                                                                                                                                    // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System Information indicator\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h or\n"                                                                                                                                                                                   // Colorize: green
            "19h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length dependent on version supported:\n"                                                                                                                                                   // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h for 2.0\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "19h for 2.1  2.3.4\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1Bh for 2.4 and later\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Manufacturer\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Product Name\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "07h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.0+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Serial Number\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.1+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "UUID\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16 BYTEs\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Universal unique ID number; see 7.2.1.\n"                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "18h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.1+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Wake-up\n"                                                                                                                                                                                  // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ENUM\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Identifies the event that caused the system to\n"                                                                                                                                           // Colorize: green
            "power up. See 7.2.2.\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "19h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SKU Number\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "This text string identifies a particular computer\n"                                                                                                                                        // Colorize: green
            "configuration for sale. It is sometimes also\n"                                                                                                                                             // Colorize: green
            "called a product ID or purchase order number.\n"                                                                                                                                            // Colorize: green
            "This number is frequently found in existing\n"                                                                                                                                              // Colorize: green
            "fields, but there is no standard format.\n"                                                                                                                                                 // Colorize: green
            "Typically for a given system board from a\n"                                                                                                                                                // Colorize: green
            "given OEM, there are tens of unique\n"                                                                                                                                                      // Colorize: green
            "processor, memory, hard drive, and optical\n"                                                                                                                                               // Colorize: green
            "drive configurations.\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1Ah\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2.4+\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Family\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "This text string identifies the family to which a\n"                                                                                                                                        // Colorize: green
            "particular computer belongs. A family refers to\n"                                                                                                                                          // Colorize: green
            "a set of computers that are similar but not\n"                                                                                                                                              // Colorize: green
            "identical from a hardware or software point of\n"                                                                                                                                           // Colorize: green
            "view. Typically, a family is composed of\n"                                                                                                                                                 // Colorize: green
            "different computer models, which have\n"                                                                                                                                                    // Colorize: green
            "different configurations and pricing points.\n"                                                                                                                                             // Colorize: green
            "Computers in the same family often have\n"                                                                                                                                                  // Colorize: green
            "similar branding and cosmetic features.";                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(entryText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI System entry specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (entryText1 + '\n' + entryText2).split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(70) != "02h"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(71) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(72) != "2.0+"                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(73) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(74) != "Handle"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(75) != ""                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(76) != "WORD"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(77) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(78) != "Varies"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(79) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI System entry specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 80;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList        versionGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> nameGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> typeGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> descriptionGroups;                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QString     lastVersion;                                                                                                                                                                      // Colorize: green
        QStringList fieldNames;                                                                                                                                                                              // Colorize: green
        QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
        QStringList fieldDescriptions;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (offset == "Offset")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 13;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                offset = lines.at(i);                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString version = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                name.append(' ');                                                                                                                                                                 // Colorize: green
                name.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                type.append(' ');                                                                                                                                                                 // Colorize: green
                type.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1)                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString nextLine = lines.at(i + 1);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (nextLine == "")                                                                                                                                                                      // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString nextLine2 = i < lines.size() - 2 ? lines.at(i + 2) : "";                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2.length() == 3 && nextLine2.endsWith('h'))                                                                                                                              // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2 == "Offset")                                                                                                                                                           // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(nextLine);                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "BYTE" && value == "STRING")                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                type = "DmiStringId";                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill groups                                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                if (version != lastVersion)                                                                                                                                                                  // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    if (lastVersion != "")                                                                                                                                                                   // Colorize: green
                    {                                                                                                                                                                                        // Colorize: green
                        versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
                        nameGroups.append(fieldNames);                                                                                                                                                       // Colorize: green
                        typeGroups.append(fieldTypes);                                                                                                                                                       // Colorize: green
                        descriptionGroups.append(fieldDescriptions);                                                                                                                                         // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                        fieldNames.clear();                                                                                                                                                                  // Colorize: green
                        fieldTypes.clear();                                                                                                                                                                  // Colorize: green
                        fieldDescriptions.clear();                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    lastVersion = version;                                                                                                                                                                   // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                fieldNames.append(name);                                                                                                                                                                     // Colorize: green
                fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
                fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Add last group                                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            versionGroups.append('V' + lastVersion.remove('.').remove('+'));                                                                                                                 // Colorize: green
            nameGroups.append(fieldNames);                                                                                                                                                               // Colorize: green
            typeGroups.append(fieldTypes);                                                                                                                                                               // Colorize: green
            descriptionGroups.append(fieldDescriptions);                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Manufacturer",  "manufacturer");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Product Name",  "productName");                                                                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Version",       "version");                                                                                                                                // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Serial Number", "serialNumber");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("UUID",          "uuid");                                                                                                                                   // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Wake-up Type",  "wakeUpType");                                                                                                                             // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("SKU Number",    "skuNumber");                                                                                                                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Family",        "family");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    const QList<qint64> typeAlignment = { 14, 19, 11 };                                                                                                                                                             // Colorize: green
    const QList<qint64> nameAlignment = { 12, 10, 9  };                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList entryLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < versionGroups.size(); ++i)                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const QStringList &fieldNames        = nameGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldTypes        = typeGroups.at(i);                                                                                                                                                                              // Colorize: green
            const QStringList &fieldDescriptions = descriptionGroups.at(i);                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (i > 0)                                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
                entryLines.append("");                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            entryLines.append(QString("struct DmiSystemEntry%1")                                                                                                                                          // Colorize: green
                                        .arg(i > 0 ? (versionGroups.at(i) + ": public DmiSystemEntry" + (i > 1 ? versionGroups.at(i - 1) : "")) : "")                                                                     // Colorize: green
            );                                                                                                                                                   // Colorize: green
            entryLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            for (qint64 j = 0; j < fieldNames.size(); ++j)                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                                // Colorize: green
                QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(j), fieldTypes.at(j));                                                                                                                            // Colorize: green
                QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(j), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                if (name == "")                                                                                                                                                                              // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                                .arg(fieldNames.at(j))                                                                                                                                              // Colorize: green
                    );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                    return;                                                                                                                                                                                  // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                entryLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                            .arg(type, -typeAlignment.at(i), QChar(' '))                                                                                                                                      // Colorize: green
                                            .arg(name)                                                                                                                                                       // Colorize: green
                                            .arg("", nameAlignment.at(i) - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                            .arg(fieldDescriptions.at(j))                                                                                                                                    // Colorize: green
                );                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                             // Colorize: green
            entryLines.append("} __attribute__((packed));");                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.insert(3, "    DmiEntryHeader header;");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.replaceInStrings("    16 BYTEs            uuid;",       "    Uuid                uuid;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U8             wakeUpType;", "    DmiSystemWakeUpType wakeUpType;");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(entryLines, thread->getPath() + "/" + DMI_SYSTEM_ENTRY_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI System entry with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiSystemWakeUpType(SpecVerifyThread *thread, const QString &specContent)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString enumText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init enumText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        enumText =                                                                                                                                                                                       // Colorize: green
            "973\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.2.2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "974\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 12 shows what the byte values mean for the System - Wake-up Type field.\n"                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System - Wake-up Type\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 12  System: Wake-up Type field\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "975\n"                                                                                                                                                                                      // Colorize: green
            "Byte Value\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Other\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unknown\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "03h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "APM Timer\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Modem Ring\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "LAN Remote\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Power Switch\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "07h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PCI PME#\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "AC Power Restored";                                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(enumText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI System Wake-up Type specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = enumText.split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(10) != "Table 12  System: Wake-up Type field"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(11) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(12) != "975"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(13) != "Byte Value"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(14) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(15) != "Meaning"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(16) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI System Wake-up Type specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 17;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value.endsWith('h'))                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value.remove(value.length() - 1, 1);                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                value = QString::number(value.toULongLong(nullptr, 16));                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                values.append(value);                                                                                                                                                                        // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Other",             "OTHER");                                                                                                                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Unknown",           "UNKNOWN");                                                                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("APM Timer",         "APM_TIMER");                                                                                                                          // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Modem Ring",        "MODEM_RING");                                                                                                                         // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("LAN Remote",        "LAN_REMOTE");                                                                                                                         // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Power Switch",      "POWER_SWITCH");                                                                                                                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("PCI PME#",          "PCI_PME");                                                                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("AC Power Restored", "AC_POWER_RESTORED");                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList enumLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        enumLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        enumLines.append("enum class DmiSystemWakeUpType: good_U8");                                                                                                                                     // Colorize: green
        enumLines.append("{");                                                                                                                                                                           // Colorize: green
        enumLines.append("    NONE              = 0,");                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            enumLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                             // Colorize: green
                                                .arg(field, -17, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(values.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        enumLines.append("};");                                                                                                                                                                  // Colorize: green
        enumLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(enumLines, thread->getPath() + "/" + DMI_SYSTEM_WAKE_UP_TYPE_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI System Wake-up Type specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBaseboardEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString entryText1;                                                                                                                                                                                  // Colorize: green
    QString entryText2;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init entryText1 and entryText2                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryText1 =                                                                                                                                                                                     // Colorize: green
            "976\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.3\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "977\n"                                                                                                                                                                                      // Colorize: green
            "978\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "As shown in Table 13, the information in this structure defines attributes of a system baseboard (for\n"                                                                                    // Colorize: green
            "example, a motherboard, planar, server blade, or other standard system module).\n"                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "979\n"                                                                                                                                                                                      // Colorize: green
            "980\n"                                                                                                                                                                                      // Colorize: green
            "981\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "38\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Baseboard (or Module) Information (Type 2)\n"                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "If more than one Type 2 structure is provided by an SMBIOS implementation, each structure shall include\n"                                                                                  // Colorize: green
            "the Number of Contained Object Handles and Contained Object Handles fields to specify which system\n"                                                                                       // Colorize: green
            "elements are contained on which boards. If a single Type 2 structure is provided and the contained object\n"                                                                                // Colorize: green
            "";                                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryText2 =                                                                                                                                                                                     // Colorize: green
            "information is not present1, or if no Type 2 structure is provided, all system elements identified by the\n"                                                                                // Colorize: green
            "SMBIOS implementation are associated with a single motherboard.\n"                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "982\n"                                                                                                                                                                                      // Colorize: green
            "983\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 13  Baseboard (or Module) Information (Type 2) structure\n"                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "984\n"                                                                                                                                                                                      // Colorize: green
            "Offset\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "00h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Baseboard Information indicator\n"                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Length of the structure, at least 08h\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Manufacturer\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Product\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Version\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "07h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Serial\n"                                                                                                                                                                                   // Colorize: green
            "Number\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of null-terminated string\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Asset Tag\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of a null-terminated string\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "09h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Feature Flags\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Bit Field\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Collection of flags that identify features of this baseboard;\n"                                                                                                                            // Colorize: green
            "see 7.3.1\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Ah\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Location in\n"                                                                                                                                                                              // Colorize: green
            "Chassis\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STRING\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of a null-terminated string that describes this\n"                                                                                                                                   // Colorize: green
            "board's location within the chassis referenced by the\n"                                                                                                                                    // Colorize: green
            "Chassis Handle (described below in this table)\n"                                                                                                                                           // Colorize: green
            "NOTE: This field supports a CIM_Container class mapping where:\n"                                                                                                                           // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "LocationWithinContainer is this field.\n"                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "GroupComponent is the chassis referenced by Chassis\n"                                                                                                                                      // Colorize: green
            "Handle.\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "*\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PartComponent is this baseboard.\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Bh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Chassis\n"                                                                                                                                                                                  // Colorize: green
            "Handle\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "WORD\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Handle, or instance number, associated with the chassis in\n"                                                                                                                               // Colorize: green
            "which this board resides (see 7.4)\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Dh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Board Type\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ENUM\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type of board (see 7.3.2)\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Eh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of\n"                                                                                                                                                                                // Colorize: green
            "Contained\n"                                                                                                                                                                                // Colorize: green
            "Object\n"                                                                                                                                                                                   // Colorize: green
            "Handles (n)\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "BYTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number (0 to 255) of Contained Object Handles that follow\n"                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Fh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contained\n"                                                                                                                                                                                // Colorize: green
            "Object\n"                                                                                                                                                                                   // Colorize: green
            "Handles\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "n\n"                                                                                                                                                                                        // Colorize: green
            "WORDs\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Varies\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "List of handles of other structures (for example, Baseboard,\n"                                                                                                                             // Colorize: green
            "Processor, Port, System Slots, Memory Device) that are\n"                                                                                                                                   // Colorize: green
            "contained by this baseboard";                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(entryText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(entryText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI Baseboard entry specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (entryText1 + '\n' + entryText2).split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(63) != "02h"                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(64) != ""                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(65) != "Handle"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(66) != ""                                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(67) != "WORD"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(68) != ""                                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(69) != "Varies"                                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(70) != ""                                                                                                                                                                           // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI Baseboard entry specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 71;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldDescriptions;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString offset = lines.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                name.append(' ');                                                                                                                                                                 // Colorize: green
                name.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString type = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                type.append(' ');                                                                                                                                                                 // Colorize: green
                type.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1)                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                QString nextLine = lines.at(i + 1);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (nextLine == "")                                                                                                                                                                      // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString nextLine2 = i < lines.size() - 2 ? lines.at(i + 2) : "";                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (nextLine2.length() == 3 && nextLine2.endsWith('h'))                                                                                                                              // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(nextLine);                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "BYTE" && value == "STRING")                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                type = "DmiStringId";                                                                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(name);                                                                                                                                                                     // Colorize: green
            fieldTypes.append(type);                                                                                                                                                                     // Colorize: green
            fieldDescriptions.append(description);                                                                                                                                                       // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Manufacturer",                           "manufacturer");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Product",                                "product");                                                                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Version",                                "version");                                                                                                                                // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Serial Number",                          "serialNumber");                                                                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Asset Tag",                              "assetTag");                                                                                                                                   // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Feature Flags",                          "featureFlags");                                                                                                                             // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Location in Chassis",                    "locationInChassis");                                                                                                                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Chassis Handle",                         "chassisHandle");                                                                                                                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Board Type",                             "boardType");                                                                                                                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Number of Contained Object Handles (n)", "numberOfContainedObjectHandles");                                                                                                                                 // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Contained Object Handles",               "containedObjectHandles");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList entryLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        entryLines.append("struct DmiBaseboardEntry");                                                                                                                                                   // Colorize: green
        entryLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldNames.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mDmiTypeToNgosTypeMap.value(fieldTypes.at(i), fieldTypes.at(i));                                                                                                                            // Colorize: green
            QString name = dmiFieldNamesToNgosFieldNames.value(fieldNames.at(i), "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldNames.at(i))                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            entryLines.append(QString("    %1 %2;%3 // %4")                                                                                                                                             // Colorize: green
                                        .arg(type, -24, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(name)                                                                                                                                                       // Colorize: green
                                        .arg("", 30 - name.length(), QChar(' '))                                                                                                                          // Colorize: green
                                        .arg(fieldDescriptions.at(i))                                                                                                                                    // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        entryLines.append("} __attribute__((packed));");                                                                                                                                                                                                // Colorize: green
        entryLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.insert(3, "    DmiEntryHeader           header;");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        entryLines.replaceInStrings("    good_U8                  featureFlags;",              "    DmiBaseboardFeatureFlags featureFlags;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    good_U8                  boardType;",                 "    DmiBaseboardType         boardType;");                                                                                                                // Colorize: green
        entryLines.replaceInStrings("    n WORDs                  containedObjectHandles;   ", "    good_U16                 containedObjectHandles[0];");                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(entryLines, thread->getPath() + "/" + DMI_BASEBOARD_ENTRY_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI Baseboard entry with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBaseboardFeatureFlags(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString flagsText1;                                                                                                                                                                                  // Colorize: green
    QString flagsText2;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init flagsText1 and flagsText2                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsText1 =                                                                                                                                                                                     // Colorize: green
            "Baseboard - feature flags\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "985\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.3.1\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "986\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 14 shows the baseboard feature flags.\n"                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "987\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Refer to 6.3 for the CIM properties associated with these bit fields.\n"                                                                                                                    // Colorize: green
            "";                                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        flagsText2 =                                                                                                                                                                                     // Colorize: green
            "Table 14  Baseboard: feature flags\n"                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "988\n"                                                                                                                                                                                      // Colorize: green
            "Bit Position(s)\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7:5\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved for future definition by this specification; set to 000b.\n"                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Set to 1 if the board is hot swappable; it is possible to replace the board with a physically\n"                                                                                            // Colorize: green
            "different but equivalent board while power is applied to the board. The board is inherently\n"                                                                                              // Colorize: green
            "replaceable and removable.\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Set to 1 if the board is replaceable; it is possible to replace (either as a field repair or as an\n"                                                                                       // Colorize: green
            "upgrade) the board with a physically different board. The board is inherently removable.\n"                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Set to 1 if the board is removable; it is designed to be taken in and out of the chassis without\n"                                                                                         // Colorize: green
            "impairing the function of the chassis.\n"                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Set to 1 if the board requires at least one daughter board or auxiliary card to function\n"                                                                                                 // Colorize: green
            "properly.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Set to 1 if the board is a hosting board (for example, a motherboard).";                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(flagsText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(flagsText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI Baseboard Feature Flags specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (flagsText1 + '\n' + flagsText2).split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(16) != "Table 14  Baseboard: feature flags"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(17) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(18) != "988"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(19) != "Bit Position(s)"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(20) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(21) != "Description"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(22) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI Baseboard Feature Flags specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 23;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList bits;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString bit = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                bits.prepend(bit);                                                                                                                                                                        // Colorize: green
                fields.prepend(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Set to 1 if the board is a hosting board (for example, a motherboard).",                                                                                                                                               "MOTHERBOARD"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Set to 1 if the board requires at least one daughter board or auxiliary card to function properly.",                                                                                                                   "REQUIRES_DAUGHTER_CARD"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Set to 1 if the board is removable; it is designed to be taken in and out of the chassis without impairing the function of the chassis.",                                                                              "REMOVABLE"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Set to 1 if the board is replaceable; it is possible to replace (either as a field repair or as an upgrade) the board with a physically different board. The board is inherently removable.",                          "REPLACEABLE"); // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Set to 1 if the board is hot swappable; it is possible to replace the board with a physically different but equivalent board while power is applied to the board. The board is inherently replaceable and removable.", "HOT_SWAPPABLE"); // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList flagsLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        flagsLines.append("typedef good_U8 dmi_baseboard_feature_flags;");                                                                                                                      // Colorize: green
        flagsLines.append("");                                                                                                                                                                 // Colorize: green
        flagsLines.append("enum class DmiBaseboardFeatureFlag: dmi_baseboard_feature_flags");                                                                                            // Colorize: green
        flagsLines.append("{");                                                                                                                                                                // Colorize: green
        flagsLines.append("    NONE                   = 0,");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            flagsLines.append(QString("    %1 = (1ULL << %2)%3 // %4")                                                                                                                                             // Colorize: green
                                                .arg(field, -22, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(bits.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        flagsLines.append("};");                                                                                                                                                                  // Colorize: green
        flagsLines.append("");                                                                                                                                                                    // Colorize: green
        flagsLines.append("DEFINE_FLAGS(DmiBaseboardFeatureFlags, dmi_baseboard_feature_flags); // TEST: NO");                                                                                                       // Colorize: green
        flagsLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(flagsLines, thread->getPath() + "/" + DMI_BASEBOARD_FEATURE_FLAGS_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI Baseboard Feature Flags with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiBaseboardType(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString enumText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init enumText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        enumText =                                                                                                                                                                                       // Colorize: green
            "Baseboard - Board Type\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "989\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.3.2\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "990\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 15 shows the byte values for the Baseboard - Board Type field.\n"                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "991\n"                                                                                                                                                                                      // Colorize: green
            "992\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NOTE\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "These enumerations are also used within the System Enclosure or Chassis (Type 3) structure's Contained\n"                                                                                   // Colorize: green
            "Element record (see 7.4).\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 15  Baseboard: Board Type\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "993\n"                                                                                                                                                                                      // Colorize: green
            "Byte Value\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "01h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unknown\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "02h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Other\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "03h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Server Blade\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "04h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Connectivity Switch\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "05h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System Management Module\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "06h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor Module\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "07h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "I/O Module\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "08h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Memory Module\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "09h\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Daughter board\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Ah\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Motherboard (includes processor, memory, and I/O)\n"                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Bh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor/Memory Module\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Ch\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor/IO Module\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0Dh\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Interconnect board";                                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(enumText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("DMI Baseboard Type specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = enumText.split('\n');                                                                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            lines.at(18) != "Table 15  Baseboard: Board Type"                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(19) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(20) != "993"                                                                                                                                                                         // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(21) != "Byte Value"                                                                                                                                                          // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(22) != ""                                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(23) != "Meaning"                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(24) != ""                                                                                                                                                                            // Colorize: green
           )                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse DMI Baseboard Type specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 25;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString value = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value.endsWith('h'))                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value.remove(value.length() - 1, 1);                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                value = QString::number(value.toULongLong(nullptr, 16));                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!description.contains("Reserved"))                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                values.append(value);                                                                                                                                                                        // Colorize: green
                fields.append(description);                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> dmiFieldNamesToNgosFieldNames; // DMI field name => NGOS field name                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill dmiFieldNamesToNgosFieldNames                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Unknown",                                           "UNKNOWN");                                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Other",                                             "OTHER");                                                                                              // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Server Blade",                                      "SERVER_BLADE");                                                                                       // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Connectivity Switch",                               "CONNECTIVITY_SWITCH");                                                                                // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("System Management Module",                          "SYSTEM_MANAGEMENT_MODULE");                                                                           // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Processor Module",                                  "PROCESSOR_MODULE");                                                                                   // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("I/O Module",                                        "IO_MODULE");                                                                                          // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Memory Module",                                     "MEMORY_MODULE");                                                                                      // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Daughter board",                                    "DAUGHTER_BOARD");                                                                                     // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Motherboard (includes processor, memory, and I/O)", "MOTHERBOARD");                                                                                        // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Processor/Memory Module",                           "PROCESSOR_MEMORY_MODULE");                                                                            // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Processor/IO Module",                               "PROCESSOR_IO_MODULE");                                                                                // Colorize: green
        dmiFieldNamesToNgosFieldNames.insert("Interconnect board",                                "INTERCONNECT_BOARD");                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList enumLines;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        enumLines.append(QString("// Verified with DmiSpecVerifier [BEGIN] // %1")                                                                                                                       // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        enumLines.append("enum class DmiBaseboardType: good_U8");                                                                                                                                     // Colorize: green
        enumLines.append("{");                                                                                                                                                                           // Colorize: green
        enumLines.append("    NONE                     = 0,");                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = dmiFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert DMI field name: %1")                                                                                                                               // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                        // Colorize: green
            enumLines.append(QString("    %1 = %2%3%4 // %5")                                                                                                                                             // Colorize: green
                                                .arg(field, -24, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(values.at(i))                                                                                                                                         // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                                .arg("", 2 - values.at(i).length(), QChar(' '))                                                                                                                // Colorize: green
                                                .arg(fields.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        enumLines.append("};");                                                                                                                                                                  // Colorize: green
        enumLines.append(QString("// Verified with DmiSpecVerifier [END] // %1")                                                                                                                         // Colorize: green
                                    .arg(DMI_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(enumLines, thread->getPath() + "/" + DMI_BASEBOARD_TYPE_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check DMI Baseboard Type specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisTypeAndLocked(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisType(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisState(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisSecurityStatus(SpecVerifyThread *thread, const QString &specContent)                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisContainedElement(SpecVerifyThread *thread, const QString &specContent)                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisContainedElementType(SpecVerifyThread *thread, const QString &specContent)                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void DmiSpecVerifier::checkDmiChassisContainedElementTypeSelect(SpecVerifyThread *thread, const QString &specContent)                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DmiSpecVerifier dmiSpecVerifierInstance;                                                                                                                                                                 // Colorize: green
