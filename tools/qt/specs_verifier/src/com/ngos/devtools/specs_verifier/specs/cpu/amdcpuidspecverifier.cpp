#include "amdcpuidspecverifier.h"                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define AMD_SPECIFICATION_URL "https://www.amd.com/system/files/TechDocs/24594.pdf" // Version: 3.33 November 2021                                                                                                           // Colorize: green
#define AMD_PDF               "amdcpuid.pdf"                                                                                                                                                             // Colorize: green
#define AMD_TXT               "amdcpuid.txt"                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define CPUID_VENDOR_H               "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuidvendor.h"                                                                                        // Colorize: green
#define CPUID80000000EAX_H           "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid80000000eax.h"                                                                                        // Colorize: green
#define CPUID_MODEL_NAME_H           "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuidmodelname.h"                                                                                        // Colorize: green
#define CPUID80000008EAX_H           "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid80000008eax.h"                                                                                        // Colorize: green
#define CPUID80000008ECX_H           "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/cpuid80000008ecx.h"                                                                                        // Colorize: green
#define CPUID_PERFORMANCE_TSC_SIZE_H "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuid/lib/cpuidperformancetscsize.h"                                                                                        // Colorize: green
#define CPUID_LEAF_H                 "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuidleaf.h"                                                                                        // Colorize: green
#define CPUID_SUBLEAF_H              "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/cpuidsubleaf.h"                                                                                        // Colorize: green
#define X86_FEATURE_H                "src/os/shared/common/src/com/ngos/shared/common/cpu/lib/x86feature.h"                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
AmdCpuidSpecVerifier::AmdCpuidSpecVerifier()                                                                                                                                                             // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // Nothing                                                                                                                                                                                           // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, AMD_SPECIFICATION_URL, specContent))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                            // Colorize: green
        specContent.replace(QChar(0x2014), '-');    // Replace em dash                      // https://www.compart.com/en/unicode/U+2014                                                                 // Colorize: green
        specContent.replace(QChar(0x2018), '\'');   // Replace left single quotation mark   // https://www.compart.com/en/unicode/U+2018                                                                 // Colorize: green
        specContent.replace(QChar(0x2019), '\'');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+2019                                                                 // Colorize: green
        specContent.replace(QChar(0x201C), '\"');   // Replace left double quotation mark   // https://www.compart.com/en/unicode/U+201C                                                                 // Colorize: green
        specContent.replace(QChar(0x201D), '\"');   // Replace right double quotation mark  // https://www.compart.com/en/unicode/U+201D                                                                 // Colorize: green
        specContent.replace(QChar(0x2122), "(TM)"); // Replace trade mark sign character    // https://www.compart.com/en/unicode/U+2122                                                                 // Colorize: green
    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool AmdCpuidSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for AMD CPUID specification");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get AMD CPUID specification from: %1")                                                                                                               // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + AMD_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for AMD CPUID specification");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << AMD_PDF << AMD_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + AMD_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open AMD CPUID specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkAmdSpecification(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidVendor(thread, specContent);                                                                                                                                                           // Colorize: green
        checkCpuid80000000Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidModelName(thread, specContent);                                                                                                                                                        // Colorize: green
        checkCpuid80000008Eax(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuid80000008Ecx(thread, specContent);                                                                                                                                                      // Colorize: green
        checkCpuidPerformanceTscSize(thread, specContent);                                                                                                                                               // Colorize: green
        checkCpuidLeaf(thread, specContent);                                                                                                                                                             // Colorize: green
        checkCpuidSubLeaf(thread, specContent);                                                                                                                                                          // Colorize: green
        checkX86Feature(thread, specContent);                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with AMD CPUID specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with AMD CPUID specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkAmdSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "AMD64 Technology\n"                                                                                                                                                                         // Colorize: green
            "AMD64 Architecture\n"                                                                                                                                                                       // Colorize: green
            "Programmer's Manual\n"                                                                                                                                                                      // Colorize: green
            "Volume 3:\n"                                                                                                                                                                                // Colorize: green
            "General-Purpose and\n"                                                                                                                                                                      // Colorize: green
            "System Instructions\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Publication No.\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Revision\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Date\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "24594\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3.33\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "November 2021";                                                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("AMD CPUID specification version didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuidVendor(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                    // Colorize: green
            "CPUID Fn0000_0000_E[D,C,B]X Processor Vendor\n"                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The values returned in EBX, EDX, and ECX together provide a 12-character string identifying the\n"                                                                                          // Colorize: green
            "vendor of this processor. Each register supplies 4 characters. The leftmost character of each substring";                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "AMD64 Technology\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "is stored in the least significant bit position in the register. The string is the concatenation of the\n"                                                                                  // Colorize: green
            "contents of EBX, EDX, and ECX in left to right order. No null terminator is included in the string.\n"                                                                                      // Colorize: green
            "CPUID Fn8000_0000_E[D,C,B]X return the same values as this function.\n"                                                                                                                     // Colorize: green
            "Bits Field Name\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31:0 Vendor\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Four characters of the 12-byte character string (encoded in ASCII)\n"                                                                                                                       // Colorize: green
            "\"AuthenticAMD\". See Table E-1 below.\n"                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table E-1. CPUID Fn0000_0000_E[D,C,B]X values\n"                                                                                                                                            // Colorize: green
            "Register\n"                                                                                                                                                                                 // Colorize: green
            "CPUID Fn0000_0000_EBX\n"                                                                                                                                                                    // Colorize: green
            "CPUID Fn0000_0000_ECX\n"                                                                                                                                                                    // Colorize: green
            "CPUID Fn0000_0000_EDX\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "6874_7541h\n"                                                                                                                                                                               // Colorize: green
            "444D_4163h\n"                                                                                                                                                                               // Colorize: green
            "6974_6E65h\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "The ASCII characters \"h t u A\".\n"                                                                                                                                                        // Colorize: green
            "The ASCII characters \"D M A c\".\n"                                                                                                                                                        // Colorize: green
            "The ASCII characters \"i t n e\".";                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Vendor specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                     // Colorize: green
            lines.at(18) != "Table E-1. CPUID Fn0000_0000_E[D,C,B]X values"                                                                                                    // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(19) != "Register"                                                                                                                                                           // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(20) != "CPUID Fn0000_0000_EBX"                                                                                                                                                                // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(21) != "CPUID Fn0000_0000_ECX"                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(22) != "CPUID Fn0000_0000_EDX"                                                                                                                                                                // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(23) != ""                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                               // Colorize: green
            lines.at(24) != "Value"                                                                                                                                                                // Colorize: green
           )                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID Vendor specification");                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 25;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList vendorLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        vendorLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                          // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 j = 0; j < 3; ++j)                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            qint64 index = i + j;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (j == 1)                                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++index;                                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (j == 2)                                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                --index;                                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString     hex   = lines.at(index).toUpper().remove('_').remove('H');                                                                                                                       // Colorize: green
            quint32     uint  = hex.toULongLong(nullptr, 16);                                                                                                                                            // Colorize: green
            good_Char8 *chars = reinterpret_cast<good_Char8 *>(&uint);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            vendorLines.append(QString("#define VENDOR_AMD_%1   0x%2   // %3%4%5%6")                                                                                                                       // Colorize: green
                                        .arg(j + 1)                                                                                                                                                      // Colorize: green
                                        .arg(hex, 8, QChar('0'))                                                                                                                                         // Colorize: green
                                        .arg(chars[0])                                                                                                                                                   // Colorize: green
                                        .arg(chars[1])                                                                                                                                                   // Colorize: green
                                        .arg(chars[2])                                                                                                                                                   // Colorize: green
                                        .arg(chars[3])                                                                                                                                                   // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        vendorLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(vendorLines, thread->getPath() + "/" + CPUID_VENDOR_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Vendor with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuid80000000Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "CPUID Fn8000_0000_EAX Largest Extended Function Number\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The value returned in EAX provides the largest extended function number supported by the processor.\n"                                                                                      // Colorize: green
            "Bits Field Name\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31:0 LFuncExt\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Largest extended function. The largest CPUID extended function input value\n"                                                                                                               // Colorize: green
            "supported by the processor implementation.";                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 80000000 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid80000000Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            CpuidLeaf largestFunction;");                                                                                                                                     // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID80000000EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 80000000 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuidModelName(SpecVerifyThread *thread, const QString &specContent)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "E.4.3 Functions 8000_0002h8000_0004h-Extended Processor Name String\n"                                                                                                                     // Colorize: green
            "CPUID Fn8000_000[4:2]_E[D,C,B,A]X Processor Name String Identifier\n"                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The three extended functions from Fn8000_0002 to Fn8000_0004 are programmed to return a null\n"                                                                                             // Colorize: green
            "terminated ASCII string up to 48 characters in length corresponding to the processor name.\n"                                                                                               // Colorize: green
            "Bits Field Name\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31:0 ProcName\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Four characters of the extended processor name string.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The 48 character maximum includes the terminating null character. The 48 character string is ordered\n"                                                                                     // Colorize: green
            "first to last (left to right) as follows:\n"                                                                                                                                                // Colorize: green
            "Fn8000_0002[EAX[7:0],..., EAX[31:24], EBX[7:0],..., EBX[31:24], ECX[7:0],...,\n"                                                                                                            // Colorize: green
            "ECX[31:24],EDX[7:0],..., EDX[31:24]],\n"                                                                                                                                                    // Colorize: green
            "Fn8000_0003[EAX[7:0],..., EAX[31:24], EBX[7:0],..., EBX[31:24], ECX[7:0],..., ECX[31:24],\n"                                                                                                // Colorize: green
            "EDX[7:0],..., EDX[31:24]],\n"                                                                                                                                                               // Colorize: green
            "Fn8000_0004[EAX[7:0],..., EAX[31:24], EBX[7:0],..., EBX[31:24], ECX[7:0],..., ECX[31:24],\n"                                                                                                // Colorize: green
            "EDX[7:0],..., EDX[31:24]].\n"                                                                                                                                                               // Colorize: green
            "The extended processor name string is programmed by system firmware. See your processor revision\n"                                                                                         // Colorize: green
            "guide for information about how to display the extended processor name string.";                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Model Name specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct CpuidModelName");                                                                                                                                                      // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 uints[12];");                                                                                                                                            // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_Char8 chars[48];");                                                                                                                                              // Colorize: green
        cpuidLines.append("    }; ");                                                                                                                                                                    // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_MODEL_NAME_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Model Name with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuid80000008Eax(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "CPUID Fn8000_0008_EAX Long Mode Size Identifiers\n"                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The value returned in EAX provides information about the maximum host and guest physical and\n"                                                                                             // Colorize: green
            "linear address width (in bits) supported by the processor.\n"                                                                                                                               // Colorize: green
            "Bits Field Name\n"                                                                                                                                                                          // Colorize: green
            "31:24 -\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "Reserved.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum guest physical address size in bits. This number applies only to guests\n"                                                                                                          // Colorize: green
            "using nested paging. When this field is zero, refer to the PhysAddrSize field for\n"                                                                                                        // Colorize: green
            "23:16 GuestPhysAddrSize\n"                                                                                                                                                                  // Colorize: green
            "the maximum guest physical address size. See \"Secure Virtual Machine\" in\n"                                                                                                                 // Colorize: green
            "APM2.\n"                                                                                                                                                                                    // Colorize: green
            "15:8 LinAddrSize\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum linear address size in bits.\n"                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7:0\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Maximum physical address size in bits. When GuestPhysAddrSize is zero, this\n"                                                                                                              // Colorize: green
            "field also indicates the maximum guest physical address size.\n"                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PhysAddrSize\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The address width reported is the maximum supported in any mode. For long mode capable processors, the size reported is independent of whether long mode is enabled. See \"Processor Initialization\n" // Colorize: green
            "and Long-Mode Activation\" in APM2.";                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 80000008 EAX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid80000008Eax");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32 physicalAddressBits:      8;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32 virtualAddressBits:       8;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32 guestPhysicalAddressBits: 8;");                                                                                                                          // Colorize: green
        cpuidLines.append("            good_U32 _reserved:                8;");                                                                                                                          // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID80000008EAX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 80000008 EAX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuid80000008Ecx(SpecVerifyThread *thread, const QString &specContent)                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText1;                                                                                                                                                                                 // Colorize: green
    QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText1 and cpuidText2                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText1 =                                                                                                                                                                                     // Colorize: green
            "CPUID Fn8000_0008_ECX Size Identifiers\n"                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The value returned in ECX provides information about the number of cores supported by the\n"                                                                                                // Colorize: green
            "processor, the width of the APIC ID, and the width of the performance time-stamp counter.";                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidText2 =                                                                                                                                                                                     // Colorize: green
            "Bits Field Name\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "24594-Rev. 3.33-November 2021\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "31:18 -\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "17:16 PerfTscSize\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Performance time-stamp counter size. Indicates the size of\n"                                                                                                                               // Colorize: green
            "MSRC001_0280[PTSC].\n"                                                                                                                                                                      // Colorize: green
            "Bits\n"                                                                                                                                                                                     // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "00b\n"                                                                                                                                                                                      // Colorize: green
            "40 bits\n"                                                                                                                                                                                  // Colorize: green
            "01b\n"                                                                                                                                                                                      // Colorize: green
            "48 bits\n"                                                                                                                                                                                  // Colorize: green
            "10b\n"                                                                                                                                                                                      // Colorize: green
            "56 bits\n"                                                                                                                                                                                  // Colorize: green
            "11b\n"                                                                                                                                                                                      // Colorize: green
            "64 bits\n"                                                                                                                                                                                  // Colorize: green
            "APIC ID size. The number of bits in the initial APIC20[ApicId] value that indicate\n"                                                                                                       // Colorize: green
            "logical processor ID within a package. The size of this field determines the\n"                                                                                                             // Colorize: green
            "maximum number of logical processors (MNLP) that the package could\n"                                                                                                                       // Colorize: green
            "theoretically support, and not the actual number of logical processors that are\n"                                                                                                          // Colorize: green
            "implemented or enabled in the package, as indicated by CPUID\n"                                                                                                                             // Colorize: green
            "Fn8000_0008_ECX[NC]. A value of zero indicates that legacy methods must be\n"                                                                                                               // Colorize: green
            "used to determine the maximum number of logical processors, as indicated by\n"                                                                                                              // Colorize: green
            "CPUID Fn8000_0008_ECX[NC].\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15:12 ApicIdSize\n"                                                                                                                                                                         // Colorize: green
            "if (ApicIdSize[3:0] == 0) {\n"                                                                                                                                                              // Colorize: green
            "// Used by legacy dual-core/single-core processors\n"                                                                                                                                       // Colorize: green
            "MNLP = CPUID Fn8000_0008_ECX[NC] + 1;\n"                                                                                                                                                    // Colorize: green
            "} else {\n"                                                                                                                                                                                 // Colorize: green
            "// use ApicIdSize[3:0] field\n"                                                                                                                                                             // Colorize: green
            "MNLP = (2 raised to the power of ApicIdSize[3:0]);\n"                                                                                                                                       // Colorize: green
            "}\n"                                                                                                                                                                                        // Colorize: green
            "11:8\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "-\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved.\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7:0\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "NT\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Number of physical threads - 1. The number of threads in the processor is NT+1\n"                                                                                                           // Colorize: green
            "(e.g., if NT = 0, then there is one thread). See \"Legacy Method\" on page 633.";                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(cpuidText1)                                                                                                                                                            // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(cpuidText2)                                                                                                                                                            // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID 80000008 ECX specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("struct Cpuid80000008Ecx");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
        cpuidLines.append("    inline good_U16 physicalCoresReal() const");                                                                                                                              // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return physicalCores + 1;");                                                                                                                                          // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    inline good_U8 apicIdBitsReal() const");                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        COMMON_LT((\"\"));");                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        if (apicIdBits == 0)");                                                                                                                                               // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            return 1;");                                                                                                                                                      // Colorize: green
        cpuidLines.append("        }");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        return apicIdBits;");                                                                                                                                                 // Colorize: green
        cpuidLines.append("    }");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("    union");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("    {");                                                                                                                                                                      // Colorize: green
        cpuidLines.append("        struct");                                                                                                                                                             // Colorize: green
        cpuidLines.append("        {");                                                                                                                                                                  // Colorize: green
        cpuidLines.append("            good_U32                physicalCores:      8;");                                                                                                                 // Colorize: green
        cpuidLines.append("            good_U32                _reserved:          4;");                                                                                                                 // Colorize: green
        cpuidLines.append("            good_U32                apicIdBits:         4;");                                                                                                                 // Colorize: green
        cpuidLines.append("            CpuidPerformanceTscSize performanceTscSize: 2;");                                                                                                                 // Colorize: green
        cpuidLines.append("            good_U32                _reserved2:         14;");                                                                                                                // Colorize: green
        cpuidLines.append("        };");                                                                                                                                                                 // Colorize: green
        cpuidLines.append("");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("        good_U32 value32;");                                                                                                                                                  // Colorize: green
        cpuidLines.append("    };");                                                                                                                                                                     // Colorize: green
        cpuidLines.append("} __attribute__((packed));");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID80000008ECX_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID 80000008 ECX with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuidPerformanceTscSize(SpecVerifyThread *thread, const QString &specContent)                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "17:16 PerfTscSize\n"                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Performance time-stamp counter size. Indicates the size of\n"                                                                                                                               // Colorize: green
            "MSRC001_0280[PTSC].\n"                                                                                                                                                                      // Colorize: green
            "Bits\n"                                                                                                                                                                                     // Colorize: green
            "Description\n"                                                                                                                                                                              // Colorize: green
            "00b\n"                                                                                                                                                                                      // Colorize: green
            "40 bits\n"                                                                                                                                                                                  // Colorize: green
            "01b\n"                                                                                                                                                                                      // Colorize: green
            "48 bits\n"                                                                                                                                                                                  // Colorize: green
            "10b\n"                                                                                                                                                                                      // Colorize: green
            "56 bits\n"                                                                                                                                                                                  // Colorize: green
            "11b\n"                                                                                                                                                                                      // Colorize: green
            "64 bits";                                                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Performance TSC Size specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(4) != "Bits" || lines.at(5) != "Description")                                                                                                                              // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse CPUID Performance TSC Size specification");                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 6;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            values.append(QString::number(lines.at(i).left(2).toLongLong(nullptr, 2)));                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append('_' + lines.at(i).toUpper().replace(' ', '_'));                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidPerformanceTscSize: good_U8");                                                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            cpuidLines.append(QString("    %1 = %2%3")                                                                                                                    // Colorize: green
                                        .arg(fields.at(i))                                                                                                                                               // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : "")                                                                                                                            // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                 // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_PERFORMANCE_TSC_SIZE_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check CPUID Performance TSC Size with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuidLeaf(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init cpuidText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidText =                                                                                                                                                                                    // Colorize: green
            "Function 8000_0000h-Maximum Extended Function Number and Vendor String . . . . . . 608\n"                                                                                                   // Colorize: green
            "Function 8000_0001h-Extended Processor and Processor Feature Identifiers. . . . . . . . . . 609\n"                                                                                          // Colorize: green
            "Functions 8000_0002h8000_0004h-Extended Processor Name String . . . . . . . . . . . . . . 612\n"                                                                                           // Colorize: green
            "Function 8000_0005h-L1 Cache and TLB Information . . . . . . . . . . . . . . . . . . . . . . . . . . . 612\n"                                                                               // Colorize: green
            "Function 8000_0006h-L2 Cache and TLB and L3 Cache Information . . . . . . . . . . . . . . . 614\n"                                                                                          // Colorize: green
            "Function 8000_0007h-Processor Power Management and RAS Capabilities . . . . . . . . . . 616\n"                                                                                              // Colorize: green
            "Function 8000_0008h-Processor Capacity Parameters and Extended Feature\n"                                                                                                                   // Colorize: green
            "Identification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 618\n"                                             // Colorize: green
            "Function 8000_0009h-Reserved . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 621\n"                                                               // Colorize: green
            "Function 8000_000Ah-SVM Features . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 621\n"                                                                     // Colorize: green
            "Functions 8000_000Bh8000_0018h-Reserved . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 622\n"                                                                           // Colorize: green
            "Function 8000_0019h-TLB Characteristics for 1GB pages . . . . . . . . . . . . . . . . . . . . . . . . 623\n"                                                                                // Colorize: green
            "Function 8000_001Ah-Instruction Optimizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 623\n"                                                                          // Colorize: green
            "Function 8000_001Bh-Instruction-Based Sampling Capabilities. . . . . . . . . . . . . . . . . . . . 625\n"                                                                                   // Colorize: green
            "Function 8000_001Ch-Lightweight Profiling Capabilities. . . . . . . . . . . . . . . . . . . . . . . . . 625\n"                                                                              // Colorize: green
            "Function 8000_001Dh-Cache Topology Information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 627\n"                                                                             // Colorize: green
            "Function 8000_001Eh-Processor Topology Information . . . . . . . . . . . . . . . . . . . . . . . . . . 629\n"                                                                               // Colorize: green
            "Function 8000_001Fh-Encrypted Memory Capabilities. . . . . . . . . . . . . . . . . . . . . . . . . . . 630\n"                                                                               // Colorize: green
            "Function 8000_0020-Reserved . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 632\n"                                                              // Colorize: green
            "Function 8000_0021-Extended Feature Identification 2 . . . . . . . . . . . . . . . . . . . . . . . . . . 632";                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("CPUID Leaves specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = cpuidText.split('\n');                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Accumulate lines                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                qint64 index;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                do                                                                                                                                                                                       // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    index = line.indexOf('.');                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (index >= 0)                                                                                                                                                                      // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        break;                                                                                                                                                                           // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    ++i;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    line.append(' ');                                                                                                                                                                    // Colorize: green
                    line.append(lines.at(i));                                                                                                                                                            // Colorize: green
                } while(true);                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                line = line.left(index);                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Parse field and value                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                line.replace("Instruction-Based", "Instruction_Based");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                qint64 index = line.lastIndexOf('-');                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                if (index >= 0)                                                                                                                                                                          // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = line.left(index).simplified();                                                                                                                                                    // Colorize: green
                    QString field = line.mid(index + 1).simplified();                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    value = value.mid(value.indexOf(' ') + 1).toUpper().remove('_').remove('H');                                                                                                         // Colorize: green
                    field = field.toUpper().replace(' ', '_');                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (!field.contains("RESERVED"))                                                                                                                                                     // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        if (value == "8000000280000004")                                                                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            fields.append("PROCESSOR_BRAND_STRING_1");                                                                                                                                   // Colorize: green
                            values.append("80000002");                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append("PROCESSOR_BRAND_STRING_2");                                                                                                                                   // Colorize: green
                            values.append("80000003");                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.append("PROCESSOR_BRAND_STRING_3");                                                                                                                                   // Colorize: green
                            values.append("80000004");                                                                                                                                                   // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                        else                                                                                                                                                                             // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            fields.append(field);                                                                                                                                                        // Colorize: green
                            values.append(value);                                                                                                                                                        // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [BEGIN] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                        // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidLeaf: good_U32");                                                                                                                                                                           // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            cpuidLines.append(QString("    %1 = 0x%2%3")                                                                                                                    // Colorize: green
                                        .arg(fields.at(i), -65, QChar(' '))                                                                                                                                                      // Colorize: green
                                        .arg(values.at(i), 8, QChar('0'))                                                                                                                        // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : "")                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [END] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert Intel values                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.insert(4,  "    VENDOR_ID_AND_LARGEST_STANDARD_FUNCTION                           = 0x00000000, // Returns CPUID's Highest Value for Basic Processor Information and the Vendor Identification String"); // Colorize: green
        cpuidLines.insert(5,  "    MODEL_AND_FEATURE_INFORMATION                                     = 0x00000001, // Returns Model, Family, Stepping Information in EAX, Returns Additional Information in EBX, Returns Feature Information in ECX and EDX"); // Colorize: green
        cpuidLines.insert(6,  "    CACHE_INFORMATION                                                 = 0x00000002, // TLB/Cache/Prefetch Information Returned in EAX, EBX, ECX, EDX");                            // Colorize: green
        cpuidLines.insert(7,  "    PROCESSOR_SERIAL_NUMBER                                           = 0x00000003, // 96 bit processor serial number. (Available in Pentium III processor only; otherwise, the value in this register is reserved.)"); // Colorize: green
        cpuidLines.insert(8,  "    DETERMINISTIC_CACHE_PARAMETERS                                    = 0x00000004, // Returns Deterministic Cache Parameters for Each Level");                                    // Colorize: green
        cpuidLines.insert(9,  "    MONITOR_AND_MWAIT_FEATURES                                        = 0x00000005, // Returns MONITOR and MWAIT Features");                                                       // Colorize: green
        cpuidLines.insert(10, "    THERMAL_AND_POWER_MANAGEMENT_FEATURES                             = 0x00000006, // Returns Thermal and Power Management Features");                                            // Colorize: green
        cpuidLines.insert(11, "    STRUCTURED_EXTENDED_FEATURE                                       = 0x00000007, // Returns Structured Extended Feature Enumeration Information");                              // Colorize: green
        cpuidLines.insert(12, "    DIRECT_CACHE_ACCESS_INFORMATION                                   = 0x00000009, // Returns Direct Cache Access Information");                                                  // Colorize: green
        cpuidLines.insert(13, "    ARCHITECTUAL_PERFORMANCE_MONITORING_FEATURES                      = 0x0000000A, // Returns Architectural Performance Monitoring Features");                                    // Colorize: green
        cpuidLines.insert(14, "    EXTENDED_TOPOLOGY_INFORMATION                                     = 0x0000000B, // Returns Extended Topology Information");                                                    // Colorize: green
        cpuidLines.insert(15, "    XSAVE_FEATURES                                                    = 0x0000000D, // Returns Processor Extended States Enumeration Information");                                // Colorize: green
        cpuidLines.insert(16, "    RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING                           = 0x0000000F, // Returns Intel Resource Director Technology (Intel RDT) Monitoring Enumeration Information"); // Colorize: green
        cpuidLines.insert(17, "    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION                           = 0x00000010, // Returns Intel Resource Director Technology (Intel RDT) Allocation Enumeration Information"); // Colorize: green
        cpuidLines.insert(18, "    SGX                                                               = 0x00000012, // Returns Intel SGX Enumeration Information");                                                // Colorize: green
        cpuidLines.insert(19, "    PROCESSOR_TRACE                                                   = 0x00000014, // Returns Intel Processor Trace Enumeration Information");                                    // Colorize: green
        cpuidLines.insert(20, "    TSC_AND_NOMINAL_CORE_CRYSTAL_CLOCK_INFORMATION                    = 0x00000015, // Returns Time Stamp Counter and Nominal Core Crystal Clock Information");                    // Colorize: green
        cpuidLines.insert(21, "    PROCESSOR_FREQUENCY_INFORMATION                                   = 0x00000016, // Returns Processor Frequency Information");                                                  // Colorize: green
        cpuidLines.insert(22, "    SYSTEM_ON_CHIP_INFORMATION                                        = 0x00000017, // Returns System-On-Chip Information");                                                       // Colorize: green
        cpuidLines.insert(23, "    DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION          = 0x00000018, // Returns Deterministic Address Translation Parameters Information");                         // Colorize: green
        cpuidLines.insert(24, "    KEY_LOCKER_INFORMATION                                            = 0x00000019, // Returns Key Locker Information");                                                           // Colorize: green
        cpuidLines.insert(25, "    HYBRID_INFORMATION                                                = 0x0000001A, // Returns Hybrid Information");                                                               // Colorize: green
        cpuidLines.insert(26, "    PCONFIG_INFORMATION                                               = 0x0000001B, // Returns PCONFIG Information");                                                              // Colorize: green
        cpuidLines.insert(27, "    LAST_BRANCH_RECORD_INFORMATION                                    = 0x0000001C, // Returns Last Branch Record Information");                                                   // Colorize: green
        cpuidLines.insert(28, "    V2_EXTENDED_TOPOLOGY_INFORMATION                                  = 0x0000001F, // Returns V2 Extended Topology Information");                                                 // Colorize: green
        cpuidLines.insert(29, "    HISTORY_RESET_INFORMATION                                         = 0x00000020, // Returns History Reset Information");                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_LEAF_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check AMD CPUID Leaves with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkCpuidSubLeaf(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [BEGIN] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                        // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class CpuidSubLeaf: good_U32 // Ignore CppEnumVerifier");                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                              // Colorize: green
        cpuidLines.append("    NONE = 0,");                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Insert Intel features                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::DETERMINISTIC_CACHE_PARAMETERS");                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_0 = 0,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_1 = 1,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_2 = 2,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_3 = 3,");                                                                                                                        // Colorize: green
            cpuidLines.append("    DETERMINISTIC_CACHE_PARAMETERS_LEVEL_4 = 4,");                                                                                                                        // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::STRUCTURED_EXTENDED_FEATURE");                                                                                                                          // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    STRUCTURED_EXTENDED_FEATURE_LEVEL_0 = 0,");                                                                                                                           // Colorize: green
            cpuidLines.append("    STRUCTURED_EXTENDED_FEATURE_LEVEL_1 = 1,");                                                                                                                           // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::EXTENDED_TOPOLOGY_INFORMATION");                                                                                                                        // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    EXTENDED_TOPOLOGY_INFORMATION_THREADS_PER_CORE = 0,");                                                                                                                // Colorize: green
            cpuidLines.append("    EXTENDED_TOPOLOGY_INFORMATION_THREADS          = 1,");                                                                                                                // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::XSAVE_FEATURES");                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PROCESSOR_EXTENDED_STATE_MAIN         = 0,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PROCESSOR_EXTENDED_STATE_SUB          = 1,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX                                   = 2,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_MPX_BOUND_REGISTERS                   = 3,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_MPX_BOUND_CONFIG_AND_STATUS_REGISTERS = 4,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_OPMASK                         = 5,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_ZMM_FROM_0_TO_15               = 6,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_AVX512_ZMM_FROM_16_TO_31              = 7,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PT                                    = 8,");                                                                                                          // Colorize: green
            cpuidLines.append("    XSAVE_FEATURES_PKRU                                  = 9,");                                                                                                          // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING");                                                                                                              // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING          = 0,");                                                                                                              // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_MONITORING_L3_CACHE = 1,");                                                                                                              // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION");                                                                                                              // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION                  = 0,");                                                                                                      // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_L3_CACHE         = 1,");                                                                                                      // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_L2_CACHE         = 2,");                                                                                                      // Colorize: green
            cpuidLines.append("    RESOURCE_DIRECTOR_TECHNOLOGY_ALLOCATION_MEMORY_BANDWIDTH = 3,");                                                                                                      // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::SGX");                                                                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    SGX_CAPABILITIES       = 0,");                                                                                                                                        // Colorize: green
            cpuidLines.append("    SGX_ATTRIBUTES         = 1,");                                                                                                                                        // Colorize: green
            cpuidLines.append("    SGX_ENCLAVE_PAGE_CACHE = 2,");                                                                                                                                        // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::PROCESSOR_TRACE");                                                                                                                                      // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    PROCESSOR_TRACE_MAIN = 0,");                                                                                                                                          // Colorize: green
            cpuidLines.append("    PROCESSOR_TRACE_SUB  = 1,");                                                                                                                                          // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::SYSTEM_ON_CHIP_INFORMATION");                                                                                                                           // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_MAIN = 0,");                                                                                                                               // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_0 = 1,");                                                                                                                     // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_1 = 2,");                                                                                                                     // Colorize: green
            cpuidLines.append("    SYSTEM_ON_CHIP_INFORMATION_BRAND_STRING_2 = 3,");                                                                                                                     // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION");                                                                                             // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION_MAIN = 0,");                                                                                                 // Colorize: green
            cpuidLines.append("    DETERMINISTIC_ADDRESS_TRANSLATION_PARAMETERS_INFORMATION_SUB  = 1,");                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::PCONFIG_INFORMATION");                                                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    PCONFIG_INFORMATION_LEVEL_0 = 0,");                                                                                                                                   // Colorize: green
            cpuidLines.append("    PCONFIG_INFORMATION_LEVEL_1 = 1,");                                                                                                                                   // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // CpuidLeaf::V2_EXTENDED_TOPOLOGY_INFORMATION");                                                                                                                     // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    V2_EXTENDED_TOPOLOGY_INFORMATION_THREADS_PER_CORE = 0,");                                                                                                             // Colorize: green
            cpuidLines.append("    V2_EXTENDED_TOPOLOGY_INFORMATION_THREADS          = 1,");                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Insert AMD features                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Prepare lines for CpuidLeaf::CACHE_TOPOLOGY_INFORMATION                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                // Init cpuidText                                                                                                                                                                                    // Colorize: green
                {                                                                                                                                                                                                    // Colorize: green
                    cpuidText =                                                                                                                                                                                    // Colorize: green
                        "CPUID Fn8000_001D_E[D,C,B,A]X reports cache topology information for the cache enumerated by\n"                                                                                 // Colorize: green
                        "the value passed to the instruction in ECX, referred to as Cache n in the following description. To\n"                                                                          // Colorize: green
                        "gather information for all cache levels, software must repeatedly execute CPUID with 8000_001Dh in\n"                                                                           // Colorize: green
                        "EAX and ECX set to increasing values beginning with 0 until a value of 00h is returned in the field\n"                                                                          // Colorize: green
                        "CacheType (EAX[4:0]) indicating no more cache descriptions are available for this processor.\n"                                                                                 // Colorize: green
                        "If CPUID Fn8000_0001_ECX[TopologyExtensions] = 0, then CPUID Fn8000_001Dh is reserved.\n"                                                                                       // Colorize: green
                        "Any value in ECX which does not select an existing cache will return a Null cache type in EAX[4:0].";                                                                           // Colorize: green
                }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                // Check that specification contains required text                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                    // Colorize: green
                    if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                                // Colorize: green
                        thread->addError("CPUID Sub-leaves specification for CpuidLeaf::CACHE_TOPOLOGY_INFORMATION didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                        return;                                                                                                                                                                                      // Colorize: green
                    }                                                                                                                                                                                                // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                cpuidLines.append("");                                                                                                                                                                       // Colorize: green
                cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
                cpuidLines.append("    // CpuidLeaf::CACHE_TOPOLOGY_INFORMATION");                                                                                                                       // Colorize: green
                cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
                cpuidLines.append("");                                                                                                                                                                       // Colorize: green
                cpuidLines.append("    CACHE_TOPOLOGY_INFORMATION_LEVEL_0 = 0,");                                                                                                                        // Colorize: green
                cpuidLines.append("    CACHE_TOPOLOGY_INFORMATION_LEVEL_1 = 1,");                                                                                                                        // Colorize: green
                cpuidLines.append("    CACHE_TOPOLOGY_INFORMATION_LEVEL_2 = 2,");                                                                                                                        // Colorize: green
                cpuidLines.append("    CACHE_TOPOLOGY_INFORMATION_LEVEL_3 = 3,");                                                                                                                        // Colorize: green
                cpuidLines.append("    CACHE_TOPOLOGY_INFORMATION_LEVEL_4 = 4");                                                                                                                        // Colorize: green
            }                                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                         // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [END] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + CPUID_SUBLEAF_H))                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check AMD CPUID Sub-leaves with specification");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void AmdCpuidSpecVerifier::checkX86Feature(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList        groups;                                                                                                                                                                           // Colorize: green
    QList<QStringList> fieldGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> valueGroups;                                                                                                                                                                      // Colorize: green
    QList<QStringList> descriptionGroups;                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get groups                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000001_ECX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
            QString cpuidText3;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1, cpuidText2 and cpuidText3                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "CPUID Fn8000_0001_ECX Feature Identifiers\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "This function contains the following miscellaneous feature identifiers:";                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24594-Rev. 3.33-November 2021\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "30\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AddrMaskExt\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Breakpoint Addressing masking extended to bit 31.\n"                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "29\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MONITORX\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Support for MWAITX and MONITORX instructions.\n"                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "28\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PerfCtrExtLLC\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Support for L3 performance counter extension.\n"                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "27\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PerfTsc\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Performance time-stamp counter. Indicates support for MSRC001_0280\n"                                                                                                               // Colorize: green
                    "[Performance Time Stamp Counter].\n"                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "26\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DataBkptExt\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Data access breakpoint extension. Indicates support for MSRC001_1027 and\n"                                                                                                         // Colorize: green
                    "MSRC001_101[B:9].\n"                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "25\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PerfCtrExtNB\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NB performance counter extensions support. Indicates support for\n"                                                                                                                 // Colorize: green
                    "MSRC001_024[6,4,2,0] and MSRC001_024[7,5,3,1].\n"                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PerfCtrExtCore\n"                                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor performance counter extensions support. Indicates support for\n"                                                                                                          // Colorize: green
                    "MSRC001_020[A,8,6,4,2,0] and MSRC001_020[B,9,7,5,3,1].\n"                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "22\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TopologyExtensio Topology extensions support. Indicates support for CPUID\n"                                                                                                        // Colorize: green
                    "ns\n"                                                                                                                                                                               // Colorize: green
                    "Fn8000_001D_EAX_x[N:0]-CPUID Fn8000_001E_EDX.\n"                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "21\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TBM\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Trailing bit manipulation instruction support.\n"                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "18\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TCE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Translation Cache Extension support.\n"                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FMA4\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Four-operand FMA instruction support.\n"                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LWP\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Lightweight profiling support. See \"Lightweight Profiling\" in APM2 and reference\n"                                                                                               // Colorize: green
                    "pages for individual LWP instructions in APM3.\n"                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "WDT\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Watchdog timer support. See APM2 and APM3. Indicates support for\n"                                                                                                                 // Colorize: green
                    "MSRC001_0074.\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SKINIT\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SKINIT and STGI are supported. Indicates support for SKINIT and STGI,\n"                                                                                                            // Colorize: green
                    "independent of the value of MSRC000_0080[SVME]. See APM2 and APM3.\n"                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "XOP\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Extended operation support.\n"                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IBS\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Instruction based sampling. See \"Instruction Based Sampling\" in APM2.\n"                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "OSVW\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "OS visible workaround. Indicates OS-visible workaround support. See \"OS Visible\n"                                                                                                 // Colorize: green
                    "Work-around (OSVW) Information\" in APM2.\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3DNowPrefetch\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PREFETCH and PREFETCHW instruction support. See \"PREFETCH\" and\n"                                                                                                                 // Colorize: green
                    "\"PREFETCHW\" in APM3.\n"                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MisAlignSse\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Misaligned SSE mode. See \"Misaligned Access Support Added for SSE\n"                                                                                                               // Colorize: green
                    "Instructions\" in APM1.\n"                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSE4A\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "EXTRQ, INSERTQ, MOVNTSS, and MOVNTSD instruction support. See\n"                                                                                                                    // Colorize: green
                    "\"EXTRQ\", \"INSERTQ\", \"MOVNTSS\", and \"MOVNTSD\" in APM4.\n"                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ABM\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Advanced bit manipulation. LZCNT instruction support. See \"LZCNT\" in APM3.\n"                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AltMovCr8\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LOCK MOV CR0 means MOV CR8. See \"MOV(CRn)\" in APM3.\n"                                                                                                                            // Colorize: green
                    "";                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText3 =                                                                                                                                                                             // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ExtApicSpace\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Extended APIC space. This bit indicates the presence of extended APIC register\n"                                                                                                   // Colorize: green
                    "space starting at offset 400h from the \"APIC Base Address Register,\" as specified\n"                                                                                                // Colorize: green
                    "in the BKDG.\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SVM\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Secure virtual machine. See \"Secure Virtual Machine\" in APM2.\n"                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CmpLegacy\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Core multi-processing legacy mode. See \"Legacy Method\" on page 633.\n"                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LahfSahf\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LAHF and SAHF instruction support in 64-bit mode. See \"LAHF\" and \"SAHF\" in\n"                                                                                                       // Colorize: green
                    "APM3.";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText3)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000001_ECX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2 + '\n' + cpuidText3).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0001_ECX Feature Identifiers"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != "This function contains the following miscellaneous feature identifiers:"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "AMD64 Technology"                                                                                                                                                        // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Bits Field Name"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(7) != "24594-Rev. 3.33-November 2021"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(8) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(9) != "Description"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(10) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000001_ECX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 11;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AddrMaskExt",        "ADDRMASKEXT");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MONITORX",           "MWAITX");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PerfCtrExtLLC",      "PERFCTR_LLC");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PerfTsc",            "PTSC");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("DataBkptExt",        "BPEXT");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PerfCtrExtNB",       "PERFCTR_NB");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PerfCtrExtCore",     "PERFCTR_CORE");                                                                                                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TopologyExtensions", "TOPOEXT");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TBM",                "TBM");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TCE",                "TCE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FMA4",               "FMA4");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LWP",                "LWP");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("WDT",                "WDT");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SKINIT",             "SKINIT");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("XOP",                "XOP");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IBS",                "IBS");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("OSVW",               "OSVW");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("3DNowPrefetch",      "_3DNOWPREFETCH");                                                                                                          // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MisAlignSse",        "MISALIGNSSE");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SSE4A",              "SSE4A");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ABM",                "ABM");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AltMovCr8",          "CR8_LEGACY");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ExtApicSpace",       "EXTAPIC");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SVM",                "SVM");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CmpLegacy",          "CMP_LEGACY");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LahfSahf",           "LAHF_LM");                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value == "22")                                                                                                                                                                   // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        fields.prepend("TOPOEXT");                                                                                                                                                        // Colorize: green
                        values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000001_ECX, " + value + ')');                                                                                                   // Colorize: green
                        descriptions.prepend("Topology extensions support. Indicates support for CPUID Fn8000_001D_EAX_x[N:0]-CPUID Fn8000_001E_EDX.");                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        i += 6;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        continue;                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                         // Colorize: green
                        description.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000001_ECX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field == "AltMovCr8")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 8;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000001_ECX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000001_EDX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "CPUID Fn8000_0001_EDX Feature Identifiers\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "This function contains the following miscellaneous feature identifiers:\n"                                                                                                          // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3DNow\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3DNow!(TM) instructions. See Appendix D \"Instruction Subsets and CPUID Feature\n"                                                                                                  // Colorize: green
                    "Sets\" in APM3.\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "30\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3DNowExt\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD extensions to 3DNow! instructions. See Appendix D \"Instruction Subsets and\n"                                                                                                  // Colorize: green
                    "CPUID Feature Sets\" in APM3.\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "29\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LM\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Long mode. See \"Processor Initialization and Long-Mode Activation\" in APM2.\n"                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "28\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "27\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RDTSCP\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RDTSCP instruction. See \"RDTSCP\" in APM3.\n"                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "26\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page1GB\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1-GB large page support. See \"1-GB Paging Support\" in APM2.\n"                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "25\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FFXSR\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FXSAVE and FXRSTOR instruction optimizations. See \"FXSAVE\" and \"FXRSTOR\"\n"                                                                                                     // Colorize: green
                    "in APM5.\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FXSR\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FXSAVE and FXRSTOR instructions. Same as CPUID Fn0000_0001_EDX[FXSR].\n"                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MMX\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MMX(TM) instructions. Same as CPUID Fn0000_0001_EDX[MMX].\n"                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "22\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MmxExt\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD extensions to MMX instructions. See Appendix D \"Instruction Subsets and\n"                                                                                                     // Colorize: green
                    "CPUID Feature Sets\" in APM3 and \"128-Bit Media and Scientific Programming\" in\n"                                                                                                 // Colorize: green
                    "APM1.\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "21\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NX\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "No-execute page protection. See \"Page Translation and Protection\" in APM2.\n"                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19:18 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSE36\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page-size extensions. Same as CPUID Fn0000_0001_EDX[PSE36].\n"                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PAT\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page attribute table. Same as CPUID Fn0000_0001_EDX[PAT].\n"                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMOV\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Conditional move instructions. Same as CPUID Fn0000_0001_EDX[CMOV].\n"                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCA\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Machine check architecture. Same as CPUID Fn0000_0001_EDX[MCA].\n"                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PGE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page global extension. Same as CPUID Fn0000_0001_EDX[PGE].\n"                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MTRR\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Memory-type range registers. Same as CPUID Fn0000_0001_EDX[MTRR].\n"                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SysCallSysRet\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SYSCALL and SYSRET instructions. See \"SYSCALL\" and \"SYSRET\" in APM3.\n"                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "";                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24594-Rev. 3.33-November 2021\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "APIC\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Advanced programmable interrupt controller. Same as CPUID\n"                                                                                                                        // Colorize: green
                    "Fn0000_0001_EDX[APIC].\n"                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMPXCHG8B\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CMPXCHG8B instruction. Same as CPUID Fn0000_0001_EDX[CMPXCHG8B].\n"                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Machine check exception. Same as CPUID Fn0000_0001_EDX[MCE].\n"                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PAE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Physical-address extensions. Same as CPUID Fn0000_0001_EDX[PAE].\n"                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MSR\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD model-specific registers. Same as CPUID Fn0000_0001_EDX[MSR].\n"                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TSC\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Time stamp counter. Same as CPUID Fn0000_0001_EDX[TSC].\n"                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page-size extensions. Same as CPUID Fn0000_0001_EDX[PSE].\n"                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DE\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Debugging extensions. Same as CPUID Fn0000_0001_EDX[DE].\n"                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VME\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Virtual-mode enhancements. Same as CPUID Fn0000_0001_EDX[VME].\n"                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FPU\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "x87 floating-point unit on-chip. Same as CPUID Fn0000_0001_EDX[FPU].";                                                                                                              // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000001_EDX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0001_EDX Feature Identifiers"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != "This function contains the following miscellaneous feature identifiers:"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "Bits Field Name"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Description"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000001_EDX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 7;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FPU",           "NONE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VME",           "NONE");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("DE",            "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PSE",           "NONE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TSC",           "NONE");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MSR",           "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PAE",           "NONE");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MCE",           "NONE");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CMPXCHG8B",     "NONE");                                                                                                          // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("APIC",          "NONE");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SysCallSysRet", "SYSCALL");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MTRR",          "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PGE",           "NONE");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MCA",           "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CMOV",          "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PAT",           "NONE");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PSE36",         "NONE");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NX",            "NX");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MmxExt",        "MMXEXT");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MMX",           "NONE");                                                                                                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FXSR",          "NONE");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FFXSR",         "FXSR_OPT");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("Page1GB",       "PAGE_1GB");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDTSCP",        "RDTSCP");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LM",            "LM");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("3DNowExt",      "_3DNOWEXT");                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("3DNow",         "_3DNOW");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("PAGE_1GB", "pdpe1gb");                                                                                                                    // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value.contains('-'))                                                                                                                                                                   // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 4;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        continue;                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                         // Colorize: green
                        description.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000001_EDX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value == "10")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 10;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000001_EDX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000007_EBX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "CPUID Fn8000_0007_EBX RAS Capabilities";                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "The value returned in EBX provides information about RAS features that allow system software to\n"                                                                                  // Colorize: green
                    "detect specific hardware errors.\n"                                                                                                                                                 // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31:4\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ScalableMca\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0=MCAX is not supported. 1=MCAX is supported; the MCAX MSR addresses are\n"                                                                                                         // Colorize: green
                    "supported; MCA_CONFIG[Mcax] is present in all MCA banks.\n"                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "HWA\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Hardware assert supported. Indicates support for MSRC001_10[DF:C0].\n"                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SUCCOR\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Software uncorrectable error containment and recovery capability.\n"                                                                                                                // Colorize: green
                    "The processor supports software containment of uncorrectable errors through\n"                                                                                                      // Colorize: green
                    "context synchronizing data poisoning and deferred error interrupts; see APM2,\n"                                                                                                    // Colorize: green
                    "Chapter 9, \"Determining Machine-Check Architecture Support.\"\n"                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCA overflow recovery support. If set, indicates that MCA overflow conditions\n"                                                                                                    // Colorize: green
                    "(MCi_STATUS[Overflow]=1) are not fatal; software may safely ignore such\n"                                                                                                          // Colorize: green
                    "McaOverflowRecov\n"                                                                                                                                                                 // Colorize: green
                    "conditions. If clear, MCA overflow conditions require software to shut down the\n"                                                                                                  // Colorize: green
                    "system. See APM2, Chapter 9, \"Handling Machine Check Exceptions.\"";                                                                                                               // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000007_EBX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0007_EBX RAS Capabilities"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != "AMD64 Technology"                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "The value returned in EBX provides information about RAS features that allow system software to"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != "detect specific hardware errors."                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Bits Field Name"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(7) != "Description"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(8) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000007_EBX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 9;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("McaOverflowRecov", "OVERFLOW_RECOV");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SUCCOR",           "SUCCOR");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HWA",              "HWA");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ScalableMca",      "SMCA");                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value == "0")                                                                                                                                                                    // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        field = "McaOverflowRecov";                                                                                                                                                      // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                        {                                                                                                                                                                                    // Colorize: green
                            ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                            field.append(' ');                                                                                                                                                         // Colorize: green
                            field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                        }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (lines.at(i) != "McaOverflowRecov")                                                                                                                                           // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            description.append(' ');                                                                                                                                                     // Colorize: green
                            description.append(lines.at(i));                                                                                                                                             // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000007_EBX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000007_EBX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000007_EDX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                                    // Colorize: green
                    "CPUID Fn8000_0007_EDX Advanced Power Management Features\n"                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "The value returned in EDX provides information about the advanced power management and power\n"                                                                                     // Colorize: green
                    "reporting features available. Refer to the BIOS and Kernel Developer's Guide for your specific product\n"                                                                           // Colorize: green
                    "for a detailed description of the definition of each power management feature.\n"                                                                                                   // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "31:13 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ProcPowerReporting\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor power reporting interface supported.\n"                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ProcFeedbackInterface\n"                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor feedback interface. Value: 1. 1=Indicates support for processor\n"                                                                                                        // Colorize: green
                    "feedback interface. Note: This feature is deprecated.\n"                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "EffFreqRO\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Read-only effective frequency interface. 1=Indicates presence of\n"                                                                                                                 // Colorize: green
                    "MSRC000_00E7 [Read-Only Max Performance Frequency Clock Count\n"                                                                                                                    // Colorize: green
                    "(MPerfReadOnly)] and MSRC000_00E8 [Read-Only Actual Performance\n"                                                                                                                  // Colorize: green
                    "Frequency Clock Count (APerfReadOnly)].\n"                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CPB\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Core performance boost.\n"                                                                                                                                                          // Colorize: green
                    "";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24594-Rev. 3.33-November 2021\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TscInvariant\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TSC invariant. The TSC rate is ensured to be invariant across all P-States, CStates, and stop grant transitions (such as STPCLK Throttling); therefore the\n"                       // Colorize: green
                    "TSC is suitable for use as a source of time. 0 = No such guarantee is made\n"                                                                                                       // Colorize: green
                    "and software should avoid attempting to use the TSC as a source of time.\n"                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "HwPstate\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Hardware P-state control. MSRC001_0061 [P-state Current Limit],\n"                                                                                                                  // Colorize: green
                    "MSRC001_0062 [P-state Control] and MSRC001_0063 [P-state Status] exist.\n"                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "100MHzSteps\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "100 MHz multiplier Control.\n"                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TM\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Hardware thermal control (HTC).\n"                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TTP\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "THERMTRIP.\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VID\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Voltage ID control. Function replaced by HwPstate.\n"                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FID\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Frequency ID control. Function replaced by HwPstate.\n"                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TS\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Temperature sensor.";                                                                                                                                                               // Colorize: green
            }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000007_EDX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0007_EDX Advanced Power Management Features"                                                                                                    // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(1) != ""                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(2) != "The value returned in EDX provides information about the advanced power management and power"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(3) != "reporting features available. Refer to the BIOS and Kernel Developer's Guide for your specific product"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(4) != "for a detailed description of the definition of each power management feature."                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(5) != "Bits Field Name"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(6) != "31:13 -"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(7) != ""                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(8) != "Description"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(9) != "Reserved."                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                               // Colorize: green
                    lines.at(10) != ""                                                                                                                                                                // Colorize: green
                   )                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000007_EDX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 11;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TS",                    "TS");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FID",                   "FID");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VID",                   "VID");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TTP",                   "TTP");                                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TM",                    "HTM");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("100MHzSteps",           "_100_MHZ_STEPS");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HwPstate",              "HW_PSTATE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TscInvariant",          "TSC_INVARIANT");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CPB",                   "CPB");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("EffFreqRO",             "EFF_FREQ_RO");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ProcFeedbackInterface", "PROC_FEEDBACK");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("ProcPowerReporting",    "PROC_POWER_REPORTING");                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                     // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                     // Colorize: green
                        description.append(lines.at(i));                                                                                                                                             // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000007_EDX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field == "CPB")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 6;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000007_EDX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000008_EBX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                             // Colorize: green
                    "CPUID Fn8000_0008_EBX Extended Feature Identifiers\n"                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "The value returned in EBX is an extension to the Fn8000_0001 feature flags and indicates the presence\n"                                                                            // Colorize: green
                    "of various ISA extensions.";                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "Bit\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Field Name\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "31:29 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "28\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PSFD\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Predictive Store Forward Disable\n"                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "27\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "26\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SsbdNotRequired\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSBD not needed on this processor\n"                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "25\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SsbdVirtSpecCtrl\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Use VIRT_SPEC_CTL for SSBD\n"                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSBD\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Speculative Store Bypass Disable\n"                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23:22 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "21\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "INVLPGBnestedPages\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "INVLPGB support for invalidating guest nested translations\n"                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "EferLmsleUnsupported\n"                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "EFER.LMSLE is unsupported.\n"                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IbrsSameMode\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IBRS provides same mode speculation limits\n"                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "18\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IbrsPreferred\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IBRS is preferred over software solution\n"                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "StibpAlwaysOn\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor prefers that STIBP be left on\n"                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IbrsAlwaysOn\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor prefers that IBRS be left on\n"                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "STIBP\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Single Thread Indirect Branch Prediction mode\n"                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IBRS\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Indirect Branch Restricted Speculation\n"                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "INT_WBINVD\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "WBINVD/WBNOINVD are interruptible.\n"                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "IBPB\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Indirect Branch Prediction Barrier\n"                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11:10 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "WBNOINVD\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "WBNOINVD instruction supported\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCOMMIT\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MCOMMIT instruction supported\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7:5\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RDPRU\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RDPRU instruction supported\n"                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "INVLPGB\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "INVLPGB and TLBSYNC instruction supported\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RstrFpErrPtrs\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FP Error Pointers Restored by XRSTOR\n"                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "InstRetCntMsr\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Instruction Retired Counter MSR available\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CLZERO\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "CLZERO instruction supported";                                                                                                                                                      // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000008_EBX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0008_EBX Extended Feature Identifiers"                                                                                                                // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(1) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(2) != "The value returned in EBX is an extension to the Fn8000_0001 feature flags and indicates the presence"                                                             // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(3) != "of various ISA extensions."                                                                                                                                         // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(4) != "Bit"                                                                                                                                                               // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(5) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(6) != "Field Name"                                                                                                                                                        // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(7) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(8) != "AMD64 Technology"                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(9) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(10) != "Description"                                                                                                                                                      // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(11) != ""                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(12) != "31:29 -"                                                                                                                                                          // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(13) != ""                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(14) != "Reserved"                                                                                                                                                         // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(15) != ""                                                                                                                                                                 // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000008_EBX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 16;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("CLZERO",               "CLZERO");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("InstRetCntMsr",        "IRPERF");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RstrFpErrPtrs",        "XSAVEERPTR");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("INVLPGB",              "INVLPGB");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RDPRU",                "RDPRU");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("MCOMMIT",              "MCOMMIT");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("WBNOINVD",             "WBNOINVD");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IBPB",                 "AMD_IBPB");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("INT_WBINVD",           "INT_WBINVD");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IBRS",                 "AMD_IBRS");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("STIBP",                "AMD_STIBP");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IbrsAlwaysOn",         "IBRS_ALWAYS_ON");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("StibpAlwaysOn",        "STIBP_ALWAYS_ON");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IbrsPreferred",        "IBRS_PREFERRED");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("IbrsSameMode",         "IBRS_SAME_MODE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("EferLmsleUnsupported", "EFER_LMSLE_UNSUPPORTED");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("INVLPGBnestedPages",   "INVLPGB_NESTED_PAGES");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SSBD",                 "AMD_SSBD");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SsbdVirtSpecCtrl",     "VIRT_SSBD");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SsbdNotRequired",      "AMD_SSB_NO");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PSFD",                 "PSFD");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("AMD_IBPB",   "");                                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("AMD_IBRS",   "");                                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("AMD_STIBP",  "");                                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("AMD_SSBD",   "");                                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("AMD_SSB_NO", "");                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value.contains('-'))                                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 4;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        continue;                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                     // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                     // Colorize: green
                        description.append(lines.at(i));                                                                                                                                             // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000008_EBX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000008_EBX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_8000000A_EDX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                             // Colorize: green
                    "CPUID Fn8000_000A_EDX SVM Feature Identification\n"                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "The value returned in EDX provides Secure Virtual Machine architecture feature information. All\n"                                                                                  // Colorize: green
                    "cross references in the table below are to sections within the Secure Virtual Machine chapter of APM2.\n"                                                                           // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "31:25 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "Support for INVLPGB/TLBSYNC hypervisor enable in VMCB and\n"                                                                                                                        // Colorize: green
                    "TLBSYNC intercept.\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TlbiCtl\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "When host CR4.MCE=1 and guest CR4.MCE=0, machine check\n"                                                                                                                           // Colorize: green
                    "HOST_MCE_OVERRIDE exceptions (#MC) in a guest do not cause shutdown and are always\n"                                                                                               // Colorize: green
                    "intercepted.\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "22:21 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "24594-Rev. 3.33-November 2021\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "20\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SpecCtrl\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SPEC_CTRL virtualization.\n"                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "19\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SSSCheck\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SVM supervisor shadow stack restrictions. See \"Supervisor Shadow Stack\n"                                                                                                          // Colorize: green
                    "Restrictions\" in Volume 2.\n"                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "18\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "17\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "GMET\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Guest Mode Execution Trap.\n"                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VGIF\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Virtualize the Global Interrupt Flag. See \"Nested Virtualization\"\n"                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VMSAVEvirt\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VMSAVE and VMLOAD virtualization. See \"Nested Virtualization\"\n"                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AVIC\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Support for the AMD advanced virtual interrupt controller. See \"Advanced\n"                                                                                                        // Colorize: green
                    "Virtual Interrupt Controller.\"\n"                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PauseFilterThreshold\n"                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PAUSE filter threshold. Indicates support for the PAUSE filter cycle count\n"                                                                                                       // Colorize: green
                    "threshold. See \"Pause Intercept Filtering\" in Volume 2.\n"                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PauseFilter\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Pause intercept filter. Indicates support for the pause intercept filter. See\n"                                                                                                    // Colorize: green
                    "\"Pause Intercept Filtering.\"\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9:8\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DecodeAssists\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Decode assists. Indicates support for the decode assists. See \"Decode\n"                                                                                                           // Colorize: green
                    "Assists.\"\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "FlushByAsid\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Flush by ASID. Indicates that TLB flush events, including CR3 writes and\n"                                                                                                         // Colorize: green
                    "CR4.PGE toggles, flush only the current ASID's TLB entries. Also indicates\n"                                                                                                       // Colorize: green
                    "support for the extended VMCB TLB_Control. See \"TLB Control.\"\n"                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VmcbClean\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VMCB clean bits. Indicates support for VMCB clean bits. See \"VMCB\n"                                                                                                               // Colorize: green
                    "Clean Bits.\"\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "TscRateMsr\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "MSR based TSC rate control. Indicates support for MSR TSC ratio\n"                                                                                                                  // Colorize: green
                    "MSRC000_0104. See \"TSC Ratio MSR (C000_0104h).\"\n"                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NRIPS\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NRIP save. Indicates support for NRIP save on #VMEXIT. See \"State\n"                                                                                                               // Colorize: green
                    "Saved on Exit.\"\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SVML\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SVM lock. Indicates support for SVM-Lock. See \"Enabling SVM.\"\n"                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LbrVirt\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LBR virtualization. Indicates support for LBR Virtualization. See \"Enabling\n"                                                                                                     // Colorize: green
                    "LBR Virtualization.\"\n"                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NP\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Nested paging. Indicates support for nested paging. See \"Nested Paging.\"";                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_8000000A_EDX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(28) != "Bits Field Name"                                                                                                                // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(29) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(30) != "24594-Rev. 3.33-November 2021"                                                                                                                                                               // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(31) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(32) != "Description"                                                                                                                                                        // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(33) != ""                                                                                                                                                                  // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_8000000A_EDX");                                                                                                                      // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                i = 34;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NP",                   "NPT");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LbrVirt",              "LBRV");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SVML",                 "SVML");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NRIPS",                "NRIPS");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TscRateMsr",           "TSCRATEMSR");                                                                                                            // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VmcbClean",            "VMCBCLEAN");                                                                                                             // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("FlushByAsid",          "FLUSHBYASID");                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("DecodeAssists",        "DECODEASSISTS");                                                                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PauseFilter",          "PAUSEFILTER");                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PauseFilterThreshold", "PFTHRESHOLD");                                                                                                           // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AVIC",                 "AVIC");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VMSAVEvirt",           "V_VMSAVE_VMLOAD");                                                                                                       // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VGIF",                 "VGIF");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("GMET",                 "GMET");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SSSCheck",             "SSS_CHECK");                                                                                                              // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SpecCtrl",             "SPEC_CTRL_VIRT");                                                                                                        // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HOST_MCE_OVERRIDE",    "HOST_MCE_OVERRIDE");                                                                                                     // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("TlbiCtl",              "TLBI_CTL");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("SVML",       "svm_lock");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("NRIPS",      "nrip_save");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("TSCRATEMSR", "tsc_scale");                                                                                                                  // Colorize: green
                cpuidFieldNamesToNgosFieldShortNames.insert("VMCBCLEAN",  "vmcb_clean");                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                     // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                     // Colorize: green
                        description.append(lines.at(i));                                                                                                                                             // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_8000000A_EDX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Insert specific values                                                                                                                                                                // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    fields.append("HOST_MCE_OVERRIDE");                                                                                                                                                   // Colorize: green
                    values.append("WORD_BIT(X86FeatureWord::CPUID_8000000A_EDX, 23)");                                                                                               // Colorize: green
                    descriptions.append("When host CR4.MCE=1 and guest CR4.MCE=0, machine check exceptions (#MC) in a guest do not cause shutdown and are always intercepted.");                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    fields.append("TLBI_CTL");                                                                                                                                                   // Colorize: green
                    values.append("WORD_BIT(X86FeatureWord::CPUID_8000000A_EDX, 24)");                                                                                               // Colorize: green
                    descriptions.append("Support for INVLPGB/TLBSYNC hypervisor enable in VMCB and TLBSYNC intercept.");                                                                                 // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_8000000A_EDX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_8000001F_EAX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString cpuidText1;                                                                                                                                                                                 // Colorize: green
            QString cpuidText2;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText1 and cpuidText2                                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText1 =                                                                                                                                                                             // Colorize: green
                    "CPUID Fn8000_001F_EAX Secure Encryption\n"                                                                                                                                          // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "31:25\n"                                                                                                                                                                            // Colorize: green
                    "24\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "VmsaRegProt\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "VMSA Register Protection supported\n"                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "23:17\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "16\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VTE\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Virtual Transparent Encryption supported\n"                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "15\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PreventHostIbs\n"                                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Disallowing IBS use by the host supported\n"                                                                                                                                        // Colorize: green
                    "";                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                cpuidText2 =                                                                                                                                                                             // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AMD64 Technology\n"                                                                                                                                                                 // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "14\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "DebugSwap\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Full debug state swap supported for SEV-ES guests\n"                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "AlternateInjection\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Alternate Injection supported\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "RestrictedInjection\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Restricted Injection supported\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "11\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "64BitHost\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV guest execution only allowed from a 64-bit host\n"                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "10\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "HwEnfCacheCoh\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Hardware cache coherency across encryption domains enforced\n"                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "7:6\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "SecureTsc\n"                                                                                                                                                                        // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "Secure TSC supported\n"                                                                                                                                                             // Colorize: green
                    "Reserved.\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "5\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VMPL\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "VM Permission Levels supported\n"                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV-SNP\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV Secure Nested Paging supported\n"                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV-ES\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV Encrypted State supported\n"                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PageFlushMsr\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Page Flush MSR available\n"                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SEV\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Secure Encrypted Virtualization supported\n"                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SME\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Secure Memory Encryption supported";                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    !specContent.contains(cpuidText1)                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    !specContent.contains(cpuidText2)                                                                                                                                                    // Colorize: green
                   )                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_8000001F_EAX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = (cpuidText1 + '\n' + cpuidText2).split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_001F_EAX Secure Encryption"                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(1) != "Bits Field Name"                                                                                                                                                   // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(2) != "31:25"                                                                                                                                                             // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(3) != "24"                                                                                                                                                                // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(5) != "-"                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(6) != "VmsaRegProt"                                                                                                                                                       // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(7) != ""                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(8) != "Description"                                                                                                                                                       // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(9) != "Reserved."                                                                                                                                                         // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(10) != "VMSA Register Protection supported"                                                                                                                               // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(11) != ""                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(12) != "23:17"                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(13) != ""                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(14) != "-"                                                                                                                                                                 // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(15) != ""                                                                                                                                                                 // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_8000001F_EAX");                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    return;                                                                                                                                                                              // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                i = 16;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SME",                 "SME");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SEV",                 "SEV");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PageFlushMsr",        "PAGE_FLUSH_MSR");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SEV-ES",              "SEV_ES");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SEV-SNP",             "SEV_SNP");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VMPL",                "VMPL");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SecureTsc",           "SECURE_TSC");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("HwEnfCacheCoh",       "HW_ENF_CACHE_COH");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("64BitHost",           "_64_BIT_HOST");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("RestrictedInjection", "REST_INJ");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("AlternateInjection",  "ALT_INJ");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("DebugSwap",           "DEBUG_SWAP");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PreventHostIbs",      "PREVENT_HOST_IBS");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VTE",                 "VTE");                                                                                                                   // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("VmsaRegProt",         "VMSA_REG_PROT");                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value == "9")                                                                                                                                                                    // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        fields.prepend("SECURE_TSC");                                                                                                                                                     // Colorize: green
                        values.prepend("WORD_BIT(X86FeatureWord::CPUID_8000001F_EAX, 8)");                                                                                                               // Colorize: green
                        descriptions.prepend("Secure TSC supported");                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        i += 12;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        continue;                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                     // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                     // Colorize: green
                        description.append(lines.at(i));                                                                                                                                             // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_8000001F_EAX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field == "PreventHostIbs")                                                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 8;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                    else                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 2;                                                                                                                                                                          // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Insert specific values                                                                                                                                                                // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    fields.append("VMSA_REG_PROT");                                                                                                                                                   // Colorize: green
                    values.append("WORD_BIT(X86FeatureWord::CPUID_8000001F_EAX, 24)");                                                                                               // Colorize: green
                    descriptions.append("VMSA Register Protection supported");                                                                                 // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_8000001F_EAX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Prepare group for X86FeatureWord::CPUID_80000021_EAX                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                    // Colorize: green
            QString cpuidText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Init cpuidText                                                                                                                                                                            // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidText =                                                                                                                                                                             // Colorize: green
                    "CPUID Fn8000_0021_EAX Extended Feature 2\n"                                                                                                                                         // Colorize: green
                    "Bits Field Name\n"                                                                                                                                                                  // Colorize: green
                    "31:14 -\n"                                                                                                                                                                          // Colorize: green
                    "13\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "PrefetchCtlMsr\n"                                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "12:10 -\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Description\n"                                                                                                                                                                      // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "Prefetch control MSR supported. See Core::X86::Msr::PrefetchControl in\n"                                                                                                           // Colorize: green
                    "BKDG or PPR for details\n"                                                                                                                                                          // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "9\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NoSmmCtlMSR\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SMM_CTL MSR (C001_0116h) is not supported.\n"                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "8\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "7\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "UpperAddressIgnore\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Upper Address Ignore is supported.\n"                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "6\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NullSelectClearsBase\n"                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Null segment selector loads also clear the destination segment register\n"                                                                                                          // Colorize: green
                    "base and limit.\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SmmPgCfgLock\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "SMM paging configuration lock supported.\n"                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LFenceAlwaysSerializing\n"                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "LFENCE is always dispatch serializing.\n"                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "-\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Reserved\n"                                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "NoNestedDataBp\n"                                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor ignores nested data breakpoints";                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Check that specification contains required text                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (!specContent.contains(cpuidText))                                                                                                                                                                                             // Colorize: green
                {                                                                                                                                                                                                // Colorize: green
                    thread->addError("X86 Features specification for X86FeatureWord::CPUID_80000021_EAX didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
                    return;                                                                                                                                                                                      // Colorize: green
                }                                                                                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList lines = cpuidText.split('\n');                                                                                                                            // Colorize: green
            qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                                 // Colorize: green
            // Skip lines                                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                if (                                                                                                                                                                                     // Colorize: green
                    lines.at(0) != "CPUID Fn8000_0021_EAX Extended Feature 2"                                                                                                                            // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(1) != "Bits Field Name"                                                                                                                                                     // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(2) != "31:14 -"                                                                                                                                                             // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(3) != "13"                                                                                                                                                                  // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(4) != ""                                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(5) != "PrefetchCtlMsr"                                                                                                                                                      // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(6) != ""                                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(7) != "12:10 -"                                                                                                                                                             // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(8) != ""                                                                                                                                                                    // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(9) != "Description"                                                                                                                                                         // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(10) != "Reserved"                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(11) != "Prefetch control MSR supported. See Core::X86::Msr::PrefetchControl in"                                                                                             // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(12) != "BKDG or PPR for details"                                                                                                                                            // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(13) != "Reserved"                                                                                                                                                           // Colorize: green
                    ||                                                                                                                                                                                   // Colorize: green
                    lines.at(14) != ""                                                                                                                                                                   // Colorize: green
                   )                                                                                                                                                                                     // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    thread->addError("Failed to parse X86 Features specification for X86FeatureWord::CPUID_80000021_EAX");                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    return;                                                                                                                                                                              // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                                                 // Colorize: green
                i = 15;                                                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldNames;      // CPUID field name => NGOS field name                                                                                              // Colorize: green
            QHash<QString, QString> cpuidFieldNamesToNgosFieldShortNames; // CPUID field name => NGOS field short name                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Fill cpuidFieldNamesToNgosFieldNames and cpuidFieldNamesToNgosFieldShortNames                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                                    // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NoNestedDataBp",          "NO_NESTED_DATA_BP");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("LFenceAlwaysSerializing", "LFENCE_ALWAYS_SERIALIZING");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("SmmPgCfgLock",            "SMM_PG_CFG_LOCK");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NullSelectClearsBase",    "NULL_SELECT_CLEARS_BASE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("UpperAddressIgnore",      "UPPER_ADDRESS_IGNORE");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("NoSmmCtlMSR",             "NO_SMM_CTL_MSR");                                                                                                                 // Colorize: green
                cpuidFieldNamesToNgosFieldNames.insert("PrefetchCtlMsr",          "PREFETCH_CTL_MSR");                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QStringList fields;                                                                                                                                                                          // Colorize: green
            QStringList values;                                                                                                                                                                          // Colorize: green
            QStringList descriptions;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Get fields                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                while (i < lines.size())                                                                                                                                                                 // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    QString value = lines.at(i);                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (value.contains('-'))                                                                                                                                                             // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        i += 4;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        continue;                                                                                                                                                                        // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                                             // Colorize: green
                    i += 2;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString field = lines.at(i);                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                     // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                            // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        field.append(' ');                                                                                                                                                         // Colorize: green
                        field.append(lines.at(i));                                                                                                                                                 // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    QString description = lines.at(i);                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        ++i;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        description.append(' ');                                                                                                                                                     // Colorize: green
                        description.append(lines.at(i));                                                                                                                                             // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    if (field != "-")                                                                                                                                                                                 // Colorize: green
                    {                                                                                                                                                                                    // Colorize: green
                        QString fieldCode = cpuidFieldNamesToNgosFieldNames.value(field, "");                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode == "")                                                                                                                                                        // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            thread->addError(QString("Failed to convert CPUID name: %1")                                                                                                                               // Colorize: green
                                                        .arg(field)                                                                                                                                           // Colorize: green
                            );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                                     // Colorize: green
                            return;                                                                                                                                                                                  // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                        if (fieldCode != "NONE")                                                                                                                                                         // Colorize: green
                        {                                                                                                                                                                                // Colorize: green
                            QString fieldName = cpuidFieldNamesToNgosFieldShortNames.value(fieldCode, "EMPTY");                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            if (fieldName != "EMPTY")                                                                                                                                                    // Colorize: green
                            {                                                                                                                                                                            // Colorize: green
                                description = '\"' + fieldName + "\" " + description;                                                                                                                    // Colorize: green
                            }                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                            fields.prepend(fieldCode);                                                                                                                                                   // Colorize: green
                            values.prepend("WORD_BIT(X86FeatureWord::CPUID_80000021_EAX, " + value + ')');                                                                                               // Colorize: green
                            descriptions.prepend(description.simplified());                                                                                                                              // Colorize: green
                        }                                                                                                                                                                                // Colorize: green
                    }                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    i += 2;                                                                                                                                                                          // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                // Insert specific values                                                                                                                                                                // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    fields.append("PREFETCH_CTL_MSR");                                                                                                                                                   // Colorize: green
                    values.append("WORD_BIT(X86FeatureWord::CPUID_80000021_EAX, 13)");                                                                                               // Colorize: green
                    descriptions.append("Prefetch control MSR supported. See Core::X86::Msr::PrefetchControl in BKDG or PPR for details");                                                               // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            groups.append("AMD-defined CPU features, X86FeatureWord::CPUID_80000021_EAX");                                                                                                             // Colorize: green
            fieldGroups.append(fields);                                                                                                                                                                  // Colorize: green
            valueGroups.append(values);                                                                                                                                                                  // Colorize: green
            descriptionGroups.append(descriptions);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList cpuidLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [BEGIN] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                        // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("enum class X86Feature: good_U16 // Ignore CppEnumVerifier");                                                                                                                    // Colorize: green
        cpuidLines.append("{");                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Insert Intel features                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000001_ECX");                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    SSE3                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 0),    // Streaming SIMD Extensions 3 (SSE3). A value of 1 indicates the processor supports this technology."); // Colorize: green
            cpuidLines.append("    PCLMULQDQ                 = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 1),    // PCLMULQDQ. A value of 1 indicates the processor supports the PCLMULQDQ instruction."); // Colorize: green
            cpuidLines.append("    DTES64                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 2),    // 64-bit DS Area. A value of 1 indicates the processor supports DS area using 64-bit layout."); // Colorize: green
            cpuidLines.append("    MONITOR                   = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 3),    // MONITOR/MWAIT. A value of 1 indicates the processor supports this feature.");       // Colorize: green
            cpuidLines.append("    DS_CPL                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 4),    // CPL Qualified Debug Store. A value of 1 indicates the processor supports the extensions to the Debug Store feature to allow for branch message storage qualified by CPL."); // Colorize: green
            cpuidLines.append("    VMX                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 5),    // Virtual Machine Extensions. A value of 1 indicates that the processor supports this technology."); // Colorize: green
            cpuidLines.append("    SMX                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 6),    // Safer Mode Extensions. A value of 1 indicates that the processor supports this technology. See Chapter 6, \"Safer Mode Extensions Reference\"."); // Colorize: green
            cpuidLines.append("    EIST                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 7),    // \"est\" Enhanced Intel SpeedStep(R) technology. A value of 1 indicates that the processor supports this technology."); // Colorize: green
            cpuidLines.append("    TM2                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 8),    // Thermal Monitor 2. A value of 1 indicates whether the processor supports this technology."); // Colorize: green
            cpuidLines.append("    SSSE3                     = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 9),    // A value of 1 indicates the presence of the Supplemental Streaming SIMD Extensions 3 (SSSE3). A value of 0 indicates the instruction extensions are not present in the processor."); // Colorize: green
            cpuidLines.append("    CNXT_ID                   = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 10),   // \"cid\" L1 Context ID. A value of 1 indicates the L1 data cache mode can be set to either adaptive mode or shared mode. A value of 0 indicates this feature is not supported. See definition of the IA32_MISC_ENABLE MSR Bit 24 (L1 Data Cache Context Mode) for details."); // Colorize: green
            cpuidLines.append("    SDBG                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 11),   // A value of 1 indicates the processor supports IA32_DEBUG_INTERFACE MSR for silicon debug."); // Colorize: green
            cpuidLines.append("    FMA                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 12),   // A value of 1 indicates the processor supports FMA extensions using YMM state.");    // Colorize: green
            cpuidLines.append("    CMPXCHG16B                = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 13),   // \"cx16\" CMPXCHG16B Available. A value of 1 indicates that the feature is available. See the \"CMPXCHG8B/CMPXCHG16B-Compare and Exchange Bytes\" section in this chapter for a description."); // Colorize: green
            cpuidLines.append("    XTPR_UPDATE_CONTROL       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 14),   // \"xtpr\" xTPR Update Control. A value of 1 indicates that the processor supports changing IA32_MISC_ENABLE[bit 23]."); // Colorize: green
            cpuidLines.append("    PDCM                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 15),   // Perfmon and Debug Capability: A value of 1 indicates the processor supports the performance and debug feature indication MSR IA32_PERF_CAPABILITIES."); // Colorize: green
            cpuidLines.append("    PCID                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 17),   // Process-context identifiers. A value of 1 indicates that the processor supports PCIDs and that software may set CR4.PCIDE to 1."); // Colorize: green
            cpuidLines.append("    DCA                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 18),   // A value of 1 indicates the processor supports the ability to prefetch data from a memory mapped device."); // Colorize: green
            cpuidLines.append("    SSE4_1                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 19),   // A value of 1 indicates that the processor supports SSE4.1.");                       // Colorize: green
            cpuidLines.append("    SSE4_2                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 20),   // A value of 1 indicates that the processor supports SSE4.2.");                       // Colorize: green
            cpuidLines.append("    X2APIC                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 21),   // A value of 1 indicates that the processor supports x2APIC feature.");               // Colorize: green
            cpuidLines.append("    MOVBE                     = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 22),   // A value of 1 indicates that the processor supports MOVBE instruction.");            // Colorize: green
            cpuidLines.append("    POPCNT                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 23),   // A value of 1 indicates that the processor supports the POPCNT instruction.");       // Colorize: green
            cpuidLines.append("    TSC_DEADLINE              = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 24),   // \"tsc_deadline_timer\" A value of 1 indicates that the processor's local APIC timer supports one-shot operation using a TSC deadline value."); // Colorize: green
            cpuidLines.append("    AESNI                     = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 25),   // \"aes\" A value of 1 indicates that the processor supports the AESNI instruction extensions."); // Colorize: green
            cpuidLines.append("    XSAVE                     = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 26),   // A value of 1 indicates that the processor supports the XSAVE/XRSTOR processor extended states feature, the XSETBV/XGETBV instructions, and XCR0."); // Colorize: green
            cpuidLines.append("    OSXSAVE                   = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 27),   // \"\" A value of 1 indicates that the OS has set CR4.OSXSAVE[bit 18] to enable XSETBV/XGETBV instructions to access XCR0 and to support processor extended state management using XSAVE/XRSTOR."); // Colorize: green
            cpuidLines.append("    AVX                       = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 28),   // A value of 1 indicates the processor supports the AVX instruction extensions.");    // Colorize: green
            cpuidLines.append("    F16C                      = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 29),   // A value of 1 indicates that processor supports 16-bit floating-point conversion instructions."); // Colorize: green
            cpuidLines.append("    RDRAND                    = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 30),   // A value of 1 indicates that processor supports RDRAND instruction.");               // Colorize: green
            cpuidLines.append("    HYPERVISOR                = WORD_BIT(X86FeatureWord::CPUID_00000001_ECX, 31),   // Running on a hypervisor");                                                          // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000001_EDX");                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    FPU                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 0),    // Floating Point Unit On-Chip. The processor contains an x87 FPU.");                  // Colorize: green
            cpuidLines.append("    VME                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 1),    // Virtual 8086 Mode Enhancements. Virtual 8086 mode enhancements, including CR4.VME for controlling the feature, CR4.PVI for protected mode virtual interrupts, software interrupt indirection, expansion of the TSS with the software indirection bitmap, and EFLAGS.VIF and EFLAGS.VIP flags."); // Colorize: green
            cpuidLines.append("    DE                        = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 2),    // Debugging Extensions. Support for I/O breakpoints, including CR4.DE for controlling the feature, and optional trapping of accesses to DR4 and DR5."); // Colorize: green
            cpuidLines.append("    PSE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 3),    // Page Size Extension. Large pages of size 4 MByte are supported, including CR4.PSE for controlling the feature, the defined dirty bit in PDE (Page Directory Entries), optional reserved bit trapping in CR3, PDEs, and PTEs."); // Colorize: green
            cpuidLines.append("    TSC                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 4),    // Time Stamp Counter. The RDTSC instruction is supported, including CR4.TSD for controlling privilege."); // Colorize: green
            cpuidLines.append("    MSR                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 5),    // Model Specific Registers RDMSR and WRMSR Instructions. The RDMSR and WRMSR instructions are supported. Some of the MSRs are implementation dependent."); // Colorize: green
            cpuidLines.append("    PAE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 6),    // Physical Address Extension. Physical addresses greater than 32 bits are supported: extended page table entry formats, an extra level in the page translation tables is defined, 2-MByte pages are supported instead of 4 Mbyte pages if PAE bit is 1."); // Colorize: green
            cpuidLines.append("    MCE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 7),    // Machine Check Exception. Exception 18 is defined for Machine Checks, including CR4.MCE for controlling the feature. This feature does not define the model-specific implementations of machine-check error logging, reporting, and processor shutdowns. Machine Check exception handlers may have to depend on processor version to do model specific processing of the exception, or test for the presence of the Machine Check feature."); // Colorize: green
            cpuidLines.append("    CX8                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 8),    // CMPXCHG8B Instruction. The compare-and-exchange 8 bytes (64 bits) instruction is supported (implicitly locked and atomic)."); // Colorize: green
            cpuidLines.append("    APIC                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 9),    // APIC On-Chip. The processor contains an Advanced Programmable Interrupt Controller (APIC), responding to memory mapped commands in the physical address range FFFE0000H to FFFE0FFFH (by default - some processors permit the APIC to be relocated)."); // Colorize: green
            cpuidLines.append("    SEP                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 11),   // SYSENTER and SYSEXIT Instructions. The SYSENTER and SYSEXIT and associated MSRs are supported."); // Colorize: green
            cpuidLines.append("    MTRR                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 12),   // Memory Type Range Registers. MTRRs are supported. The MTRRcap MSR contains feature bits that describe what memory types are supported, how many variable MTRRs are supported, and whether fixed MTRRs are supported."); // Colorize: green
            cpuidLines.append("    PGE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 13),   // Page Global Bit. The global bit is supported in paging-structure entries that map a page, indicating TLB entries that are common to different processes and need not be flushed. The CR4.PGE bit controls this feature."); // Colorize: green
            cpuidLines.append("    MCA                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 14),   // Machine Check Architecture. A value of 1 indicates the Machine Check Architecture of reporting machine errors is supported. The MCG_CAP MSR contains feature bits describing how many banks of error reporting MSRs are supported."); // Colorize: green
            cpuidLines.append("    CMOV                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 15),   // Conditional Move Instructions. The conditional move instruction CMOV is supported. In addition, if x87 FPU is present as indicated by the CPUID.FPU feature bit, then the FCOMI and FCMOV instructions are supported"); // Colorize: green
            cpuidLines.append("    PAT                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 16),   // Page Attribute Table. Page Attribute Table is supported. This feature augments the Memory Type Range Registers (MTRRs), allowing an operating system to specify attributes of memory accessed through a linear address on a 4KB granularity."); // Colorize: green
            cpuidLines.append("    PSE_36                    = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 17),   // \"pse36\" 36-Bit Page Size Extension. 4-MByte pages addressing physical memory beyond 4 GBytes are supported with 32-bit paging. This feature indicates that upper bits of the physical address of a 4-MByte page are encoded in bits 20:13 of the page-directory entry. Such physical addresses are limited by MAXPHYADDR and may be up to 40 bits in size."); // Colorize: green
            cpuidLines.append("    PSN                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 18),   // \"pn\" Processor Serial Number. The processor supports the 96-bit processor identification number feature and the feature is enabled."); // Colorize: green
            cpuidLines.append("    CLFSH                     = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 19),   // \"clflush\" CLFLUSH Instruction. CLFLUSH Instruction is supported.");                 // Colorize: green
            cpuidLines.append("    DS                        = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 21),   // \"dts\" Debug Store. The processor supports the ability to write debug information into a memory resident buffer. This feature is used by the branch trace store (BTS) and processor event-based sampling (PEBS) facilities (see Chapter 23, \"Introduction to Virtual-Machine Extensions,\" in the Intel(R) 64 and IA-32 Architectures Software Developer's Manual, Volume 3C)."); // Colorize: green
            cpuidLines.append("    ACPI                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 22),   // Thermal Monitor and Software Controlled Clock Facilities. The processor implements internal MSRs that allow processor temperature to be monitored and processor performance to be modulated in predefined duty cycles under software control."); // Colorize: green
            cpuidLines.append("    MMX                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 23),   // Intel MMX Technology. The processor supports the Intel MMX technology.");           // Colorize: green
            cpuidLines.append("    FXSR                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 24),   // FXSAVE and FXRSTOR Instructions. The FXSAVE and FXRSTOR instructions are supported for fast save and restore of the floating point context. Presence of this bit also indicates that CR4.OSFXSR is available for an operating system to indicate that it supports the FXSAVE and FXRSTOR instructions."); // Colorize: green
            cpuidLines.append("    SSE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 25),   // SSE. The processor supports the SSE extensions.");                                  // Colorize: green
            cpuidLines.append("    SSE2                      = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 26),   // SSE2. The processor supports the SSE2 extensions.");                                // Colorize: green
            cpuidLines.append("    SS                        = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 27),   // Self Snoop. The processor supports the management of conflicting memory types by performing a snoop of its own cache structure for transactions issued to the bus."); // Colorize: green
            cpuidLines.append("    HTT                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 28),   // \"ht\" Max APIC IDs reserved field is Valid. A value of 0 for HTT indicates there is only a single logical processor in the package and software should assume only a single APIC ID is reserved. A value of 1 for HTT indicates the value in CPUID.1.EBX[23:16] (the Maximum number of addressable IDs for logical processors in this package) is valid for the package."); // Colorize: green
            cpuidLines.append("    TM                        = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 29),   // Thermal Monitor. The processor implements the thermal monitor automatic thermal control circuitry (TCC)."); // Colorize: green
            cpuidLines.append("    PBE                       = WORD_BIT(X86FeatureWord::CPUID_00000001_EDX, 31),   // Pending Break Enable. The processor supports the use of the FERR#/PBE# pin when the processor is in the stop-clock state (STPCLK# is asserted) to signal the processor that an interrupt is pending and that the processor should return to normal operation to handle the interrupt."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000006_EAX");                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    DTHERM                    = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 0),    // Digital temperature sensor is supported if set.");                                  // Colorize: green
            cpuidLines.append("    IDA                       = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 1),    // Intel Turbo Boost Technology available (see description of IA32_MISC_ENABLE[38])."); // Colorize: green
            cpuidLines.append("    ARAT                      = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 2),    // ARAT. APIC-Timer-always-running feature is supported if set.");                     // Colorize: green
            cpuidLines.append("    PLN                       = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 4),    // PLN. Power limit notification controls are supported if set.");                     // Colorize: green
            cpuidLines.append("    ECMD                      = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 5),    // ECMD. Clock modulation duty cycle extension is supported if set.");                 // Colorize: green
            cpuidLines.append("    PTS                       = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 6),    // PTM. Package thermal management is supported if set.");                             // Colorize: green
            cpuidLines.append("    HWP                       = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 7),    // HWP. HWP base registers (IA32_PM_ENABLE[bit 0], IA32_HWP_CAPABILITIES, IA32_HWP_REQUEST, IA32_HWP_STATUS) are supported if set."); // Colorize: green
            cpuidLines.append("    HWP_NOTIFY                = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 8),    // HWP_Notification. IA32_HWP_INTERRUPT MSR is supported if set.");                    // Colorize: green
            cpuidLines.append("    HWP_ACT_WINDOW            = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 9),    // HWP_Activity_Window. IA32_HWP_REQUEST[bits 41:32] is supported if set.");           // Colorize: green
            cpuidLines.append("    HWP_EPP                   = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 10),   // HWP_Energy_Performance_Preference. IA32_HWP_REQUEST[bits 31:24] is supported if set."); // Colorize: green
            cpuidLines.append("    HWP_PKG_REQ               = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 11),   // HWP_Package_Level_Request. IA32_HWP_REQUEST_PKG MSR is supported if set.");         // Colorize: green
            cpuidLines.append("    HDC                       = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 13),   // HDC. HDC base registers IA32_PKG_HDC_CTL, IA32_PM_CTL1, IA32_THREAD_STALL MSRs are supported if set."); // Colorize: green
            cpuidLines.append("    TURBO_BOOST_MAX_3         = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 14),   // Intel(R) Turbo Boost Max Technology 3.0 available.");                               // Colorize: green
            cpuidLines.append("    HWP_CAPABILITIES          = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 15),   // HWP Capabilities. Highest Performance change is supported if set.");                // Colorize: green
            cpuidLines.append("    HWP_PECI                  = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 16),   // HWP PECI override is supported if set.");                                           // Colorize: green
            cpuidLines.append("    FLEXIBLE_HWP              = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 17),   // Flexible HWP is supported if set.");                                                // Colorize: green
            cpuidLines.append("    FAST_ACCESS_MODE_HWP_REQ  = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 18),   // Fast access mode for the IA32_HWP_REQUEST MSR is supported if set.");               // Colorize: green
            cpuidLines.append("    HW_FEEDBACK               = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 19),   // HW_FEEDBACK. IA32_HW_FEEDBACK_PTR MSR, IA32_HW_FEEDBACK_CONFIG MSR, IA32_PACKAGE_THERM_STATUS MSR bit 26, and IA32_PACKAGE_THERM_INTERRUPT MSR bit 25 are supported if set."); // Colorize: green
            cpuidLines.append("    IGNORE_IDLE_PROCESSOR     = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 20),   // Ignoring Idle Logical Processor HWP request is supported if set.");                 // Colorize: green
            cpuidLines.append("    THREAD_DIRECTOR           = WORD_BIT(X86FeatureWord::CPUID_00000006_EAX, 23),   // Intel(R) Thread Director supported if set. IA32_HW_FEEDBACK_CHAR and IA32_HW_FEEDBACK_THREAD_CONFIG MSRs are supported if set."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000006_ECX");                                                                                                  // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    APERFMPERF                = WORD_BIT(X86FeatureWord::CPUID_00000006_ECX, 0),    // Hardware Coordination Feedback Capability (Presence of IA32_MPERF and IA32_APERF). The capability to provide a measure of delivered processor performance (since last reset of the counters), as a percentage of the expected processor performance when running at the TSC frequency."); // Colorize: green
            cpuidLines.append("    EPB                       = WORD_BIT(X86FeatureWord::CPUID_00000006_ECX, 3),    // The processor supports performance-energy bias preference if CPUID.06H:ECX.SETBH[bit 3] is set and it also implies the presence of a new architectural MSR called IA32_ENERGY_PERF_BIAS (1B0H). many classes is written into the Intel Thread Director Table by the hardware."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000007_0_EBX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    FSGSBASE                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 0),  // FSGSBASE. Supports RDFSBASE/RDGSBASE/WRFSBASE/WRGSBASE if 1.");                     // Colorize: green
            cpuidLines.append("    TSC_ADJUST                = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 1),  // IA32_TSC_ADJUST MSR is supported if 1.");                                           // Colorize: green
            cpuidLines.append("    SGX                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 2),  // SGX. Supports Intel(R) Software Guard Extensions (Intel(R) SGX Extensions) if 1."); // Colorize: green
            cpuidLines.append("    BMI1                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 3),  // BMI1.");                                                                            // Colorize: green
            cpuidLines.append("    HLE                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 4),  // HLE.");                                                                             // Colorize: green
            cpuidLines.append("    AVX2                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 5),  // AVX2.");                                                                            // Colorize: green
            cpuidLines.append("    FDP_EXCPTN_ONLY           = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 6),  // FDP_EXCPTN_ONLY. x87 FPU Data Pointer updated only on x87 exceptions if 1.");       // Colorize: green
            cpuidLines.append("    SMEP                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 7),  // SMEP. Supports Supervisor-Mode Execution Prevention if 1.");                        // Colorize: green
            cpuidLines.append("    BMI2                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 8),  // BMI2.");                                                                            // Colorize: green
            cpuidLines.append("    ERMS                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 9),  // Supports Enhanced REP MOVSB/STOSB if 1.");                                          // Colorize: green
            cpuidLines.append("    INVPCID                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 10), // INVPCID. If 1, supports INVPCID instruction for system software that manages process-context identifiers."); // Colorize: green
            cpuidLines.append("    RTM                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 11), // RTM.");                                                                             // Colorize: green
            cpuidLines.append("    CQM                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 12), // RDT-M. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Monitoring capability if 1."); // Colorize: green
            cpuidLines.append("    DEPRECATE_FPU_CS_DS       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 13), // Deprecates FPU CS and FPU DS values if 1.");                                        // Colorize: green
            cpuidLines.append("    MPX                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 14), // MPX. Supports Intel(R) Memory Protection Extensions if 1.");                        // Colorize: green
            cpuidLines.append("    RDT_A                     = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 15), // RDT-A. Supports Intel(R) Resource Director Technology (Intel(R) RDT) Allocation capability if 1."); // Colorize: green
            cpuidLines.append("    AVX512F                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 16), // AVX512F.");                                                                         // Colorize: green
            cpuidLines.append("    AVX512DQ                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 17), // AVX512DQ.");                                                                        // Colorize: green
            cpuidLines.append("    RDSEED                    = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 18), // RDSEED.");                                                                          // Colorize: green
            cpuidLines.append("    ADX                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 19), // ADX.");                                                                             // Colorize: green
            cpuidLines.append("    SMAP                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 20), // SMAP. Supports Supervisor-Mode Access Prevention (and the CLAC/STAC instructions) if 1."); // Colorize: green
            cpuidLines.append("    AVX512IFMA                = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 21), // AVX512_IFMA.");                                                                     // Colorize: green
            cpuidLines.append("    CLFLUSHOPT                = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 23), // CLFLUSHOPT.");                                                                      // Colorize: green
            cpuidLines.append("    CLWB                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 24), // CLWB.");                                                                            // Colorize: green
            cpuidLines.append("    INTEL_PT                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 25), // Intel Processor Trace.");                                                           // Colorize: green
            cpuidLines.append("    AVX512PF                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 26), // AVX512PF. (Intel(R) Xeon Phi(TM) only.)");                                          // Colorize: green
            cpuidLines.append("    AVX512ER                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 27), // AVX512ER. (Intel(R) Xeon Phi(TM) only.)");                                          // Colorize: green
            cpuidLines.append("    AVX512CD                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 28), // AVX512CD.");                                                                        // Colorize: green
            cpuidLines.append("    SHA_NI                    = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 29), // SHA. supports Intel(R) Secure Hash Algorithm Extensions (Intel(R) SHA Extensions) if 1."); // Colorize: green
            cpuidLines.append("    AVX512BW                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 30), // AVX512BW.");                                                                        // Colorize: green
            cpuidLines.append("    AVX512VL                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EBX, 31), // AVX512VL.");                                                                        // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000007_0_ECX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    PREFETCHWT1               = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 0),  // PREFETCHWT1. (Intel(R) Xeon Phi(TM) only.)");                                       // Colorize: green
            cpuidLines.append("    AVX512VBMI                = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 1),  // AVX512_VBMI.");                                                                     // Colorize: green
            cpuidLines.append("    UMIP                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 2),  // UMIP. Supports user-mode instruction prevention if 1.");                            // Colorize: green
            cpuidLines.append("    PKU                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 3),  // PKU. Supports protection keys for user-mode pages if 1.");                          // Colorize: green
            cpuidLines.append("    OSPKE                     = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 4),  // OSPKE. If 1, OS has set CR4.PKE to enable protection keys (and the RDPKRU/WRPKRU instructions)."); // Colorize: green
            cpuidLines.append("    WAITPKG                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 5),  // WAITPKG.");                                                                         // Colorize: green
            cpuidLines.append("    AVX512_VBMI2              = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 6),  // AVX512_VBMI2.");                                                                    // Colorize: green
            cpuidLines.append("    CET_SS                    = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 7),  // CET_SS. Supports CET shadow stack features if 1. Processors that set this bit define bits 1:0 of the IA32_U_CET and IA32_S_CET MSRs. Enumerates support for the following MSRs: IA32_INTERRUPT_SPP_TABLE_ADDR, IA32_PL3_SSP, IA32_PL2_SSP, IA32_PL1_SSP, and IA32_PL0_SSP."); // Colorize: green
            cpuidLines.append("    GFNI                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 8),  // GFNI.");                                                                            // Colorize: green
            cpuidLines.append("    VAES                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 9),  // VAES.");                                                                            // Colorize: green
            cpuidLines.append("    VPCLMULQDQ                = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 10), // VPCLMULQDQ.");                                                                      // Colorize: green
            cpuidLines.append("    AVX512_VNNI               = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 11), // AVX512_VNNI.");                                                                     // Colorize: green
            cpuidLines.append("    AVX512_BITALG             = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 12), // AVX512_BITALG.");                                                                   // Colorize: green
            cpuidLines.append("    TME                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 13), // TME_EN. If 1, the following MSRs are supported: IA32_TME_CAPABILITY, IA32_TME_ACTIVATE, IA32_TME_EXCLUDE_MASK, and IA32_TME_EXCLUDE_BASE."); // Colorize: green
            cpuidLines.append("    AVX512_VPOPCNTDQ          = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 14), // AVX512_VPOPCNTDQ.");                                                                // Colorize: green
            cpuidLines.append("    LA57                      = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 16), // LA57. Supports 57-bit linear addresses and five-level paging if 1.");               // Colorize: green
            cpuidLines.append("    RDPID                     = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 22), // RDPID and IA32_TSC_AUX are available if 1.");                                       // Colorize: green
            cpuidLines.append("    KL                        = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 23), // KL. Supports Key Locker if 1.");                                                    // Colorize: green
            cpuidLines.append("    CLDEMOTE                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 25), // CLDEMOTE. Supports cache line demote if 1.");                                       // Colorize: green
            cpuidLines.append("    MOVDIRI                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 27), // MOVDIRI. Supports MOVDIRI if 1.");                                                  // Colorize: green
            cpuidLines.append("    MOVDIR64B                 = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 28), // MOVDIR64B. Supports MOVDIR64B if 1.");                                              // Colorize: green
            cpuidLines.append("    SGX_LC                    = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 30), // SGX_LC. Supports SGX Launch Configuration if 1.");                                  // Colorize: green
            cpuidLines.append("    PKS                       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_ECX, 31), // PKS. Supports protection keys for supervisor-mode pages if 1.");                    // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000007_0_EDX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    AVX512_4VNNIW             = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 2),  // AVX512_4VNNIW. (Intel(R) Xeon Phi(TM) only.)");                                     // Colorize: green
            cpuidLines.append("    AVX512_4FMAPS             = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 3),  // AVX512_4FMAPS. (Intel(R) Xeon Phi(TM) only.)");                                     // Colorize: green
            cpuidLines.append("    FAST_MOV                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 4),  // Fast Short REP MOV.");                                                              // Colorize: green
            cpuidLines.append("    AVX512_VP2INTERSECT       = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 8),  // AVX512_VP2INTERSECT.");                                                             // Colorize: green
            cpuidLines.append("    MD_CLEAR                  = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 10), // MD_CLEAR supported.");                                                              // Colorize: green
            cpuidLines.append("    SERIALIZE                 = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 14), // SERIALIZE.");                                                                       // Colorize: green
            cpuidLines.append("    HYBRID                    = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 15), // Hybrid. If 1, the processor is identified as a hybrid part.");                      // Colorize: green
            cpuidLines.append("    PCONFIG                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 18), // PCONFIG. Supports PCONFIG if 1.");                                                  // Colorize: green
            cpuidLines.append("    CET_IBT                   = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 20), // CET_IBT. Supports CET indirect branch tracking features if 1. Processors that set this bit define bits 5:2 and bits 63:10 of the IA32_U_CET and IA32_S_CET MSRs."); // Colorize: green
            cpuidLines.append("    SPEC_CTRL                 = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 26), // \"\" Enumerates support for indirect branch restricted speculation (IBRS) and the indirect branch predictor barrier (IBPB). Processors that set this bit support the IA32_SPEC_CTRL MSR and the IA32_PRED_CMD MSR. They allow software to set IA32_SPEC_CTRL[0] (IBRS) and IA32_PRED_CMD[0] (IBPB)."); // Colorize: green
            cpuidLines.append("    INTEL_STIBP               = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 27), // \"\" Enumerates support for single thread indirect branch predictors (STIBP). Processors that set this bit support the IA32_SPEC_CTRL MSR. They allow software to set IA32_SPEC_CTRL[1] (STIBP)."); // Colorize: green
            cpuidLines.append("    FLUSH_L1D                 = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 28), // Enumerates support for L1D_FLUSH. Processors that set this bit support the IA32_FLUSH_CMD MSR. They allow software to set IA32_FLUSH_CMD[0] (L1D_FLUSH)."); // Colorize: green
            cpuidLines.append("    ARCH_CAPABILITIES         = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 29), // Enumerates support for the IA32_ARCH_CAPABILITIES MSR.");                           // Colorize: green
            cpuidLines.append("    CORE_CAPABILITIES         = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 30), // Enumerates support for the IA32_CORE_CAPABILITIES MSR. IA32_CORE_CAPABILITIES is an architectural MSR that enumerates model-specific features. A bit being set in this MSR indicates that a model specific feature is supported; software must still consult CPUID family/model/stepping to determine the behavior of the enumerated feature as features enumerated in IA32_CORE_CAPABILITIES may have different behavior on different processor models. Additionally, on hybrid parts (CPUID.07H.0H:EDX[15]=1), software must consult the native model ID and core type from the Hybrid Information Enumeration Leaf."); // Colorize: green
            cpuidLines.append("    SPEC_CTRL_SSBD            = WORD_BIT(X86FeatureWord::CPUID_00000007_0_EDX, 31), // \"\" Enumerates support for Speculative Store Bypass Disable (SSBD). Processors that set this bit support the IA32_SPEC_CTRL MSR. They allow software to set IA32_SPEC_CTRL[2] (SSBD)."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000007_1_EAX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    AVX_VNNI                  = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 4),  // AVX-VNNI. AVX (VEX-encoded) versions of the Vector Neural Network Instructions.");  // Colorize: green
            cpuidLines.append("    AVX512_BF16               = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 5),  // AVX512_BF16. Vector Neural Network Instructions supporting BFLOAT16 inputs and conversion instructions from IEEE single precision."); // Colorize: green
            cpuidLines.append("    FAST_MOVSB                = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 10), // If 1, supports fast zero-length REP MOVSB.");                                       // Colorize: green
            cpuidLines.append("    FAST_STOSB                = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 11), // If 1, supports fast short REP STOSB.");                                             // Colorize: green
            cpuidLines.append("    FATS_CMPSB_SCASB          = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 12), // If 1, supports fast short REP CMPSB, REP SCASB.");                                  // Colorize: green
            cpuidLines.append("    HRESET                    = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EAX, 22), // HRESET. If 1, supports history reset via the HRESET instruction and the IA32_HRESET_ENABLE MSR. When set, indicates that the Processor History Reset Leaf (EAX = 20H) is valid."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000007_1_EBX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    PPIN                      = WORD_BIT(X86FeatureWord::CPUID_00000007_1_EBX, 0),  // Enumerates the presence of the IA32_PPIN and IA32_PPIN_CTL MSRs. If 1, these MSRs are supported."); // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_0000000D_1_EAX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    XSAVEOPT                  = WORD_BIT(X86FeatureWord::CPUID_0000000D_1_EAX, 0),  // XSAVEOPT is available.");                                                           // Colorize: green
            cpuidLines.append("    XSAVEC                    = WORD_BIT(X86FeatureWord::CPUID_0000000D_1_EAX, 1),  // Supports XSAVEC and the compacted form of XRSTOR if set.");                         // Colorize: green
            cpuidLines.append("    XGETBV1                   = WORD_BIT(X86FeatureWord::CPUID_0000000D_1_EAX, 2),  // Supports XGETBV with ECX = 1 if set.");                                             // Colorize: green
            cpuidLines.append("    XSAVES                    = WORD_BIT(X86FeatureWord::CPUID_0000000D_1_EAX, 3),  // Supports XSAVES/XRSTORS and IA32_XSS if set.");                                     // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_0000000F_0_EDX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    CQM_LLC                   = WORD_BIT(X86FeatureWord::CPUID_0000000F_0_EDX, 1),  // Supports L3 Cache Intel RDT Monitoring if 1.");                                     // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_0000000F_1_EDX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    CQM_OCCUP_LLC             = WORD_BIT(X86FeatureWord::CPUID_0000000F_1_EDX, 0),  // Supports L3 occupancy monitoring if 1.");                                           // Colorize: green
            cpuidLines.append("    CQM_MBM_TOTAL             = WORD_BIT(X86FeatureWord::CPUID_0000000F_1_EDX, 1),  // Supports L3 Total Bandwidth monitoring if 1.");                                     // Colorize: green
            cpuidLines.append("    CQM_MBM_LOCAL             = WORD_BIT(X86FeatureWord::CPUID_0000000F_1_EDX, 2),  // Supports L3 Local Bandwidth monitoring if 1.");                                     // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000010_0_EBX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    CAT_L3                    = WORD_BIT(X86FeatureWord::CPUID_00000010_0_EBX, 1),  // Supports L3 Cache Allocation Technology if 1.");                                    // Colorize: green
            cpuidLines.append("    CAT_L2                    = WORD_BIT(X86FeatureWord::CPUID_00000010_0_EBX, 2),  // Supports L2 Cache Allocation Technology if 1.");                                    // Colorize: green
            cpuidLines.append("    MBA                       = WORD_BIT(X86FeatureWord::CPUID_00000010_0_EBX, 3),  // Supports Memory Bandwidth Allocation if 1.");                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("");                                                                                                                                                                       // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    // Intel-defined CPU features, X86FeatureWord::CPUID_00000010_1_ECX");                                                                                                // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    CDP_L3                    = WORD_BIT(X86FeatureWord::CPUID_00000010_1_ECX, 2),  // Code and Data Prioritization Technology supported if 1.");                          // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Insert AMD features                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            for (qint64 i = 0; i < groups.size(); ++i)                                                                                                                                                                                           // Colorize: green
            {                                                                                                                                                                                                // Colorize: green
                cpuidLines.append("");                                                                                                                                                                   // Colorize: green
                cpuidLines.append("");                                                                                                                                                                   // Colorize: green
                cpuidLines.append("");                                                                                                                                                                   // Colorize: green
                cpuidLines.append("    //");                                                                                                                                                                              // Colorize: green
                cpuidLines.append("    // " + groups.at(i));                                                                                                                                                                              // Colorize: green
                cpuidLines.append("    //");                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                const QStringList &fields       = fieldGroups.at(i);                                                                                                                                         // Colorize: green
                const QStringList &values       = valueGroups.at(i);                                                                                                                                         // Colorize: green
                const QStringList &descriptions = descriptionGroups.at(i);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                             // Colorize: green
                for (qint64 j = 0; j < fields.size(); ++j)                                                                                                                                                   // Colorize: green
                {                                                                                                                                                                                            // Colorize: green
                    cpuidLines.append(QString("    %1 = %2,%3 // %4")                                                                                                                                       // Colorize: green
                                                .arg(fields.at(j), -25, QChar(' '))                                                                                                                          // Colorize: green
                                                .arg(values.at(j))                                                                                                                                           // Colorize: green
                                                .arg("", 50 - values.at(j).length(), QChar(' '))                                                                                                             // Colorize: green
                                                .arg(descriptions.at(j))                                                                                                                                     // Colorize: green
                    );                                                                                                                                                                                       // Colorize: green
                }                                                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                   // Colorize: green
        // Insert NGOS other features                                                                                                                                                              // Colorize: green
        {                                                                                                                                                                                          // Colorize: green
            cpuidLines.append("");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("");                                                                                                                                                                 // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                               // Colorize: green
            cpuidLines.append("    // Other features, X86FeatureWord::NGOS_OTHER_FEATURES");                                                                                                                         // Colorize: green
            cpuidLines.append("    //");                                                                                                                                                               // Colorize: green
            cpuidLines.append("    ALWAYS_ZERO               = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 0),   // \"\" Always-absent feature");                                                    // Colorize: green
            cpuidLines.append("    CPUID                     = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 1),   // CPU has CPUID instruction itself");                                              // Colorize: green
            cpuidLines.append("    CONSTANT_TSC              = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 2),   // TSC ticks at a constant rate");                                                  // Colorize: green
            cpuidLines.append("    NONSTOP_TSC               = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 3),   // TSC doesn't stop in C states");                                                  // Colorize: green
            cpuidLines.append("    NONSTOP_TSC_S3            = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 4),   // TSC doesn't stop in S3 state");                                                  // Colorize: green
            cpuidLines.append("    MSR_SPEC_CTRL             = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 5),   // \"\" MSR SPEC_CTRL is implemented");                                             // Colorize: green
            cpuidLines.append("    IBRS                      = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 6),   // Indirect Branch Restricted Speculation");                                        // Colorize: green
            cpuidLines.append("    IBPB                      = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 7),   // Indirect Branch Prediction Barrier");                                            // Colorize: green
            cpuidLines.append("    STIBP                     = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 8),   // Single Thread Indirect Branch Predictors");                                      // Colorize: green
            cpuidLines.append("    SSBD                      = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 9),   // Speculative Store Bypass Disable");                                              // Colorize: green
            cpuidLines.append("    IBRS_ENHANCED             = WORD_BIT(X86FeatureWord::NGOS_OTHER_FEATURES, 10)   // Enhanced IBRS");                                                                 // Colorize: green
        }                                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        cpuidLines.append("};");                                                                                                                                                                          // Colorize: green
        cpuidLines.append(QString("// Verified with AmdCpuidSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(AMD_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        cpuidLines.append("// Verified with IntelCpuidSpecVerifier [END] // https://cdrdv2.intel.com/v1/dl/getContent/671199");                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(cpuidLines, thread->getPath() + "/" + X86_FEATURE_H))                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check AMD X86 Features with specification");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
AmdCpuidSpecVerifier amdCpuidSpecVerifier;                                                                                                                                                               // Colorize: green
