#include "elfspecverifier.h"                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define ELF_SPECIFICATION_URL "https://www.uclibc.org/docs/elf-64-gen.pdf" // Version: 1.5 Draft 2 May 27, 1998                                                                                                               // Colorize: green
#define ELF_PDF               "elf.pdf"                                                                                                                                                                  // Colorize: green
#define ELF_TXT               "elf.txt"                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define ELF_HEADER_H                     "src/os/shared/common/src/com/ngos/shared/common/elf/header.h"                                                                                                  // Colorize: green
#define ELF_HEADER_IDENTIFICATION_H      "src/os/shared/common/src/com/ngos/shared/common/elf/headeridentification.h"                                                                                    // Colorize: green
#define ELF_CLASS_H                      "src/os/shared/common/src/com/ngos/shared/common/elf/class.h"                                                                                                   // Colorize: green
#define ELF_DATA_H                       "src/os/shared/common/src/com/ngos/shared/common/elf/data.h"                                                                                                    // Colorize: green
#define ELF_FILE_VERSION_H               "src/os/shared/common/src/com/ngos/shared/common/elf/fileversion.h"                                                                                             // Colorize: green
#define ELF_VERSION_H                    "src/os/shared/common/src/com/ngos/shared/common/elf/version.h"                                                                                                 // Colorize: green
#define ELF_OS_ABI_H                     "src/os/shared/common/src/com/ngos/shared/common/elf/osabi.h"                                                                                                   // Colorize: green
#define ELF_TYPE_H                       "src/os/shared/common/src/com/ngos/shared/common/elf/type.h"                                                                                                    // Colorize: green
#define ELF_MACHINE_H                    "src/os/shared/common/src/com/ngos/shared/common/elf/machine.h"                                                                                                 // Colorize: green
#define ELF_HEADER_FLAGS_H               "src/os/shared/common/src/com/ngos/shared/common/elf/headerflags.h"                                                                                             // Colorize: green
#define ELF_SECTION_HEADER_TABLE_ENTRY_H "src/os/shared/common/src/com/ngos/shared/common/elf/sectionheadertableentry.h"                                                                                 // Colorize: green
#define ELF_SECTION_TYPE_H               "src/os/shared/common/src/com/ngos/shared/common/elf/sectiontype.h"                                                                                             // Colorize: green
#define ELF_SECTION_FLAGS_H              "src/os/shared/common/src/com/ngos/shared/common/elf/sectionflags.h"                                                                                            // Colorize: green
#define ELF_SYMBOL_H                     "src/os/shared/common/src/com/ngos/shared/common/elf/symbol.h"                                                                                                  // Colorize: green
#define ELF_SYMBOL_INFO_H                "src/os/shared/common/src/com/ngos/shared/common/elf/symbolinfo.h"                                                                                              // Colorize: green
#define ELF_SYMBOL_BIND_H                "src/os/shared/common/src/com/ngos/shared/common/elf/symbolbind.h"                                                                                              // Colorize: green
#define ELF_SYMBOL_TYPE_H                "src/os/shared/common/src/com/ngos/shared/common/elf/symboltype.h"                                                                                              // Colorize: green
#define ELF_SYMBOL_OTHER_H               "src/os/shared/common/src/com/ngos/shared/common/elf/symbolother.h"                                                                                             // Colorize: green
#define ELF_SYMBOL_VISIBILITY_H          "src/os/shared/common/src/com/ngos/shared/common/elf/symbolvisibility.h"                                                                                        // Colorize: green
#define ELF_REL_H                        "src/os/shared/common/src/com/ngos/shared/common/elf/rel.h"                                                                                                     // Colorize: green
#define ELF_RELA_H                       "src/os/shared/common/src/com/ngos/shared/common/elf/rela.h"                                                                                                    // Colorize: green
#define ELF_RELOCATION_TYPE_H            "src/os/shared/common/src/com/ngos/shared/common/elf/relocationtype.h"                                                                                          // Colorize: green
#define ELF_PROGRAM_HEADER_TABLE_ENTRY_H "src/os/shared/common/src/com/ngos/shared/common/elf/programheadertableentry.h"                                                                                 // Colorize: green
#define ELF_PROGRAM_TYPE_H               "src/os/shared/common/src/com/ngos/shared/common/elf/programtype.h"                                                                                             // Colorize: green
#define ELF_PROGRAM_FLAGS_H              "src/os/shared/common/src/com/ngos/shared/common/elf/programflags.h"                                                                                            // Colorize: green
#define ELF_DYNAMIC_H                    "src/os/shared/common/src/com/ngos/shared/common/elf/dynamic.h"                                                                                                 // Colorize: green
#define ELF_DYNAMIC_TAG_H                "src/os/shared/common/src/com/ngos/shared/common/elf/dynamictag.h"                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
ElfSpecVerifier::ElfSpecVerifier()                                                                                                                                                                       // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mElfTypeToNgosTypeMap()                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Addr",    "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Off",     "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Half",    "u16");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Word",    "u32");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Sword",   "i32");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Xword",   "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Sxword",  "i64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("unsigned char", "u8");                                                                                                                                                 // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!downloadSpecification(thread, ELF_SPECIFICATION_URL, specContent))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some special characters                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        specContent.replace(QChar(0x2018), '\''); // Replace left single quotation mark  // https://www.compart.com/en/unicode/U+2018                                                                    // Colorize: green
        specContent.replace(QChar(0x2019), '\''); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+2019                                                                    // Colorize: green
        specContent.replace(QChar(0x201C), '\"'); // Replace left double quotation mark  // https://www.compart.com/en/unicode/U+201C                                                                    // Colorize: green
        specContent.replace(QChar(0x201D), '\"'); // Replace right double quotation mark // https://www.compart.com/en/unicode/U+201D                                                                    // Colorize: green
        specContent.replace(QChar(0x2022), '*');  // Replace bullet                      // https://www.compart.com/en/unicode/U+2022                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
bool ElfSpecVerifier::downloadSpecification(SpecVerifyThread *thread, const QString &url, QString &specContent)                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(url    != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for ELF specification");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply;                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Send network request                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QNetworkRequest request;                                                                                                                                                                     // Colorize: green
            request.setUrl(QUrl(url));                                                                                                                                                 // Colorize: green
            reply = manager.get(request);                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Wait for finish                                                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QEventLoop waitLoop;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
            QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            waitLoop.exec();                                                                                                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Check status code                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (statusCode.toInt() != 200)                                                                                                                                                               // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to get ELF specification from: %1 (%2 - %3)")                                                                                                                     // Colorize: green
                                            .arg(url)                                                                                                                                  // Colorize: green
                                            .arg(statusCode.toInt())                                                                                                                  // Colorize: green
                                            .arg(reply->errorString())                                                                                                                 // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                delete reply;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Write documentation to file                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QFile file(tempDir.path() + "/" + ELF_PDF);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!file.open(QIODevice::WriteOnly))                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError("Failed to create temporary file for ELF specification");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return false;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            file.write(content);                                                                                                                                                                         // Colorize: green
            file.close();                                                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << ELF_PDF << ELF_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + ELF_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open ELF specification");                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return false;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent += QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return true;                                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    qint64 errorsBefore = thread->getErrors().size();                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check code with specification                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        checkElfSpecification(thread, specContent);                                                                                                                                                      // Colorize: green
        checkElfHeader(thread, specContent);                                                                                                                                                             // Colorize: green
        checkElfHeaderIdentification(thread, specContent);                                                                                                                                               // Colorize: green
        checkElfClass(thread, specContent);                                                                                                                                                              // Colorize: green
        checkElfData(thread, specContent);                                                                                                                                                               // Colorize: green
        checkElfFileVersion(thread, specContent);                                                                                                                                                        // Colorize: green
        checkElfVersion(thread, specContent);                                                                                                                                                            // Colorize: green
        checkElfOsAbi(thread, specContent);                                                                                                                                                              // Colorize: green
        checkElfType(thread, specContent);                                                                                                                                                               // Colorize: green
        checkElfMachine(thread, specContent);                                                                                                                                                            // Colorize: green
        checkElfFlags(thread, specContent);                                                                                                                                                              // Colorize: green
        checkElfSectionHeaderTableEntry(thread, specContent);                                                                                                                                            // Colorize: green
        checkElfSectionTypes(thread, specContent);                                                                                                                                                       // Colorize: green
        checkElfSectionFlags(thread, specContent);                                                                                                                                                       // Colorize: green
        checkElfSymbol(thread, specContent);                                                                                                                                                             // Colorize: green
        checkElfSymbolInfo(thread, specContent);                                                                                                                                                         // Colorize: green
        checkElfSymbolBind(thread, specContent);                                                                                                                                                         // Colorize: green
        checkElfSymbolType(thread, specContent);                                                                                                                                                         // Colorize: green
        checkElfSymbolOther(thread, specContent);                                                                                                                                                        // Colorize: green
        checkElfSymbolVisibility(thread, specContent);                                                                                                                                                   // Colorize: green
        checkElfRel(thread, specContent);                                                                                                                                                                // Colorize: green
        checkElfRela(thread, specContent);                                                                                                                                                               // Colorize: green
        checkElfRelocationType(thread, specContent);                                                                                                                                                     // Colorize: green
        checkElfProgramHeaderTableEntry(thread, specContent);                                                                                                                                            // Colorize: green
        checkElfProgramTypes(thread, specContent);                                                                                                                                                       // Colorize: green
        checkElfProgramFlags(thread, specContent);                                                                                                                                                       // Colorize: green
        checkElfDynamic(thread, specContent);                                                                                                                                                            // Colorize: green
        checkElfDynamicTag(thread, specContent);                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (thread->getErrors().size() == errorsBefore)                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Code verified with ELF specification");                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    else                                                                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addMessage("Found error in code with ELF specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "ELF-64 Object File Format\n"                                                                                                                                                                // Colorize: green
            "Version 1.5 Draft 2\n"                                                                                                                                                                      // Colorize: green
            "May 27, 1998";                                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF specification version didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfHeader(SpecVerifyThread *thread, const QString &specContent)                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString headerText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init headerText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerText =                                                                                                                                                                                     // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "unsigned char\n"                                                                                                                                                                            // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Off\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Off\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "} Elf64_Ehdr;\n"                                                                                                                                                                            // Colorize: green
            "Figure 2. ELF-64 Header\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "e_ident[16];\n"                                                                                                                                                                             // Colorize: green
            "e_type;\n"                                                                                                                                                                                  // Colorize: green
            "e_machine;\n"                                                                                                                                                                               // Colorize: green
            "e_version;\n"                                                                                                                                                                               // Colorize: green
            "e_entry;\n"                                                                                                                                                                                 // Colorize: green
            "e_phoff;\n"                                                                                                                                                                                 // Colorize: green
            "e_shoff;\n"                                                                                                                                                                                 // Colorize: green
            "e_flags;\n"                                                                                                                                                                                 // Colorize: green
            "e_ehsize;\n"                                                                                                                                                                                // Colorize: green
            "e_phentsize;\n"                                                                                                                                                                             // Colorize: green
            "e_phnum;\n"                                                                                                                                                                                 // Colorize: green
            "e_shentsize;\n"                                                                                                                                                                             // Colorize: green
            "e_shnum;\n"                                                                                                                                                                                 // Colorize: green
            "e_shstrndx;";                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(headerText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Header specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = headerText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Ehdr;")                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i >= lines.size())                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        ++i;                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            i >= lines.size() - 1                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(i) != "Figure 2. ELF-64 Header"                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(i + 1) != ""                                                                                                                                                                        // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i += 2;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field names                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (fieldTypes.size() != fieldNames.size())                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to parse ELF header specification");                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_ident[16]", "identification");                                                                                                                           // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_type",      "type");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_machine",   "machine");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_version",   "version");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_entry",     "entryPoint");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phoff",     "programHeaderTableOffset");                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shoff",     "sectionHeaderTableOffset");                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_flags",     "flags");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_ehsize",    "headerSize");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phentsize", "programHeaderTableEntrySize");                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phnum",     "programHeaderTableEntryCount");                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shentsize", "sectionHeaderTableEntrySize");                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shnum",     "sectionHeaderTableEntryCount");                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shstrndx",  "sectionHeaderTableNamesIndex");                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList headerLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        headerLines.append("struct ElfHeader");                                                                                                                                                          // Colorize: green
        headerLines.append("{");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1")                                                                                                                               // Colorize: green
                                            .arg(fieldTypes.at(i))                                                                                                                                       // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1")                                                                                                                                // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            headerLines.append(QString("    %1 %2;")                                                                                                                                                     // Colorize: green
                                        .arg(type, -23, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(name)                                                                                                                                                       // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        headerLines.append("};");                                                                                                                                                                        // Colorize: green
        headerLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.replaceInStrings("    u8                      identification;", "    ElfHeaderIdentification identification;");                                                                      // Colorize: green
        headerLines.replaceInStrings("    u16                     type;",           "    ElfType                 type;");                                                                                // Colorize: green
        headerLines.replaceInStrings("    u16                     machine;",        "    ElfMachine              machine;");                                                                             // Colorize: green
        headerLines.replaceInStrings("    u32                     version;",        "    ElfVersion              version;");                                                                             // Colorize: green
        headerLines.replaceInStrings("    u32                     flags;",          "    ElfHeaderFlags          flags;");                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(headerLines, thread->getPath() + "/" + ELF_HEADER_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Header with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfHeaderIdentification(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString identificationText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init identificationText                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        identificationText =                                                                                                                                                                             // Colorize: green
            "e_ident identify the file as an ELF object file, and provide information\n"                                                                                                                 // Colorize: green
            "about the data representation of the object file structures. The bytes of this\n"                                                                                                           // Colorize: green
            "array that have defined meanings are detailed below. The remaining bytes\n"                                                                                                                 // Colorize: green
            "are reserved for future use, and should be set to zero. Each byte of the\n"                                                                                                                 // Colorize: green
            "array is indexed symbolically using the names in the Table 2.\n"                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Table 2. ELF Identification, e_ident\n"                                                                                                                                                     // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Purpose\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_MAG0\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "File identification\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_MAG1\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_MAG2\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_MAG3\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_CLASS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "File class\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_DATA\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "5\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Data encoding\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_VERSION\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "File version\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_OSABI\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "OS/ABI identification\n"                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_ABIVERSION\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ABI version\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_PAD\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Start of padding bytes\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "EI_NIDENT\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size of e_ident[]";                                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(identificationText))                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Header Identification specification didn't match with the stored one");                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = identificationText.split('\n');                                                                                                                                                  // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(11) != "Purpose" || lines.at(12) != "")                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header identification specification");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 13;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(line);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 4;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (line.startsWith("EI_MAG") && line != "EI_MAG0")                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                descriptions.append("");                                                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                descriptions.append(lines.at(i));                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                        // Colorize: green
                i += 2;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList identificationLines;                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        identificationLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        identificationLines.append("struct ElfHeaderIdentification");                                                                                                                                    // Colorize: green
        identificationLines.append("{");                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            fields.at(0) == "EI_MAG0"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(1) == "EI_MAG1"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(2) == "EI_MAG2"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(3) == "EI_MAG3"                                                                                                                                                                    // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            identificationLines.append("    u32            signature;  // " + descriptions.constFirst());                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 4; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field       = fields.at(i);                                                                                                                                                                // Colorize: green
            QString description = descriptions.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "EI_CLASS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfClass       fileClass;  // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_DATA")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfData        fileData;   // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_VERSION")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfFileVersion version;    // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_OSABI")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfOsAbi       osAbi;      // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_ABIVERSION")                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    u8             abiVersion; // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_PAD")                                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    u8             __pad[7];   // " + description);                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field != "EI_NIDENT")                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unknown field found in ELF header identification specification: %1")                                                                                           // Colorize: green
                                            .arg(field)                                                                                                                                                  // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        identificationLines.append("} __attribute__((packed));");                                                                                                                                        // Colorize: green
        identificationLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + ELF_HEADER_IDENTIFICATION_H);                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(identificationLines, fileLines))                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Header Identification with specification");                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString magicNumberText;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init magicNumberText                                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        magicNumberText =                                                                                                                                                                                // Colorize: green
            "e_ident[EI_MAG0] through e_ident[EI_MAG3] contain a \"magic number,\"\n"                                                                                                                    // Colorize: green
            "identifying the file as an ELF object file. They contain the characters '\\x7f',\n"                                                                                                         // Colorize: green
            "'E', 'L', and 'F', respectively.";                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(magicNumberText))                                                                                                                                                      // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Header Magic Number specification didn't match with the stored one");                                                                                                  // Colorize: green
            thread->addError(specContent);                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList magicNumberLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        magicNumberLines.append(QString("// Verified with ElfSpecVerifier // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        magicNumberLines.append("#define ELF_SIGNATURE 0x464C457F // 0x7F + ELF");                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(magicNumberLines, fileLines))                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Header Magic Number with specification");                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfClass(SpecVerifyThread *thread, const QString &specContent)                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString classText;                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init classText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        classText =                                                                                                                                                                                      // Colorize: green
            "Table 3. Object File Classes, e_ident[EI_CLASS]\n"                                                                                                                                          // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFCLASS32\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "32-bit objects\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFCLASS64\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "64-bit objects";                                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(classText))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Class specification didn't match with the stored one");                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = classText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF class specification");                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFCLASS32", "CLASS_32");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFCLASS64", "CLASS_64");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList classLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        classLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        classLines.append("enum class ElfClass: u8");                                                                                                                                                    // Colorize: green
        classLines.append("{");                                                                                                                                                                          // Colorize: green
        classLines.append("    NONE     = 0,");                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            classLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                                   // Colorize: green
                                        .arg(field, -8, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                          // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                         // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        classLines.append("};");                                                                                                                                                                         // Colorize: green
        classLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(classLines, thread->getPath() + "/" + ELF_CLASS_H))                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Class with specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfData(SpecVerifyThread *thread, const QString &specContent)                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString dataText;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init dataText                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dataText =                                                                                                                                                                                       // Colorize: green
            "Table 4. Data Encodings, e_ident[EI_DATA]\n"                                                                                                                                                // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFDATA2LSB\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Object file data structures are littleendian\n"                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFDATA2MSB\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Object file data structures are bigendian";                                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(dataText))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Data specification didn't match with the stored one");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = dataText.split('\n');                                                                                                                                                            // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF data specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFDATA2LSB", "LEAST_SIGNIFICANT_BYTE");                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFDATA2MSB", "MOST_SIGNIFICANT_BYTE");                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList dataLines;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dataLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        dataLines.append("enum class ElfData: u8");                                                                                                                                                      // Colorize: green
        dataLines.append("{");                                                                                                                                                                           // Colorize: green
        dataLines.append("    NONE                   = 0,");                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            dataLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                                    // Colorize: green
                                        .arg(field, -22, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                           // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                               // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        dataLines.append("};");                                                                                                                                                                          // Colorize: green
        dataLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(dataLines, thread->getPath() + "/" + ELF_DATA_H))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Data with specification");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfFileVersion(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "e_ident[EI_VERSION] identifies the version of the object file format.\n"                                                                                                                    // Colorize: green
            "Currently, this field has the value EV_CURRENT, which is defined with the\n"                                                                                                                // Colorize: green
            "value 1.";                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF File Version specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList versionLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        versionLines.append("enum class ElfFileVersion: u8");                                                                                                                                            // Colorize: green
        versionLines.append("{");                                                                                                                                                                        // Colorize: green
        versionLines.append("    NONE    = 0,");                                                                                                                                                         // Colorize: green
        versionLines.append("    CURRENT = 1");                                                                                                                                                          // Colorize: green
        versionLines.append("};");                                                                                                                                                                       // Colorize: green
        versionLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(versionLines, thread->getPath() + "/" + ELF_FILE_VERSION_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF File Version with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfVersion(SpecVerifyThread *thread, const QString &specContent)                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText =                                                                                                                                                                                    // Colorize: green
            "e_version identifies the version of the object file format. Currently, this\n"                                                                                                              // Colorize: green
            "field has the value EV_CURRENT, which is defined with the value 1.";                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Version specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList versionLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        versionLines.append("enum class ElfVersion: u32");                                                                                                                                               // Colorize: green
        versionLines.append("{");                                                                                                                                                                        // Colorize: green
        versionLines.append("    NONE    = 0,");                                                                                                                                                         // Colorize: green
        versionLines.append("    CURRENT = 1");                                                                                                                                                          // Colorize: green
        versionLines.append("};");                                                                                                                                                                       // Colorize: green
        versionLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(versionLines, thread->getPath() + "/" + ELF_VERSION_H))                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Version with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfOsAbi(SpecVerifyThread *thread, const QString &specContent)                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString osAbiText;                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init osAbiText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiText =                                                                                                                                                                                      // Colorize: green
            "Table 5. Operating System and ABI Identifiers, e_ident[EI_OSABI]\n"                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFOSABI_SYSV\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "System V ABI\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFOSABI_HPUX\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "HP-UX operating system\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ELFOSABI_STANDALONE\n"                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "255\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Standalone (embedded)\n"                                                                                                                                                                    // Colorize: green
            "application";                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(osAbiText))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF OS ABI specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = osAbiText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF OS ABI specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "ELFOSABI_STANDALONE")                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 5;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 4;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_SYSV",       "SYSTEM_V");                                                                                                                         // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_HPUX",       "HP_UX");                                                                                                                            // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_STANDALONE", "STANDALONE");                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList osAbiLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        osAbiLines.append("enum class ElfOsAbi: u8");                                                                                                                                                    // Colorize: green
        osAbiLines.append("{");                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = "0x" + QString("%1")                                                                                                                                                         // Colorize: green
                            .arg(values.at(i).toUShort(), 2, 16, QChar('0'))                                                                                                                             // Colorize: green
                            .toUpper();                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "0x00")                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value = "0";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            osAbiLines.append(QString("    %1 = %2%3")                                                                                                                                                   // Colorize: green
                                        .arg(field, -14, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(value)                                                                                                                                                      // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : "")                                                                                                                           // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        osAbiLines.append("};");                                                                                                                                                                         // Colorize: green
        osAbiLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiLines.insert(5,  "    NETBSD         = 0x02,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(6,  "    LINUX          = 0x03,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(7,  "    GNU_HURD       = 0x04,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(8,  "    SOLARIS        = 0x06,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(9,  "    AIX            = 0x07,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(10, "    IRIX           = 0x08,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(11, "    FREEBSD        = 0x09,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(12, "    TRU64          = 0x0A,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(13, "    NOVELL_MODESTO = 0x0B,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(14, "    OPENBSD        = 0x0C,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(15, "    OPENVMS        = 0x0D,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(16, "    NONSTOP_KERNEL = 0x0E,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(17, "    AROS           = 0x0F,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(18, "    FENIX_OS       = 0x10,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(19, "    CLOUD_ABI      = 0x11,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(20, "    SORTIX         = 0x53,");                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(osAbiLines, thread->getPath() + "/" + ELF_OS_ABI_H))                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF OS ABI with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfType(SpecVerifyThread *thread, const QString &specContent)                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString typeText;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init typeText                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        typeText =                                                                                                                                                                                       // Colorize: green
            "Table 6. Object File Types, e_type\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4.\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_NONE\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "No file type\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_REL\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Relocatable object file\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_EXEC\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Executable file\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_DYN\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Shared object file\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_CORE\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Core file\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_LOOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xFE00\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_HIOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xFEFF\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_LOPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xFF00\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ET_HIPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xFFFF\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(typeText))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Type specification didn't match with the stored one");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = typeText.split('\n');                                                                                                                                                            // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(8) != "Meaning" || lines.at(9) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF type specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 10;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "ET_LOOS")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_NONE", "NONE");                                                                                                                                         // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_REL",  "RELOCATABLE");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_EXEC", "EXECUTABLE");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_DYN",  "DYNAMIC_LIBRARY");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_CORE", "CORE");                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList typeLines;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        typeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        typeLines.append("enum class ElfType: u16");                                                                                                                                                     // Colorize: green
        typeLines.append("{");                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            typeLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                                    // Colorize: green
                                        .arg(field, -15, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                          // Colorize: green
                                        .arg(descriptions.at(i))                                                                                                                                         // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        typeLines.append("};");                                                                                                                                                                          // Colorize: green
        typeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(typeLines, thread->getPath() + "/" + ELF_TYPE_H))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Type with specification");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfMachine(SpecVerifyThread *thread, const QString &specContent)                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString machineText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init machineText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        machineText =                                                                                                                                                                                    // Colorize: green
            "e_machine identifies the target architecture. These values are defined in\n"                                                                                                                // Colorize: green
            "the processor-specific supplements.";                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(machineText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Machine specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList machineLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        machineLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        machineLines.append("enum class ElfMachine: u16");                                                                                                                                               // Colorize: green
        machineLines.append("{");                                                                                                                                                                        // Colorize: green
        machineLines.append("    NONE             = 0,");                                                                                                                                                // Colorize: green
        machineLines.append("    MACHINE_M32      = 0x0001,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_SPARC    = 0x0002,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_X86      = 0x0003,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_68K      = 0x0004,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_88K      = 0x0005,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_860      = 0x0007,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_MIPS     = 0x0008,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_POWER_PC = 0x0014,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_S390     = 0x0016,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_ARM      = 0x0028,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_SUPERH   = 0x002A,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_IA_64    = 0x0032,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_X86_64   = 0x003E,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_AARCH64  = 0x00B7,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_RISC_V   = 0x00F3");                                                                                                                                            // Colorize: green
        machineLines.append("};");                                                                                                                                                                       // Colorize: green
        machineLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(machineLines, thread->getPath() + "/" + ELF_MACHINE_H))                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Machine with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfFlags(SpecVerifyThread *thread, const QString &specContent)                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString flagsText;                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init flagsText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsText =                                                                                                                                                                                      // Colorize: green
            "e_flags\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "contains processor-specific flags.";                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(flagsText))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Flags specification didn't match with the stored one");                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList flagsLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        flagsLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        flagsLines.append("typedef u32 elf_header_flags;");                                                                                                                                              // Colorize: green
        flagsLines.append("");                                                                                                                                                                           // Colorize: green
        flagsLines.append("enum class ElfHeaderFlag: elf_header_flags");                                                                                                                                 // Colorize: green
        flagsLines.append("{");                                                                                                                                                                          // Colorize: green
        flagsLines.append("    NONE = 0");                                                                                                                                                               // Colorize: green
        flagsLines.append("};");                                                                                                                                                                         // Colorize: green
        flagsLines.append("");                                                                                                                                                                           // Colorize: green
        flagsLines.append("DEFINE_FLAGS(ElfHeaderFlags, elf_header_flags); // TEST: NO");                                                                                                                // Colorize: green
        flagsLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(flagsLines, thread->getPath() + "/" + ELF_HEADER_FLAGS_H))                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Flags with specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionHeaderTableEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionHeaderTableEntryText;                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionHeaderTableEntryText                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryText =                                                                                                                                                                    // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "sh_name;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "sh_type;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "sh_flags;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "sh_addr;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Off\n"                                                                                                                                                                                // Colorize: green
            "sh_offset;\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "sh_size;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "sh_link;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "sh_info;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "sh_addralign;\n"                                                                                                                                                                            // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "sh_entsize;\n"                                                                                                                                                                              // Colorize: green
            "} Elf64_Shdr;";                                                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionHeaderTableEntryText))                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Section Header Table Entry specification didn't match with the stored one");                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionHeaderTableEntryText.split('\n');                                                                                                                                         // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Shdr;")                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i != lines.size() - 1)                                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_name",      "nameOffset");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_type",      "type");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_flags",     "flags");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_addr",      "virtualAddress");                                                                                                                          // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_offset",    "offset");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_size",      "size");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_link",      "link");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_info",      "info");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_addralign", "align");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_entsize",   "entrySize");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionHeaderTableEntryLines;                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        sectionHeaderTableEntryLines.append("struct ElfSectionHeaderTableEntry");                                                                                                                        // Colorize: green
        sectionHeaderTableEntryLines.append("{");                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1")                                                                                                                               // Colorize: green
                                            .arg(fieldTypes.at(i))                                                                                                                                       // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1")                                                                                                                                // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionHeaderTableEntryLines.append(QString("    %1 %2;")                                                                                                                                    // Colorize: green
                                                        .arg(type, -15, QChar(' '))                                                                                                                      // Colorize: green
                                                        .arg(name)                                                                                                                                       // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionHeaderTableEntryLines.append("};");                                                                                                                                                       // Colorize: green
        sectionHeaderTableEntryLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryLines.replaceInStrings("    u32             type;",  "    ElfSectionType  type;");                                                                                        // Colorize: green
        sectionHeaderTableEntryLines.replaceInStrings("    u64             flags;", "    ElfSectionFlags flags;");                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionHeaderTableEntryLines, thread->getPath() + "/" + ELF_SECTION_HEADER_TABLE_ENTRY_H))                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Section Header Table Entry with specification");                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionTypes(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionTypeText;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionTypeText                                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeText =                                                                                                                                                                                // Colorize: green
            "Table 8. Section Types, sh_type\n"                                                                                                                                                          // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_NULL\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Marks an unused section header\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_PROGBITS\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains information defined by\n"                                                                                                                                                          // Colorize: green
            "the program\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_SYMTAB\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains a linker symbol table\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_STRTAB\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains a string table\n"                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_RELA\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains \"Rela\" type relocation\n"                                                                                                                                                        // Colorize: green
            "entries\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_HASH\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "5\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains a symbol hash table\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_DYNAMIC\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains dynamic linking tables\n"                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_NOTE\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains note information\n"                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_NOBITS\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains uninitialized space; does\n"                                                                                                                                                       // Colorize: green
            "not occupy any space in the file\n"                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_REL\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains \"Rel\" type relocation\n"                                                                                                                                                         // Colorize: green
            "entries\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_SHLIB\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_DYNSYM\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains a dynamic loader symbol\n"                                                                                                                                                         // Colorize: green
            "table\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_LOOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x60000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_HIOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x6FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_LOPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x70000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHT_HIPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x7FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionTypeText))                                                                                                                                                      // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Section Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionTypeText.split('\n');                                                                                                                                                     // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section type specification");                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "SHT_LOOS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(description);                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NULL",     "NONE");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_PROGBITS", "PROGBITS");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_SYMTAB",   "SYMTAB");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_STRTAB",   "STRTAB");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_RELA",     "RELA");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_HASH",     "HASH");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_DYNAMIC",  "DYNAMIC");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NOTE",     "NOTE");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NOBITS",   "NOBITS");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_REL",      "REL");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_SHLIB",    "SHLIB");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_DYNSYM",   "DYNSYM");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionTypeLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        sectionTypeLines.append("enum class ElfSectionType: u32");                                                                                                                                       // Colorize: green
        sectionTypeLines.append("{");                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = "0x" + QString("%1")                                                                                                                                                         // Colorize: green
                            .arg(values.at(i).toUShort(), 8, 16, QChar('0'))                                                                                                                             // Colorize: green
                            .toUpper();                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "0x00000000")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value = "0";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionTypeLines.append(QString("    %1 = %2,%3 // %4")                                                                                                                                              // Colorize: green
                                            .arg(field, -14, QChar(' '))                                                                                                                                 // Colorize: green
                                            .arg(value)                                                                                                                                                  // Colorize: green
                                            .arg("", 10 - value.length(), QChar(' '))                                                                                                                                 // Colorize: green
                                            .arg(descriptions.at(i))                                                                                                                                     // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionTypeLines.append("};");                                                                                                                                                                   // Colorize: green
        sectionTypeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeLines.insert(15, "    INIT_ARRAY     = 0x0000000E,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(16, "    FINI_ARRAY     = 0x0000000F,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(17, "    PREINIT_ARRAY  = 0x00000010,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(18, "    GROUP          = 0x00000011,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(19, "    SYMTAB_SHNDX   = 0x00000012,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(20, "    NUM            = 0x00000013");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionTypeLines, thread->getPath() + "/" + ELF_SECTION_TYPE_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Section Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionFlags(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionFlagsText;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionFlagsText                                                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsText =                                                                                                                                                                               // Colorize: green
            "Table 9. Section Attributes, sh_flags\n"                                                                                                                                                    // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHF_WRITE\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x1\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Section contains writable data\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHF_ALLOC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x2\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Section is allocated in memory\n"                                                                                                                                                           // Colorize: green
            "image of program\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHF_EXECINSTR\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x4\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Section contains executable\n"                                                                                                                                                              // Colorize: green
            "instructions\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHF_MASKOS\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x0F000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "SHF_MASKPROC\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xF0000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionFlagsText))                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Section Flags specification didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionFlagsText.split('\n');                                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section flags specification");                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "SHF_MASKOS")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(description);                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames;   // ELF field name  => NGOS field name                                                                                                       // Colorize: green
    QHash<QString, QString> elfFieldValuesToNgosFieldValues; // ELF field value => NGOS field value                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_WRITE",     "WRITE");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_ALLOC",     "ALLOC");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_EXECINSTR", "EXECINSTR");                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x1", "BIT_0");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x2", "BIT_1");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x4", "BIT_2");                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionFlagsLines;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        sectionFlagsLines.append("typedef u64 elf_section_flags;");                                                                                                                                      // Colorize: green
        sectionFlagsLines.append("");                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.append("enum class ElfSectionFlag: elf_section_flags");                                                                                                                        // Colorize: green
        sectionFlagsLines.append("{");                                                                                                                                                                   // Colorize: green
        sectionFlagsLines.append("    NONE             = 0,");                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = elfFieldValuesToNgosFieldValues.value(values.at(i), "");                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field value: %1")                                                                                                                        // Colorize: green
                                            .arg(values.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionFlagsLines.append(QString("    %1 = %2,%3 // %4")                                                                                                                                             // Colorize: green
                                                .arg(field, -16, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(value)                                                                                                                                              // Colorize: green
                                                .arg("", 6 - value.length(), QChar(' '))                                                                                                                // Colorize: green
                                                .arg(descriptions.at(i))                                                                                                                                 // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionFlagsLines.append("};");                                                                                                                                                                  // Colorize: green
        sectionFlagsLines.append("");                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.append("DEFINE_FLAGS(ElfSectionFlags, elf_section_flags); // TEST: NO");                                                                                                       // Colorize: green
        sectionFlagsLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.insert(9,  "    MERGE            = BIT_4,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(10, "    STRINGS          = BIT_5,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(11, "    INFO_LINK        = BIT_6,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(12, "    LINK_ORDER       = BIT_7,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(13, "    OS_NONCONFORMING = BIT_8,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(14, "    GROUP            = BIT_9,");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(15, "    TLS              = BIT_10,");                                                                                                                            // Colorize: green
        sectionFlagsLines.insert(16, "    ORDERED          = BIT_26,");                                                                                                                            // Colorize: green
        sectionFlagsLines.insert(17, "    EXCLUDE          = BIT_27");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionFlagsLines, thread->getPath() + "/" + ELF_SECTION_FLAGS_H))                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Section Flags with specification");                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbol(SpecVerifyThread *thread, const QString &specContent)                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolText =                                                                                                                                                                                     // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "st_name;\n"                                                                                                                                                                                 // Colorize: green
            "unsigned char\n"                                                                                                                                                                            // Colorize: green
            "st_info;\n"                                                                                                                                                                                 // Colorize: green
            "unsigned char\n"                                                                                                                                                                            // Colorize: green
            "st_other;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Half\n"                                                                                                                                                                               // Colorize: green
            "st_shndx;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "st_value;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "st_size;\n"                                                                                                                                                                                 // Colorize: green
            "} Elf64_Sym;";                                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(symbolText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = symbolText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF symbol specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Sym;")                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i != lines.size() - 1)                                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF symbol specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_name",  "nameOffset");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_info",  "info");                                                                                                                                        // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_other", "other");                                                                                                                                       // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_shndx", "sectionIndex");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_value", "value");                                                                                                                                       // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("st_size",  "size");                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolLines.append("struct ElfSymbol");                                                                                                                                                          // Colorize: green
        symbolLines.append("{");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1")                                                                                                                               // Colorize: green
                                            .arg(fieldTypes.at(i))                                                                                                                                       // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1")                                                                                                                                // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            symbolLines.append(QString("    %1 %2;")                                                                                                                                                     // Colorize: green
                                        .arg(type, -14, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(name)                                                                                                                                                       // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        symbolLines.append("};");                                                                                                                                                                        // Colorize: green
        symbolLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolLines.replaceInStrings("    u8             info;",  "    ElfSymbolInfo  info;");                                                                                                           // Colorize: green
        symbolLines.replaceInStrings("    u8             other;", "    ElfSymbolOther other;");                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolLines, thread->getPath() + "/" + ELF_SYMBOL_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbolInfo(SpecVerifyThread *thread, const QString &specContent)                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolInfoText;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolInfoText                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolInfoText =                                                                                                                                                                                 // Colorize: green
            "st_info contains the symbol type and its binding attributes (that is, its\n"                                                                                                                // Colorize: green
            "scope). The binding attributes are contained in the high-order four bits of\n"                                                                                                              // Colorize: green
            "the eight-bit byte, and the symbol type is contained in the low-order four\n"                                                                                                               // Colorize: green
            "bits. The processor-independent binding attributes are listed in Table 14,\n"                                                                                                               // Colorize: green
            "and the processor-independent values for symbol type are listed in\n"                                                                                                                       // Colorize: green
            "Table 15.";                                                                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(symbolInfoText))                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol Info specification didn't match with the stored one");                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolInfoLines;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolInfoLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolInfoLines.append("struct ElfSymbolInfo");                                                                                                                                                  // Colorize: green
        symbolInfoLines.append("{");                                                                                                                                                                     // Colorize: green
        symbolInfoLines.append("    union");                                                                                                                                                             // Colorize: green
        symbolInfoLines.append("    {");                                                                                                                                                                 // Colorize: green
        symbolInfoLines.append("        struct");                                                                                                                                                        // Colorize: green
        symbolInfoLines.append("        {");                                                                                                                                                             // Colorize: green
        symbolInfoLines.append("            u8 bind: 4; // TODO: Use enum ElfSymbolBind");                                                                                                               // Colorize: green
        symbolInfoLines.append("            u8 type: 4; // TODO: Use enum ElfSymbolType");                                                                                                               // Colorize: green
        symbolInfoLines.append("        };");                                                                                                                                                            // Colorize: green
        symbolInfoLines.append("");                                                                                                                                                                      // Colorize: green
        symbolInfoLines.append("        u8 value8;");                                                                                                                                                    // Colorize: green
        symbolInfoLines.append("    };");                                                                                                                                                                // Colorize: green
        symbolInfoLines.append("} __attribute__((packed));");                                                                                                                                            // Colorize: green
        symbolInfoLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolInfoLines, thread->getPath() + "/" + ELF_SYMBOL_INFO_H))                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol Info with specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbolBind(SpecVerifyThread *thread, const QString &specContent)                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolBindText;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolBindText                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolBindText =                                                                                                                                                                                 // Colorize: green
            "Table 14. Symbol Bindings\n"                                                                                                                                                                // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_LOCAL\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Not visible outside the object file\n"                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_GLOBAL\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Global symbol, visible to all object\n"                                                                                                                                                     // Colorize: green
            "files\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_WEAK\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Global scope, but with lower\n"                                                                                                                                                             // Colorize: green
            "precedence than global symbols\n"                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_LOOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_HIOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_LOPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "13\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STB_HIPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(symbolBindText))                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol Bind specification didn't match with the stored one");                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = symbolBindText.split('\n');                                                                                                                                                      // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF symbol bind specification");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "STB_LOOS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(description);                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STB_LOCAL",  "LOCAL");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STB_GLOBAL", "GLOBAL");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STB_WEAK",   "WEAK");                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolBindLines;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolBindLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolBindLines.append("enum class ElfSymbolBind: u8");                                                                                                                                          // Colorize: green
        symbolBindLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            symbolBindLines.append(QString("    %1 = %2%3 // %4")                                                                                                                                              // Colorize: green
                                            .arg(field, -6, QChar(' '))                                                                                                                                  // Colorize: green
                                            .arg(values.at(i))                                                                                                                                           // Colorize: green
                                            .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                            .arg(descriptions.at(i))                                                                                                                                     // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        symbolBindLines.append("};");                                                                                                                                                                    // Colorize: green
        symbolBindLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolBindLines, thread->getPath() + "/" + ELF_SYMBOL_BIND_H))                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol Bind with specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbolType(SpecVerifyThread *thread, const QString &specContent)                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolTypeText1;                                                                                                                                                                             // Colorize: green
    QString symbolTypeText2;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolTypeText1 and symbolTypeText2                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolTypeText1 =                                                                                                                                                                                // Colorize: green
            "Table 15. Symbol Types\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_NOTYPE\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "No type specified (e.g., an absolute\n"                                                                                                                                                     // Colorize: green
            "symbol)\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_OBJECT\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Data object\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_FUNC\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Function entry point\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_SECTION\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Symbol is associated with a section\n"                                                                                                                                                      // Colorize: green
            "";                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        symbolTypeText2 =                                                                                                                                                                                // Colorize: green
            "Table 15. Symbol Types (Continued)\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7.\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_FILE\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Source file associated with the\n"                                                                                                                                                          // Colorize: green
            "object file\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_LOOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_HIOS\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_LOPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "13\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "STT_HIPROC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(symbolTypeText1)                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(symbolTypeText2)                                                                                                                                                       // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol Type specification didn't match with the stored one");                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (symbolTypeText1 + "\n" + symbolTypeText2).split('\n');                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(8) != "Meaning" || lines.at(9) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF symbol type specification");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 10;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "Table 15. Symbol Types (Continued)")                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 10;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                field = lines.at(i);                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "STT_LOOS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(description);                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STT_NOTYPE",  "NOTYPE");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STT_OBJECT",  "OBJECT");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STT_FUNC",    "FUNC");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STT_SECTION", "SECTION");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("STT_FILE",    "FILE");                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolTypeLines;                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolTypeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolTypeLines.append("enum class ElfSymbolType: u8");                                                                                                                                          // Colorize: green
        symbolTypeLines.append("{");                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            symbolTypeLines.append(QString("    %1 = %2, // %3")                                                                                                                                               // Colorize: green
                                            .arg(field, -7, QChar(' '))                                                                                                                                  // Colorize: green
                                            .arg(values.at(i))                                                                                                                                           // Colorize: green
                                            .arg(descriptions.at(i))                                                                                                                                           // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        symbolTypeLines.append("};");                                                                                                                                                                    // Colorize: green
        symbolTypeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolTypeLines.insert(8, "    COMMON  = 5,");                                                                                                                                                   // Colorize: green
        symbolTypeLines.insert(9, "    TLS     = 6");                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolTypeLines, thread->getPath() + "/" + ELF_SYMBOL_TYPE_H))                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol Type with specification");                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbolOther(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolOtherText;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolOtherText                                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolOtherText =                                                                                                                                                                                // Colorize: green
            "st_other\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "*\n"                                                                           // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "st_shndx contains the section index of the section in which the symbol is\n"   // Broken lines generated                                                                                    // Colorize: green
            "\"defined.\" For undefined symbols, this field contains SHN_UNDEF; for\n"      // Broken lines generated                                                                                    // Colorize: green
            "absolute symbols, it contains SHN_ABS; and for common symbols, it\n"           // Broken lines generated                                                                                    // Colorize: green
            "contains SHN_COMMON.\n"                                                        // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "*\n"                                                                           // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "st_value contains the value of the symbol. This may be an absolute value\n"    // Broken lines generated                                                                                    // Colorize: green
            "or a relocatable address.\n"                                                   // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "is reserved for future use; must be zero.";                                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(symbolOtherText))                                                                                                                                                      // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol Other specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolOtherLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolOtherLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolOtherLines.append("struct ElfSymbolOther");                                                                                                                                                // Colorize: green
        symbolOtherLines.append("{");                                                                                                                                                                    // Colorize: green
        symbolOtherLines.append("    union");                                                                                                                                                            // Colorize: green
        symbolOtherLines.append("    {");                                                                                                                                                                // Colorize: green
        symbolOtherLines.append("        struct");                                                                                                                                                       // Colorize: green
        symbolOtherLines.append("        {");                                                                                                                                                            // Colorize: green
        symbolOtherLines.append("            u8 __reserved: 5;");                                                                                                                                        // Colorize: green
        symbolOtherLines.append("            u8 visibility: 3; // TODO: Use enum ElfSymbolVisibility");                                                                                                  // Colorize: green
        symbolOtherLines.append("        };");                                                                                                                                                           // Colorize: green
        symbolOtherLines.append("");                                                                                                                                                                     // Colorize: green
        symbolOtherLines.append("        u8 value8;");                                                                                                                                                   // Colorize: green
        symbolOtherLines.append("    };");                                                                                                                                                               // Colorize: green
        symbolOtherLines.append("} __attribute__((packed));");                                                                                                                                           // Colorize: green
        symbolOtherLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolOtherLines, thread->getPath() + "/" + ELF_SYMBOL_OTHER_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol Other with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSymbolVisibility(SpecVerifyThread *thread, const QString &specContent)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString symbolVisibilityText;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init symbolVisibilityText                                                                                                                                                                         // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolVisibilityText =                                                                                                                                                                           // Colorize: green
            "st_other\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "*\n"                                                                           // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "st_shndx contains the section index of the section in which the symbol is\n"   // Broken lines generated                                                                                    // Colorize: green
            "\"defined.\" For undefined symbols, this field contains SHN_UNDEF; for\n"      // Broken lines generated                                                                                    // Colorize: green
            "absolute symbols, it contains SHN_ABS; and for common symbols, it\n"           // Broken lines generated                                                                                    // Colorize: green
            "contains SHN_COMMON.\n"                                                        // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "*\n"                                                                           // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "st_value contains the value of the symbol. This may be an absolute value\n"    // Broken lines generated                                                                                    // Colorize: green
            "or a relocatable address.\n"                                                   // Broken lines generated                                                                                    // Colorize: green
            "\n"                                                                            // Broken lines generated                                                                                    // Colorize: green
            "is reserved for future use; must be zero.";                                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(symbolVisibilityText))                                                                                                                                                 // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Symbol Visibility specification didn't match with the stored one");                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList symbolVisibilityLines;                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        symbolVisibilityLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                                .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        symbolVisibilityLines.append("enum class ElfSymbolVisibility: u8");                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("{");                                                                                                                                                               // Colorize: green
        symbolVisibilityLines.append("    DEFAULT   = 0,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    INTERNAL  = 1,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    HIDDEN    = 2,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    PROTECTED = 3,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    EXPORTED  = 4,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    SINGLETON = 5,");                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append("    ELIMINATE = 6");                                                                                                                                               // Colorize: green
        symbolVisibilityLines.append("};");                                                                                                                                                              // Colorize: green
        symbolVisibilityLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                                .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(symbolVisibilityLines, thread->getPath() + "/" + ELF_SYMBOL_VISIBILITY_H))                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Symbol Visibility with specification");                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfRel(SpecVerifyThread *thread, const QString &specContent)                                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString relText;                                                                                                                                                                                     // Colorize: green
    QString relocationTypeText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init relText and relocationTypeText                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relText =                                                                                                                                                                                        // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "} Elf64_Rel;\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "r_offset;\n"                                                                                                                                                                                // Colorize: green
            "r_info;";                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        relocationTypeText =                                                                                                                                                                             // Colorize: green
            "r_info contains both a symbol table index and a relocation type. The\n"                                                                                                                     // Colorize: green
            "symbol table index identifies the symbol whose value should be used in\n"                                                                                                                   // Colorize: green
            "the relocation. Relocation types are processor specific. The symbol table\n"                                                                                                                // Colorize: green
            "index is obtained by applying the ELF64_R_SYM macro to this field, and the\n"                                                                                                               // Colorize: green
            "relocation type is obtained by applying the ELF64_R_TYPE macro to this\n"                                                                                                                   // Colorize: green
            "field. The ELF64_R_INFO macro combines a symbol table index and a\n"                                                                                                                        // Colorize: green
            "relocation type to produce a value for this field. These macros are defined\n"                                                                                                              // Colorize: green
            "as follows:\n"                                                                                                                                                                              // Colorize: green
            "#define ELF64_R_SYM(i)((i) >> 32)\n"                                                                                                                                                        // Colorize: green
            "#define ELF64_R_TYPE(i)((i) & 0xf f f f f f f f L)\n"                                                                                                                                       // Colorize: green
            "#define ELF64_R_INFO(s, t)(((s) << 32) + ((t) & 0xf f f f f f f f L))";                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(relText)                                                                                                                                                               // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(relocationTypeText)                                                                                                                                                    // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Rel specification didn't match with the stored one");                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList relLines;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        relLines.append("struct ElfRel");                                                                                                                                                                // Colorize: green
        relLines.append("{");                                                                                                                                                                            // Colorize: green
        relLines.append("    u64 offset;");                                                                                                                                                              // Colorize: green
        relLines.append("");                                                                                                                                                                             // Colorize: green
        relLines.append("    union");                                                                                                                                                                    // Colorize: green
        relLines.append("    {");                                                                                                                                                                        // Colorize: green
        relLines.append("        struct");                                                                                                                                                               // Colorize: green
        relLines.append("        {");                                                                                                                                                                    // Colorize: green
        relLines.append("            ElfRelocationType type;");                                                                                                                                          // Colorize: green
        relLines.append("            u32               symbol;");                                                                                                                                        // Colorize: green
        relLines.append("        };");                                                                                                                                                                   // Colorize: green
        relLines.append("");                                                                                                                                                                             // Colorize: green
        relLines.append("        u64 info;");                                                                                                                                                            // Colorize: green
        relLines.append("    };");                                                                                                                                                                       // Colorize: green
        relLines.append("};");                                                                                                                                                                           // Colorize: green
        relLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(relLines, thread->getPath() + "/" + ELF_REL_H))                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Rel with specification");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfRela(SpecVerifyThread *thread, const QString &specContent)                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString relaText;                                                                                                                                                                                    // Colorize: green
    QString relocationTypeText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init relaText and relocationTypeText                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relaText =                                                                                                                                                                                       // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "r_offset;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "r_info;\n"                                                                                                                                                                                  // Colorize: green
            "Elf64_Sxword\n"                                                                                                                                                                             // Colorize: green
            "r_addend;\n"                                                                                                                                                                                // Colorize: green
            "} Elf64_Rela;";                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        relocationTypeText =                                                                                                                                                                             // Colorize: green
            "r_info contains both a symbol table index and a relocation type. The\n"                                                                                                                     // Colorize: green
            "symbol table index identifies the symbol whose value should be used in\n"                                                                                                                   // Colorize: green
            "the relocation. Relocation types are processor specific. The symbol table\n"                                                                                                                // Colorize: green
            "index is obtained by applying the ELF64_R_SYM macro to this field, and the\n"                                                                                                               // Colorize: green
            "relocation type is obtained by applying the ELF64_R_TYPE macro to this\n"                                                                                                                   // Colorize: green
            "field. The ELF64_R_INFO macro combines a symbol table index and a\n"                                                                                                                        // Colorize: green
            "relocation type to produce a value for this field. These macros are defined\n"                                                                                                              // Colorize: green
            "as follows:\n"                                                                                                                                                                              // Colorize: green
            "#define ELF64_R_SYM(i)((i) >> 32)\n"                                                                                                                                                        // Colorize: green
            "#define ELF64_R_TYPE(i)((i) & 0xf f f f f f f f L)\n"                                                                                                                                       // Colorize: green
            "#define ELF64_R_INFO(s, t)(((s) << 32) + ((t) & 0xf f f f f f f f L))";                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(relaText)                                                                                                                                                              // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(relocationTypeText)                                                                                                                                                    // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Rela specification didn't match with the stored one");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList relaLines;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relaLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        relaLines.append("struct ElfRela");                                                                                                                                                              // Colorize: green
        relaLines.append("{");                                                                                                                                                                           // Colorize: green
        relaLines.append("    u64 offset;");                                                                                                                                                             // Colorize: green
        relaLines.append("");                                                                                                                                                                            // Colorize: green
        relaLines.append("    union");                                                                                                                                                                   // Colorize: green
        relaLines.append("    {");                                                                                                                                                                       // Colorize: green
        relaLines.append("        struct");                                                                                                                                                              // Colorize: green
        relaLines.append("        {");                                                                                                                                                                   // Colorize: green
        relaLines.append("            ElfRelocationType type;");                                                                                                                                         // Colorize: green
        relaLines.append("            u32               symbol;");                                                                                                                                       // Colorize: green
        relaLines.append("        };");                                                                                                                                                                  // Colorize: green
        relaLines.append("");                                                                                                                                                                            // Colorize: green
        relaLines.append("        u64 info;");                                                                                                                                                           // Colorize: green
        relaLines.append("    };");                                                                                                                                                                      // Colorize: green
        relaLines.append("");                                                                                                                                                                            // Colorize: green
        relaLines.append("    i64 addend;");                                                                                                                                                             // Colorize: green
        relaLines.append("};");                                                                                                                                                                          // Colorize: green
        relaLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(relaLines, thread->getPath() + "/" + ELF_RELA_H))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Rela with specification");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfRelocationType(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString relocationTypeText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init relocationTypeText                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relocationTypeText =                                                                                                                                                                             // Colorize: green
            "r_info contains both a symbol table index and a relocation type. The\n"                                                                                                                     // Colorize: green
            "symbol table index identifies the symbol whose value should be used in\n"                                                                                                                   // Colorize: green
            "the relocation. Relocation types are processor specific. The symbol table\n"                                                                                                                // Colorize: green
            "index is obtained by applying the ELF64_R_SYM macro to this field, and the\n"                                                                                                               // Colorize: green
            "relocation type is obtained by applying the ELF64_R_TYPE macro to this\n"                                                                                                                   // Colorize: green
            "field. The ELF64_R_INFO macro combines a symbol table index and a\n"                                                                                                                        // Colorize: green
            "relocation type to produce a value for this field. These macros are defined\n"                                                                                                              // Colorize: green
            "as follows:\n"                                                                                                                                                                              // Colorize: green
            "#define ELF64_R_SYM(i)((i) >> 32)\n"                                                                                                                                                        // Colorize: green
            "#define ELF64_R_TYPE(i)((i) & 0xf f f f f f f f L)\n"                                                                                                                                       // Colorize: green
            "#define ELF64_R_INFO(s, t)(((s) << 32) + ((t) & 0xf f f f f f f f L))";                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(relocationTypeText))                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Relocation Type specification didn't match with the stored one");                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList relocationTypeLines;                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        relocationTypeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        relocationTypeLines.append("enum class ElfRelocationType: u32");                                                                                                                                 // Colorize: green
        relocationTypeLines.append("{");                                                                                                                                                                 // Colorize: green
        relocationTypeLines.append("    NONE      = 0,  // No reloc");                                                                                                                                   // Colorize: green
        relocationTypeLines.append("    D64       = 1,  // Direct 64 bit");                                                                                                                              // Colorize: green
        relocationTypeLines.append("    PC32      = 2,  // PC relative 32 bit signed");                                                                                                                  // Colorize: green
        relocationTypeLines.append("    GOT32     = 3,  // 32 bit GOT entry");                                                                                                                           // Colorize: green
        relocationTypeLines.append("    PLT32     = 4,  // 32 bit PLT address");                                                                                                                         // Colorize: green
        relocationTypeLines.append("    COPY      = 5,  // Copy symbol at runtime");                                                                                                                     // Colorize: green
        relocationTypeLines.append("    GLOB_DAT  = 6,  // Create GOT entry");                                                                                                                           // Colorize: green
        relocationTypeLines.append("    JUMP_SLOT = 7,  // Create PLT entry");                                                                                                                           // Colorize: green
        relocationTypeLines.append("    RELATIVE  = 8,  // Adjust by program base");                                                                                                                     // Colorize: green
        relocationTypeLines.append("    GOTPCREL  = 9,  // 32 bit signed pc relative offset to GOT");                                                                                                    // Colorize: green
        relocationTypeLines.append("    D32       = 10, // Direct 32 bit zero extended");                                                                                                                // Colorize: green
        relocationTypeLines.append("    D32S      = 11, // Direct 32 bit sign extended");                                                                                                                // Colorize: green
        relocationTypeLines.append("    D16       = 12, // Direct 16 bit zero extended");                                                                                                                // Colorize: green
        relocationTypeLines.append("    PC16      = 13, // 16 bit sign extended pc relative");                                                                                                           // Colorize: green
        relocationTypeLines.append("    D8        = 14, // Direct 8 bit sign extended");                                                                                                                 // Colorize: green
        relocationTypeLines.append("    PC8       = 15  // 8 bit sign extended pc relative");                                                                                                            // Colorize: green
        relocationTypeLines.append("};");                                                                                                                                                                // Colorize: green
        relocationTypeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(relocationTypeLines, thread->getPath() + "/" + ELF_RELOCATION_TYPE_H))                                                                                                         // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Relocation Type with specification");                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfProgramHeaderTableEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString programHeaderTableEntryText;                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init programHeaderTableEntryText                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programHeaderTableEntryText =                                                                                                                                                                    // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "p_type;\n"                                                                                                                                                                                  // Colorize: green
            "Elf64_Word\n"                                                                                                                                                                               // Colorize: green
            "p_flags;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Off\n"                                                                                                                                                                                // Colorize: green
            "p_offset;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "p_vaddr;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "p_paddr;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "p_filesz;\n"                                                                                                                                                                                // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "p_memsz;\n"                                                                                                                                                                                 // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "p_align;\n"                                                                                                                                                                                 // Colorize: green
            "} Elf64_Phdr;";                                                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(programHeaderTableEntryText))                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Program Header Table Entry specification didn't match with the stored one");                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = programHeaderTableEntryText.split('\n');                                                                                                                                         // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF program header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Phdr;")                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i != lines.size() - 1)                                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF program header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_type",   "type");                                                                                                                                        // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_flags",  "flags");                                                                                                                                       // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_offset", "offset");                                                                                                                                      // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_vaddr",  "virtualAddress");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_paddr",  "physicalAddress");                                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_filesz", "fileSize");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_memsz",  "memorySize");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("p_align",  "align");                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList programHeaderTableEntryLines;                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programHeaderTableEntryLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        programHeaderTableEntryLines.append("struct ElfProgramHeaderTableEntry");                                                                                                                        // Colorize: green
        programHeaderTableEntryLines.append("{");                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1")                                                                                                                               // Colorize: green
                                            .arg(fieldTypes.at(i))                                                                                                                                       // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1")                                                                                                                                // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fieldName)                                                                                                                                              // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            programHeaderTableEntryLines.append(QString("    %1 %2;")                                                                                                                                    // Colorize: green
                                                        .arg(type, -15, QChar(' '))                                                                                                                      // Colorize: green
                                                        .arg(name)                                                                                                                                       // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        programHeaderTableEntryLines.append("};");                                                                                                                                                       // Colorize: green
        programHeaderTableEntryLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programHeaderTableEntryLines.replaceInStrings("    u32             type;",  "    ElfProgramType  type;");                                                                                        // Colorize: green
        programHeaderTableEntryLines.replaceInStrings("    u32             flags;", "    ElfProgramFlags flags;");                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(programHeaderTableEntryLines, thread->getPath() + "/" + ELF_PROGRAM_HEADER_TABLE_ENTRY_H))                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Program Header Table Entry with specification");                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfProgramTypes(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString programTypeText1;                                                                                                                                                                            // Colorize: green
    QString programTypeText2;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init programTypeText1 and programTypeText2                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programTypeText1 =                                                                                                                                                                               // Colorize: green
            "Table 16. Segment Types, p_type\n"                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_NULL\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Unused entry\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_LOAD\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Loadable segment\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_DYNAMIC\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Dynamic linking tables\n"                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_INTERP\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Program interpreter path name\n"                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_NOTE\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Note sections\n"                                                                                                                                                                             // Colorize: green
            "";                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        programTypeText2 =                                                                                                                                                                               // Colorize: green
            "Table 16. Segment Types, p_type (Continued)\n"                                                                                                                                              // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_SHLIB\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "5\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_PHDR\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Program header table\n"                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_LOOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x60000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_HIOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x6FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_LOPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x70000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PT_HIPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x7FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(programTypeText1)                                                                                                                                                      // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(programTypeText2)                                                                                                                                                      // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Program Type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (programTypeText1 + "\n" + programTypeText2).split('\n');                                                                                                                        // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(8) != "Meaning" || lines.at(9) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF program type specification");                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 10;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "Table 16. Segment Types, p_type (Continued)")                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 7;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                field = lines.at(i);                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "PT_LOOS")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(lines.at(i));                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_NULL",    "NONE");                                                                                                                                      // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_LOAD",    "LOAD");                                                                                                                                      // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_DYNAMIC", "DYNAMIC");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_INTERP",  "INTERP");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_NOTE",    "NOTE");                                                                                                                                      // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_SHLIB",   "SHLIB");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PT_PHDR",    "PHDR");                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList programTypeLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programTypeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        programTypeLines.append("enum class ElfProgramType: u32");                                                                                                                                       // Colorize: green
        programTypeLines.append("{");                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = "0x" + QString("%1")                                                                                                                                                         // Colorize: green
                            .arg(values.at(i).toUShort(), 8, 16, QChar('0'))                                                                                                                             // Colorize: green
                            .toUpper();                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "0x00000000")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value = "0";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            programTypeLines.append(QString("    %1 = %2%3%4 // %5")                                                                                                                                             // Colorize: green
                                            .arg(field, -7, QChar(' '))                                                                                                                                  // Colorize: green
                                            .arg(value)                                                                                                                                                  // Colorize: green
                                            .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                            .arg("", 10 - value.length(), QChar(' '))                                                                                                                    // Colorize: green
                                            .arg(descriptions.at(i))                                                                                                                                     // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        programTypeLines.append("};");                                                                                                                                                                   // Colorize: green
        programTypeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(programTypeLines, thread->getPath() + "/" + ELF_PROGRAM_TYPE_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Program Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfProgramFlags(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString programFlagsText;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init programFlagsText                                                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programFlagsText =                                                                                                                                                                               // Colorize: green
            "Table 17. Segment Attributes, p_flags\n"                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9.\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PF_X\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x1\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Execute permission\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PF_W\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x2\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Write permission\n"                                                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PF_R\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x4\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Read permission\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PF_MASKOS\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x00FF0000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "These flag bits are reserved for\n"                                                                                                                                                         // Colorize: green
            "environment-specific use\n"                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "PF_MASKPROC\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0xFF000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "These flag bits are reserved for\n"                                                                                                                                                         // Colorize: green
            "processor-specific use";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(programFlagsText))                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Program Flags specification didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = programFlagsText.split('\n');                                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(8) != "Meaning" || lines.at(9) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF program flags specification");                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 10;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "PF_MASKOS")                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames;   // ELF field name  => NGOS field name                                                                                                       // Colorize: green
    QHash<QString, QString> elfFieldValuesToNgosFieldValues; // ELF field value => NGOS field value                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PF_X", "EXECUTABLE");                                                                                                                                      // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PF_W", "WRITABLE");                                                                                                                                        // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("PF_R", "READABLE");                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x1", "BIT_0");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x2", "BIT_1");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x4", "BIT_2");                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList programFlagsLines;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        programFlagsLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        programFlagsLines.append("typedef u32 elf_program_flags;");                                                                                                                                      // Colorize: green
        programFlagsLines.append("");                                                                                                                                                                    // Colorize: green
        programFlagsLines.append("enum class ElfProgramFlag: elf_program_flags");                                                                                                                        // Colorize: green
        programFlagsLines.append("{");                                                                                                                                                                   // Colorize: green
        programFlagsLines.append("    NONE       = 0,");                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = elfFieldValuesToNgosFieldValues.value(values.at(i), "");                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field value: %1")                                                                                                                        // Colorize: green
                                            .arg(values.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            programFlagsLines.append(QString("    %1 = %2%3%4 // %5")                                                                                                                                            // Colorize: green
                                                .arg(field, -10, QChar(' '))                                                                                                                             // Colorize: green
                                                .arg(value)                                                                                                                                              // Colorize: green
                                                .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                  // Colorize: green
                                                .arg("", 5 - value.length(), QChar(' '))                                                                                                                                              // Colorize: green
                                                .arg(descriptions.at(i))                                                                                                                                              // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        programFlagsLines.append("};");                                                                                                                                                                  // Colorize: green
        programFlagsLines.append("");                                                                                                                                                                    // Colorize: green
        programFlagsLines.append("DEFINE_FLAGS(ElfProgramFlags, elf_program_flags); // TEST: NO");                                                                                                       // Colorize: green
        programFlagsLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                            .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(programFlagsLines, thread->getPath() + "/" + ELF_PROGRAM_FLAGS_H))                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Program Flags with specification");                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfDynamic(SpecVerifyThread *thread, const QString &specContent)                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString dynamicText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init dynamicText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dynamicText =                                                                                                                                                                                    // Colorize: green
            "typedef struct\n"                                                                                                                                                                           // Colorize: green
            "{\n"                                                                                                                                                                                        // Colorize: green
            "Elf64_Sxword\n"                                                                                                                                                                             // Colorize: green
            "d_tag;\n"                                                                                                                                                                                   // Colorize: green
            "union {\n"                                                                                                                                                                                  // Colorize: green
            "Elf64_Xword\n"                                                                                                                                                                              // Colorize: green
            "Elf64_Addr\n"                                                                                                                                                                               // Colorize: green
            "} d_un;\n"                                                                                                                                                                                  // Colorize: green
            "} Elf64_Dyn;\n"                                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val;\n"                                                                                                                                                                                   // Colorize: green
            "d_ptr;";                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(dynamicText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Dynamic specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList dynamicLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dynamicLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        dynamicLines.append("struct ElfDynamic");                                                                                                                                                        // Colorize: green
        dynamicLines.append("{");                                                                                                                                                                        // Colorize: green
        dynamicLines.append("    ElfDynamicTag tag;");                                                                                                                                                   // Colorize: green
        dynamicLines.append("");                                                                                                                                                                         // Colorize: green
        dynamicLines.append("    union");                                                                                                                                                                // Colorize: green
        dynamicLines.append("    {");                                                                                                                                                                    // Colorize: green
        dynamicLines.append("        u64 value;");                                                                                                                                                       // Colorize: green
        dynamicLines.append("        u64 address;");                                                                                                                                                     // Colorize: green
        dynamicLines.append("    };");                                                                                                                                                                   // Colorize: green
        dynamicLines.append("};");                                                                                                                                                                       // Colorize: green
        dynamicLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                    .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(dynamicLines, thread->getPath() + "/" + ELF_DYNAMIC_H))                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Dynamic with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfDynamicTag(SpecVerifyThread *thread, const QString &specContent)                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString dynamicTagText1;                                                                                                                                                                             // Colorize: green
    QString dynamicTagText2;                                                                                                                                                                             // Colorize: green
    QString dynamicTagText3;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init dynamicTagText1, dynamicTagText2 and dynamicTagText3                                                                                                                                         // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dynamicTagText1 =                                                                                                                                                                                // Colorize: green
            "Table 18. Dynamic Table Entries\n"                                                                                                                                                          // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_un\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_NULL\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ignored\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Marks the end of the dynamic array\n"                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_NEEDED\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "1\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The string table offset of the name of a needed library.\n"                                                                                                                                 // Colorize: green
            "";                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        dynamicTagText2 =                                                                                                                                                                                // Colorize: green
            "Table 18. Dynamic Table Entries (Continued)\n"                                                                                                                                              // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_un\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_PLTRELSZ\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "2\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Total size, in bytes, of the relocation entries associated with\n"                                                                                                                          // Colorize: green
            "the procedure linkage table.\n"                                                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_PLTGOT\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "3\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Contains an address associated with the linkage table. The\n"                                                                                                                               // Colorize: green
            "specific meaning of this field is processor-dependent.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_HASH\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "4\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the symbol hash table, described below.\n"                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_STRTAB\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "5\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the dynamic string table.\n"                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_SYMTAB\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "6\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the dynamic symbol table.\n"                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RELA\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "7\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of a relocation table with Elf64_Rela entries.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RELASZ\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "8\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Total size, in bytes, of the DT_RELA relocation table.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RELAENT\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "9\n"                                                                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size, in bytes, of each DT_RELA relocation entry.\n"                                                                                                                                        // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_STRSZ\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "10\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Total size, in bytes, of the string table.\n"                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_SYMENT\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size, in bytes, of each symbol table entry.\n"                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_INIT\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "12\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the initialization function.\n"                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_FINI\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "13\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the termination function.\n"                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_SONAME\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "14\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The string table offset of the name of this shared object.\n"                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RPATH\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "15\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The string table offset of a shared library search path string.\n"                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_SYMBOLIC\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "16\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ignored\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The presence of this dynamic table entry modifies the\n"                                                                                                                                    // Colorize: green
            "symbol resolution algorithm for references within the\n"                                                                                                                                    // Colorize: green
            "library. Symbols defined within the library are used to\n"                                                                                                                                  // Colorize: green
            "resolve references before the dynamic linker searches the\n"                                                                                                                                // Colorize: green
            "usual search path.\n"                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_REL\n"                                                                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "17\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of a relocation table with Elf64_Rel entries.\n"                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RELSZ\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "18\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Total size, in bytes, of the DT_REL relocation table.\n"                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_RELENT\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "19\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size, in bytes, of each DT_REL relocation entry.\n"                                                                                                                                         // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_PLTREL\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "20\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Type of relocation entry used for the procedure linkage\n"                                                                                                                                  // Colorize: green
            "table. The d_val member contains either DT_REL or DT_RELA.\n"                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_DEBUG\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "21\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Reserved for debugger use.\n"                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_TEXTREL\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "22\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ignored\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The presence of this dynamic table entry signals that the\n"                                                                                                                                // Colorize: green
            "relocation table contains relocations for a non-writable\n"                                                                                                                                 // Colorize: green
            "segment.\n"                                                                                                                                                                                 // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_JMPREL\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "23\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Address of the relocations associated with the procedure\n"                                                                                                                                 // Colorize: green
            "linkage table.\n"                                                                                                                                                                           // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_BIND_NOW\n"                                                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "24\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "ignored\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "The presence of this dynamic table entry signals that the\n"                                                                                                                                // Colorize: green
            "dynamic loader should process all relocations for this object\n"                                                                                                                            // Colorize: green
            "before transferring control to the program.\n"                                                                                                                                              // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_INIT_ARRAY\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "25\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Pointer to an array of pointers to initialization functions.\n"                                                                                                                             // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_FINI_ARRAY\n"                                                                                                                                                                            // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "26\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_ptr\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Pointer to an array of pointers to termination functions.\n"                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_INIT_ARRAYSZ\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "27\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size, in bytes, of the array of initialization functions.\n"                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_FINI_ARRAYSZ\n"                                                                                                                                                                          // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "28\n"                                                                                                                                                                                       // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_val\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Size, in bytes, of the array of termination functions.\n"                                                                                                                                   // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_LOOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x60000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Defines a range of dynamic table tags that are reserved for\n"                                                                                                                              // Colorize: green
            "environment-specific use.\n"                                                                                                                                                                // Colorize: green
            "";                                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        dynamicTagText3 =                                                                                                                                                                                // Colorize: green
            "Table 18. Dynamic Table Entries (Continued)\n"                                                                                                                                              // Colorize: green
            "Name\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Value\n"                                                                                                                                                                                    // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_HIOS\n"                                                                                                                                                                                  // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x6FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_LOPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x70000000\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "DT_HIPROC\n"                                                                                                                                                                                // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "0x7FFFFFFF\n"                                                                                                                                                                               // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "11.\n"                                                                                                                                                                                      // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "d_un\n"                                                                                                                                                                                     // Colorize: green
            "\n"                                                                                                                                                                                         // Colorize: green
            "Meaning\n"                                                                                                                                                                                  // Colorize: green
            "Defines a range of dynamic table tags that are reserved for\n"                                                                                                                              // Colorize: green
            "processor-specific use.";                                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            !specContent.contains(dynamicTagText1)                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(dynamicTagText2)                                                                                                                                                       // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            !specContent.contains(dynamicTagText3)                                                                                                                                                       // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF Dynamic Tag specification didn't match with the stored one");                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = (dynamicTagText1 + "\n" + dynamicTagText2 + "\n" + dynamicTagText3).split('\n');                                                                                                 // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(7) != "Meaning" || lines.at(8) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF dynamic tag specification");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 9;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
    QStringList descriptions;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "Table 18. Dynamic Table Entries (Continued)")                                                                                                                                                                  // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 9;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                field = lines.at(i);                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "DT_LOOS")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 4;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString description = lines.at(i);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            while (i < lines.size() - 1 && lines.at(i + 1) != "")                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                ++i;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                description.append(' ');                                                                                                                                                                 // Colorize: green
                description.append(lines.at(i));                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            descriptions.append(description);                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_NULL",         "NONE");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_NEEDED",       "NEEDED");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_PLTRELSZ",     "PLTRELSZ");                                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_PLTGOT",       "PLTGOT");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_HASH",         "HASH");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_STRTAB",       "STRTAB");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_SYMTAB",       "SYMTAB");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RELA",         "RELA");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RELASZ",       "RELASZ");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RELAENT",      "RELAENT");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_STRSZ",        "STRSZ");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_SYMENT",       "SYMENT");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_INIT",         "INIT");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_FINI",         "FINI");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_SONAME",       "SONAME");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RPATH",        "RPATH");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_SYMBOLIC",     "SYMBOLIC");                                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_REL",          "REL");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RELSZ",        "RELSZ");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_RELENT",       "RELENT");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_PLTREL",       "PLTREL");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_DEBUG",        "DEBUG");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_TEXTREL",      "TEXTREL");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_JMPREL",       "JMPREL");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_BIND_NOW",     "BIND_NOW");                                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_INIT_ARRAY",   "INIT_ARRAY");                                                                                                                           // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_FINI_ARRAY",   "FINI_ARRAY");                                                                                                                           // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_INIT_ARRAYSZ", "INIT_ARRAYSZ");                                                                                                                         // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("DT_FINI_ARRAYSZ", "FINI_ARRAYSZ");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList dynamicTypeLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparison with source code                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dynamicTypeLines.append(QString("// Verified with ElfSpecVerifier [BEGIN] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        dynamicTypeLines.append("enum class ElfDynamicTag: u64");                                                                                                                                        // Colorize: green
        dynamicTypeLines.append("{");                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1")                                                                                                                         // Colorize: green
                                            .arg(fields.at(i))                                                                                                                                           // Colorize: green
                );                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            dynamicTypeLines.append(QString("    %1 = %2%3%4 // %5")                                                                                                                                             // Colorize: green
                                            .arg(field, -12, QChar(' '))                                                                                                                                 // Colorize: green
                                            .arg(values.at(i))                                                                                                                                           // Colorize: green
                                            .arg(i < fields.size() - 1 ? "," : " ")                                                                                                                      // Colorize: green
                                            .arg("", 2 - values.at(i).length(), QChar(' '))                                                                                                                                              // Colorize: green
                                            .arg(descriptions.at(i))                                                                                                                                              // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        dynamicTypeLines.append("};");                                                                                                                                                                   // Colorize: green
        dynamicTypeLines.append(QString("// Verified with ElfSpecVerifier [END] // %1")                                                                                                                      // Colorize: green
                                        .arg(ELF_SPECIFICATION_URL)                                                                                                                                           // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(dynamicTypeLines, thread->getPath() + "/" + ELF_DYNAMIC_TAG_H))                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF Dynamic Type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
ElfSpecVerifier elfSpecVerifierInstance;                                                                                                                                                                 // Colorize: green
