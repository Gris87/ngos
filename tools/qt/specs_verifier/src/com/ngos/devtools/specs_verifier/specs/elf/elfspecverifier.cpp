#include "elfspecverifier.h"                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <QDebug>                                                                                                                                                                                        // Colorize: green
#include <QEventLoop>                                                                                                                                                                                    // Colorize: green
#include <QFile>                                                                                                                                                                                         // Colorize: green
#include <QNetworkAccessManager>                                                                                                                                                                         // Colorize: green
#include <QNetworkReply>                                                                                                                                                                                 // Colorize: green
#include <QNetworkRequest>                                                                                                                                                                               // Colorize: green
#include <QProcess>                                                                                                                                                                                      // Colorize: green
#include <QTemporaryDir>                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define ELF_SPECIFICATION_URL "https://www.uclibc.org/docs/elf-64-gen.pdf" // Version 1.5                                                                                                                // Colorize: green
#define ELF_PDF               "elf.pdf"                                                                                                                                                                  // Colorize: green
#define ELF_TXT               "elf.txt"                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define ELF_HEADER_H                     "src/os/shared/common/src/com/ngos/shared/common/elf/header.h"                                                                                                       // Colorize: green
#define ELF_HEADER_IDENTIFICATION_H      "src/os/shared/common/src/com/ngos/shared/common/elf/headeridentification.h"                                                                                         // Colorize: green
#define ELF_CLASS_H                      "src/os/shared/common/src/com/ngos/shared/common/elf/class.h"                                                                                                        // Colorize: green
#define ELF_DATA_H                       "src/os/shared/common/src/com/ngos/shared/common/elf/data.h"                                                                                                         // Colorize: green
#define ELF_FILE_VERSION_H               "src/os/shared/common/src/com/ngos/shared/common/elf/fileversion.h"                                                                                                  // Colorize: green
#define ELF_VERSION_H                    "src/os/shared/common/src/com/ngos/shared/common/elf/version.h"                                                                                                      // Colorize: green
#define ELF_OS_ABI_H                     "src/os/shared/common/src/com/ngos/shared/common/elf/osabi.h"                                                                                                        // Colorize: green
#define ELF_TYPE_H                       "src/os/shared/common/src/com/ngos/shared/common/elf/type.h"                                                                                                        // Colorize: green
#define ELF_MACHINE_H                    "src/os/shared/common/src/com/ngos/shared/common/elf/machine.h"                                                                                                        // Colorize: green
#define ELF_SECTION_HEADER_TABLE_ENTRY_H "src/os/shared/common/src/com/ngos/shared/common/elf/sectionheadertableentry.h"                                                                                                        // Colorize: green
#define ELF_SECTION_TYPE_H               "src/os/shared/common/src/com/ngos/shared/common/elf/sectiontype.h"                                                                                                        // Colorize: green
#define ELF_SECTION_FLAGS_H              "src/os/shared/common/src/com/ngos/shared/common/elf/sectionflags.h"                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
ElfSpecVerifier::ElfSpecVerifier()                                                                                                                                                                       // Colorize: green
    : SpecVerifier()                                                                                                                                                                                     // Colorize: green
    , mElfTypeToNgosTypeMap()                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Addr",    "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Off",     "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Half",    "u16");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Word",    "u32");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Sword",   "i32");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Xword",   "u64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("Elf64_Sxword",  "i64");                                                                                                                                                // Colorize: green
    mElfTypeToNgosTypeMap.insert("unsigned char", "u8");                                                                                                                                                 // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::verify(SpecVerifyThread *thread)                                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread != nullptr);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QTemporaryDir tempDir;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Create temporary directory                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!tempDir.isValid())                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary directory for ELF specification");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Download specification                                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QNetworkRequest request;                                                                                                                                                                         // Colorize: green
        request.setUrl(QUrl(ELF_SPECIFICATION_URL));                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QNetworkAccessManager  manager;                                                                                                                                                                  // Colorize: green
        QNetworkReply         *reply = manager.get(request);                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QEventLoop waitLoop;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QObject::connect(reply, SIGNAL(finished()),                                 &waitLoop, SLOT(quit()));                                                                                            // Colorize: green
        QObject::connect(reply, SIGNAL(errorOccurred(QNetworkReply::NetworkError)), &waitLoop, SLOT(quit()));                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        waitLoop.exec();                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QVariant statusCode = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (statusCode.toInt() != 200)                                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError(QString("Failed to get ELF specification from: %1").arg(ELF_SPECIFICATION_URL));                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            delete reply;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QByteArray content = reply->readAll();                                                                                                                                                           // Colorize: green
        delete reply;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        QFile file(tempDir.path() + "/" + ELF_PDF);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::WriteOnly))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to create temporary file for ELF specification");                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        file.write(content);                                                                                                                                                                             // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Convert PDF to text                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QProcess process;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        process.setWorkingDirectory(tempDir.path());                                                                                                                                                     // Colorize: green
        process.start("pdftotext", QStringList() << ELF_PDF << ELF_TXT);                                                                                                                                 // Colorize: green
        process.waitForFinished(-1);                                                                                                                                                                     // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString specContent;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Read specification text                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        QFile file(tempDir.path() + "/" + ELF_TXT);                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (!file.open(QIODevice::ReadOnly))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to open ELF specification");                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        specContent = QString::fromUtf8(file.readAll());                                                                                                                                                 // Colorize: green
        file.close();                                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace some unicode characters                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        specContent.replace(QChar(0x2018), QChar('\'')); // Replace left single quotation mark                                                                                                           // Colorize: green
        specContent.replace(QChar(0x2019), QChar('\'')); // Replace right double quotation mark                                                                                                          // Colorize: green
        specContent.replace(QChar(0x201C), QChar('\"')); // Replace left double quotation mark                                                                                                           // Colorize: green
        specContent.replace(QChar(0x201D), QChar('\"')); // Replace right double quotation mark                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkWithSpecification(thread, specContent);                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkWithSpecification(SpecVerifyThread *thread, const QString &specContent)                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText = "ELF-64 Object File Format\n"                                                                                                                                                      // Colorize: green
                    "Version 1.5 Draft 2\n"                                                                                                                                                              // Colorize: green
                    "May 27, 1998";                                                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF specification version didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    checkElfHeader(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfHeaderIdentification(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfClass(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfData(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfFileVersion(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfVersion(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfOsAbi(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfType(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfMachine(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfSectionHeaderTableEntry(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfSectionTypes(thread, specContent);                                                                                                                                                                 // Colorize: green
    checkElfSectionFlags(thread, specContent);                                                                                                                                                                 // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfHeader(SpecVerifyThread *thread, const QString &specContent)                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString headerText;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init headerText                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerText = "typedef struct\n"                                                                                                                                                                  // Colorize: green
                    "{\n"                                                                                                                                                                                // Colorize: green
                    "unsigned char\n"                                                                                                                                                                    // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Word\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Addr\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Off\n"                                                                                                                                                                        // Colorize: green
                    "Elf64_Off\n"                                                                                                                                                                        // Colorize: green
                    "Elf64_Word\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "Elf64_Half\n"                                                                                                                                                                       // Colorize: green
                    "} Elf64_Ehdr;\n"                                                                                                                                                                    // Colorize: green
                    "Figure 2. ELF-64 Header\n"                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "e_ident[16];\n"                                                                                                                                                                     // Colorize: green
                    "e_type;\n"                                                                                                                                                                          // Colorize: green
                    "e_machine;\n"                                                                                                                                                                       // Colorize: green
                    "e_version;\n"                                                                                                                                                                       // Colorize: green
                    "e_entry;\n"                                                                                                                                                                         // Colorize: green
                    "e_phoff;\n"                                                                                                                                                                         // Colorize: green
                    "e_shoff;\n"                                                                                                                                                                         // Colorize: green
                    "e_flags;\n"                                                                                                                                                                         // Colorize: green
                    "e_ehsize;\n"                                                                                                                                                                        // Colorize: green
                    "e_phentsize;\n"                                                                                                                                                                     // Colorize: green
                    "e_phnum;\n"                                                                                                                                                                         // Colorize: green
                    "e_shentsize;\n"                                                                                                                                                                     // Colorize: green
                    "e_shnum;\n"                                                                                                                                                                         // Colorize: green
                    "e_shstrndx;";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(headerText))                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF header specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = headerText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Ehdr;")                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i >= lines.size())                                                                                                                                                                           // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        ++i;                                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            i >= lines.size() - 1                                                                                                                                                                        // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(i) != "Figure 2. ELF-64 Header"                                                                                                                                                     // Colorize: green
            ||                                                                                                                                                                                           // Colorize: green
            lines.at(i + 1) != ""                                                                                                                                                                        // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i += 2;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field names                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (fieldTypes.size() != fieldNames.size())                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to parse ELF header specification");                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_ident[16]", "identification");                                                                                                                           // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_type",      "type");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_machine",   "machine");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_version",   "version");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_entry",     "entryPoint");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phoff",     "programHeaderTableOffset");                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shoff",     "sectionHeaderTableOffset");                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_flags",     "flags");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_ehsize",    "headerSize");                                                                                                                               // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phentsize", "programHeaderTableEntrySize");                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_phnum",     "programHeaderTableEntryCount");                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shentsize", "sectionHeaderTableEntrySize");                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shnum",     "sectionHeaderTableEntryCount");                                                                                                             // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("e_shstrndx",  "sectionHeaderTableNamesIndex");                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList headerLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.append("struct ElfHeader");                                                                                                                                                          // Colorize: green
        headerLines.append("{");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1").arg(fieldTypes.at(i)));                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1").arg(fieldName));                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fieldName));                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            headerLines.append(QString("    %1 %2;").arg(type, -23, QChar(' ')).arg(name));                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        headerLines.append("};");                                                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        headerLines.replaceInStrings("    u8                      identification;", "    ElfHeaderIdentification identification;");                                                                      // Colorize: green
        headerLines.replaceInStrings("    u16                     type;",           "    ElfType                 type;");                                                                                // Colorize: green
        headerLines.replaceInStrings("    u16                     machine;",        "    ElfMachine              machine;");                                                                             // Colorize: green
        headerLines.replaceInStrings("    u32                     version;",        "    ElfVersion              version;");                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(headerLines, thread->getPath() + "/" + ELF_HEADER_H))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF header with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfHeaderIdentification(SpecVerifyThread *thread, const QString &specContent)                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString identificationText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init identificationText                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        identificationText = "e_ident identify the file as an ELF object file, and provide information\n"                                                                                                // Colorize: green
                            "about the data representation of the object file structures. The bytes of this\n"                                                                                           // Colorize: green
                            "array that have defined meanings are detailed below. The remaining bytes\n"                                                                                                 // Colorize: green
                            "are reserved for future use, and should be set to zero. Each byte of the\n"                                                                                                 // Colorize: green
                            "array is indexed symbolically using the names in the Table 2.\n"                                                                                                            // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Table 2. ELF Identification, e_ident\n"                                                                                                                                     // Colorize: green
                            "Name\n"                                                                                                                                                                     // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Value\n"                                                                                                                                                                    // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Purpose\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_MAG0\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "File identification\n"                                                                                                                                                      // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_MAG1\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "1\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_MAG2\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "2\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_MAG3\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "3\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_CLASS\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "4\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "File class\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_DATA\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "5\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Data encoding\n"                                                                                                                                                            // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_VERSION\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "6\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "File version\n"                                                                                                                                                             // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_OSABI\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "7\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "OS/ABI identification\n"                                                                                                                                                    // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_ABIVERSION\n"                                                                                                                                                            // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "8\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "ABI version\n"                                                                                                                                                              // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_PAD\n"                                                                                                                                                                   // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "9\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Start of padding bytes\n"                                                                                                                                                   // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "EI_NIDENT\n"                                                                                                                                                                // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "16\n"                                                                                                                                                                       // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Size of e_ident[]";                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(identificationText))                                                                                                                                                   // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF header identification specification didn't match with the stored one");                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = identificationText.split('\n');                                                                                                                                                          // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(11) != "Purpose" || lines.at(12) != "")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF header identification specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 13;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString line = lines.at(i);                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(line);                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (line.startsWith("EI_MAG") && line != "EI_MAG0")                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 4;                                                                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 6;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList identificationLines;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        identificationLines.append("struct ElfHeaderIdentification");                                                                                                                                    // Colorize: green
        identificationLines.append("{");                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (                                                                                                                                                                                             // Colorize: green
            fields.at(0) == "EI_MAG0"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(1) == "EI_MAG1"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(2) == "EI_MAG2"                                                                                                                                                                    // Colorize: green
            &&                                                                                                                                                                                           // Colorize: green
            fields.at(3) == "EI_MAG3"                                                                                                                                                                    // Colorize: green
           )                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            identificationLines.append("    u32            signature;");                                                                                                                                     // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 4; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = fields.at(i);                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "EI_CLASS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfClass       fileClass;");                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_DATA")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfData        fileData;");                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_VERSION")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfFileVersion version;");                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_OSABI")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    ElfOsAbi       osAbi;");                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_ABIVERSION")                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    u8             abiVersion;");                                                                                                                                // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field == "EI_PAD")                                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                identificationLines.append("    u8             __pad[7];");                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            if (field != "EI_NIDENT")                                                                                                                                                                    // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unknown field found in ELF header identification specification: %1").arg(field));                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        identificationLines.append("} __attribute__((packed));");                                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fileLines = readLinesFromFile(thread->getPath() + "/" + ELF_HEADER_IDENTIFICATION_H);                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(identificationLines, fileLines))                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF header identification with specification");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString magicNumberText;                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init magicNumberText                                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        magicNumberText = "e_ident[EI_MAG0] through e_ident[EI_MAG3] contain a \"magic number,\"\n"                                                                                                        // Colorize: green
                            "identifying the file as an ELF object file. They contain the characters '\\x7f',\n"                                                                                          // Colorize: green
                            "'E', 'L', and 'F', respectively.";                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(magicNumberText))                                                                                                                                                      // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF header magic number specification didn't match with the stored one");                                                                                                  // Colorize: green
            thread->addError(specContent);                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList magicNumberLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        magicNumberLines.append("#define ELF_SIGNATURE 0x464C457F // 0x7F + ELF");                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFileLines(magicNumberLines, fileLines))                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF header magic number with specification");                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfClass(SpecVerifyThread *thread, const QString &specContent)                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString classText;                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init classText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        classText = "Table 3. Object File Classes, e_ident[EI_CLASS]\n"                                                                                                                                  // Colorize: green
                    "Name\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Value\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Meaning\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFCLASS32\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "32-bit objects\n"                                                                                                                                                                   // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFCLASS64\n"                                                                                                                                                                       // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "64-bit objects";                                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(classText))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF class specification didn't match with the stored one");                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = classText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF class specification");                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 4;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFCLASS32", "CLASS_32");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFCLASS64", "CLASS_64");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList classLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        classLines.append("enum class ElfClass: u8");                                                                                                                                                    // Colorize: green
        classLines.append("{");                                                                                                                                                                          // Colorize: green
        classLines.append("    NONE     = 0,");                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            classLines.append(QString("    %1 = %2%3")                                                                                                                                                   // Colorize: green
                                        .arg(field, -8, QChar(' '))                                                                                                                                      // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : ""));                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        classLines.append("};");                                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(classLines, thread->getPath() + "/" + ELF_CLASS_H))                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF class with specification");                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfData(SpecVerifyThread *thread, const QString &specContent)                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString dataText;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init dataText                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dataText = "Table 4. Data Encodings, e_ident[EI_DATA]\n"                                                                                                                                         // Colorize: green
                    "Name\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Value\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Meaning\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFDATA2LSB\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Object file data structures are littleendian\n"                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFDATA2MSB\n"                                                                                                                                                                      // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Object file data structures are bigendian";                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(dataText))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF data specification didn't match with the stored one");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = dataText.split('\n');                                                                                                                                                            // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF data specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 4;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFDATA2LSB", "LEAST_SIGNIFICANT_BYTE");                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFDATA2MSB", "MOST_SIGNIFICANT_BYTE");                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList dataLines;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        dataLines.append("enum class ElfData: u8");                                                                                                                                                      // Colorize: green
        dataLines.append("{");                                                                                                                                                                           // Colorize: green
        dataLines.append("    NONE                   = 0,");                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            dataLines.append(QString("    %1 = %2%3")                                                                                                                                                    // Colorize: green
                                        .arg(field, -22, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : ""));                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        dataLines.append("};");                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(dataLines, thread->getPath() + "/" + ELF_DATA_H))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF data with specification");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfFileVersion(SpecVerifyThread *thread, const QString &specContent)                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText = "e_ident[EI_VERSION] identifies the version of the object file format.\n"                                                                                                          // Colorize: green
                        "Currently, this field has the value EV_CURRENT, which is defined with the\n"                                                                                                    // Colorize: green
                        "value 1.";                                                                                                                                                                      // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF file version specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList versionLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionLines.append("enum class ElfFileVersion: u8");                                                                                                                                            // Colorize: green
        versionLines.append("{");                                                                                                                                                                        // Colorize: green
        versionLines.append("    NONE    = 0,");                                                                                                                                                         // Colorize: green
        versionLines.append("    CURRENT = 1");                                                                                                                                                          // Colorize: green
        versionLines.append("};");                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(versionLines, thread->getPath() + "/" + ELF_FILE_VERSION_H))                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF file version with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfVersion(SpecVerifyThread *thread, const QString &specContent)                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString versionText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init versionText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionText = "e_version identifies the version of the object file format. Currently, this\n"                                                                                                    // Colorize: green
                        "field has the value EV_CURRENT, which is defined with the value 1.";                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(versionText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF version specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList versionLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        versionLines.append("enum class ElfVersion: u32");                                                                                                                                                // Colorize: green
        versionLines.append("{");                                                                                                                                                                        // Colorize: green
        versionLines.append("    NONE    = 0,");                                                                                                                                                         // Colorize: green
        versionLines.append("    CURRENT = 1");                                                                                                                                                          // Colorize: green
        versionLines.append("};");                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(versionLines, thread->getPath() + "/" + ELF_VERSION_H))                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF version with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfOsAbi(SpecVerifyThread *thread, const QString &specContent)                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString osAbiText;                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init osAbiText                                                                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiText = "Table 5. Operating System and ABI Identifiers, e_ident[EI_OSABI]\n"                                                                                                                 // Colorize: green
                    "Name\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Value\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Meaning\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFOSABI_SYSV\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "System V ABI\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFOSABI_HPUX\n"                                                                                                                                                                    // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "HP-UX operating system\n"                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ELFOSABI_STANDALONE\n"                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "255\n"                                                                                                                                                                              // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Standalone (embedded)\n"                                                                                                                                                            // Colorize: green
                    "application";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(osAbiText))                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF OS ABI specification didn't match with the stored one");                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = osAbiText.split('\n');                                                                                                                                                           // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF OS ABI specification");                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "ELFOSABI_STANDALONE")                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 5;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 4;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_SYSV",       "SYSTEM_V");                                                                                                                         // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_HPUX",       "HP_UX");                                                                                                                            // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ELFOSABI_STANDALONE", "STANDALONE");                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList osAbiLines;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiLines.append("enum class ElfOsAbi: u8");                                                                                                                                                    // Colorize: green
        osAbiLines.append("{");                                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = "0x" + QString("%1").arg(values.at(i).toUShort(), 2, 16, QChar('0')).toUpper();                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "0x00")                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value = "0";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            osAbiLines.append(QString("    %1 = %2%3")                                                                                                                                                   // Colorize: green
                                        .arg(field, -14, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(value)                                                                                                                                                      // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : ""));                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        osAbiLines.append("};");                                                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        osAbiLines.insert(4,  "    NETBSD         = 0x02,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(5,  "    LINUX          = 0x03,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(6,  "    GNU_HURD       = 0x04,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(7,  "    SOLARIS        = 0x06,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(8,  "    AIX            = 0x07,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(9,  "    IRIX           = 0x08,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(10, "    FREEBSD        = 0x09,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(11, "    TRU64          = 0x0A,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(12, "    NOVELL_MODESTO = 0x0B,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(13, "    OPENBSD        = 0x0C,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(14, "    OPENVMS        = 0x0D,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(15, "    NONSTOP_KERNEL = 0x0E,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(16, "    AROS           = 0x0F,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(17, "    FENIX_OS       = 0x10,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(18, "    CLOUD_ABI      = 0x11,");                                                                                                                                             // Colorize: green
        osAbiLines.insert(19, "    SORTIX         = 0x53,");                                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(osAbiLines, thread->getPath() + "/" + ELF_OS_ABI_H))                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF OS ABI with specification");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfType(SpecVerifyThread *thread, const QString &specContent)                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString typeText;                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init typeText                                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        typeText = "Table 6. Object File Types, e_type\n"                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4.\n"                                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Name\n"                                                                                                                                                                             // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Value\n"                                                                                                                                                                            // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Meaning\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_NONE\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "No file type\n"                                                                                                                                                                     // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_REL\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "1\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Relocatable object file\n"                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_EXEC\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "2\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Executable file\n"                                                                                                                                                                  // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_DYN\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "3\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Shared object file\n"                                                                                                                                                               // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_CORE\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "4\n"                                                                                                                                                                                // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Core file\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_LOOS\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0xFE00\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Environment-specific use\n"                                                                                                                                                         // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_HIOS\n"                                                                                                                                                                          // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0xFEFF\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_LOPROC\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0xFF00\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "ET_HIPROC\n"                                                                                                                                                                        // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "0xFFFF\n"                                                                                                                                                                           // Colorize: green
                    "\n"                                                                                                                                                                                 // Colorize: green
                    "Processor-specific use";                                                                                                                                                            // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(typeText))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF type specification didn't match with the stored one");                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = typeText.split('\n');                                                                                                                                                            // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(8) != "Meaning" || lines.at(9) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF type specification");                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 10;                                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "ET_LOOS")                                                                                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 4;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_NONE", "NONE");                                                                                                                                         // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_REL",  "RELOCATABLE");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_EXEC", "EXECUTABLE");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_DYN",  "DYNAMIC_LIBRARY");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("ET_CORE", "CORE");                                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList typeLines;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        typeLines.append("enum class ElfType: u16");                                                                                                                                                     // Colorize: green
        typeLines.append("{");                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            typeLines.append(QString("    %1 = %2%3")                                                                                                                                                    // Colorize: green
                                        .arg(field, -15, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(values.at(i))                                                                                                                                               // Colorize: green
                                        .arg(i < fields.size() - 1 ? "," : ""));                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        typeLines.append("};");                                                                                                                                                                          // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(typeLines, thread->getPath() + "/" + ELF_TYPE_H))                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF type with specification");                                                                                                                                 // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfMachine(SpecVerifyThread *thread, const QString &specContent)                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString machineText;                                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init machineText                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        machineText = "e_machine identifies the target architecture. These values are defined in\n"                                                                                                      // Colorize: green
                        "the processor-specific supplements.";                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(machineText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF machine specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList machineLines;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        machineLines.append("enum class ElfMachine: u16");                                                                                                                                               // Colorize: green
        machineLines.append("{");                                                                                                                                                                        // Colorize: green
        machineLines.append("    NONE             = 0,");                                                                                                                                                // Colorize: green
        machineLines.append("    MACHINE_M32      = 0x0001,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_SPARC    = 0x0002,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_X86      = 0x0003,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_68K      = 0x0004,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_88K      = 0x0005,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_860      = 0x0007,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_MIPS     = 0x0008,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_POWER_PC = 0x0014,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_S390     = 0x0016,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_ARM      = 0x0028,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_SUPERH   = 0x002A,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_IA_64    = 0x0032,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_X86_64   = 0x003E,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_AARCH64  = 0x00B7,");                                                                                                                                           // Colorize: green
        machineLines.append("    MACHINE_RISC_V   = 0x00F3");                                                                                                                                            // Colorize: green
        machineLines.append("};");                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(machineLines, thread->getPath() + "/" + ELF_MACHINE_H))                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF machine with specification");                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionHeaderTableEntry(SpecVerifyThread *thread, const QString &specContent)                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionHeaderTableEntryText;                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionHeaderTableEntryText                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryText = "typedef struct\n"                                                                                                                                               // Colorize: green
                                        "{\n"                                                                                                                                                            // Colorize: green
                                        "Elf64_Word\n"                                                                                                                                                   // Colorize: green
                                        "sh_name;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Word\n"                                                                                                                                                   // Colorize: green
                                        "sh_type;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Xword\n"                                                                                                                                                  // Colorize: green
                                        "sh_flags;\n"                                                                                                                                                    // Colorize: green
                                        "Elf64_Addr\n"                                                                                                                                                   // Colorize: green
                                        "sh_addr;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Off\n"                                                                                                                                                    // Colorize: green
                                        "sh_offset;\n"                                                                                                                                                   // Colorize: green
                                        "Elf64_Xword\n"                                                                                                                                                  // Colorize: green
                                        "sh_size;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Word\n"                                                                                                                                                   // Colorize: green
                                        "sh_link;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Word\n"                                                                                                                                                   // Colorize: green
                                        "sh_info;\n"                                                                                                                                                     // Colorize: green
                                        "Elf64_Xword\n"                                                                                                                                                  // Colorize: green
                                        "sh_addralign;\n"                                                                                                                                                // Colorize: green
                                        "Elf64_Xword\n"                                                                                                                                                  // Colorize: green
                                        "sh_entsize;\n"                                                                                                                                                  // Colorize: green
                                        "} Elf64_Shdr;";                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionHeaderTableEntryText))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF section header table entry specification didn't match with the stored one");                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionHeaderTableEntryText.split('\n');                                                                                                                                         // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(1) != "{")                                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 2;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fieldTypes;                                                                                                                                                                              // Colorize: green
    QStringList fieldNames;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get field types                                                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size() && lines.at(i) != "} Elf64_Shdr;")                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            fieldTypes.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldNames.append(lines.at(i));                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            ++i;                                                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (i != lines.size() - 1)                                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section header table entry specification");                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_name",      "nameOffset");                                                                                                                              // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_type",      "type");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_flags",     "flags");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_addr",      "virtualAddress");                                                                                                                          // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_offset",    "offset");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_size",      "size");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_link",      "link");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_info",      "info");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_addralign", "align");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("sh_entsize",   "entrySize");                                                                                                                               // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionHeaderTableEntryLines;                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryLines.append("struct ElfSectionHeaderTableEntry");                                                                                                                        // Colorize: green
        sectionHeaderTableEntryLines.append("{");                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (i = 0; i < fieldTypes.size(); ++i)                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString type = mElfTypeToNgosTypeMap.value(fieldTypes.at(i), "");                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (type == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF type: %1").arg(fieldTypes.at(i)));                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString fieldName = fieldNames.at(i);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (!fieldName.endsWith(';'))                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Unexpected ELF field name: %1").arg(fieldName));                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fieldName.remove(fieldName.length() - 1, 1);                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString name = elfFieldNamesToNgosFieldNames.value(fieldName, "");                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (name == "")                                                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fieldName));                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionHeaderTableEntryLines.append(QString("    %1 %2;").arg(type, -15, QChar(' ')).arg(name));                                                                                             // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionHeaderTableEntryLines.append("};");                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Replace well known types for fields                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionHeaderTableEntryLines.replaceInStrings("    u32             type;",  "    ElfSectionType  type;");                                                                                        // Colorize: green
        sectionHeaderTableEntryLines.replaceInStrings("    u64             flags;", "    ElfSectionFlags flags;");                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionHeaderTableEntryLines, thread->getPath() + "/" + ELF_SECTION_HEADER_TABLE_ENTRY_H))                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF section header table entry with specification");                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionTypes(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionTypeText;                                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionTypeText                                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeText = "Table 8. Section Types, sh_type\n"                                                                                                                                            // Colorize: green
                            "Name\n"                                                                                                                                                                     // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Value\n"                                                                                                                                                                    // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Meaning\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_NULL\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Marks an unused section header\n"                                                                                                                                           // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_PROGBITS\n"                                                                                                                                                             // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "1\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains information defined by\n"                                                                                                                                          // Colorize: green
                            "the program\n"                                                                                                                                                              // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_SYMTAB\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "2\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains a linker symbol table\n"                                                                                                                                           // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_STRTAB\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "3\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains a string table\n"                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_RELA\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "4\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains \"Rela\" type relocation\n"                                                                                                                                        // Colorize: green
                            "entries\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_HASH\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "5\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains a symbol hash table\n"                                                                                                                                             // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_DYNAMIC\n"                                                                                                                                                              // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "6\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains dynamic linking tables\n"                                                                                                                                          // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_NOTE\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "7\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains note information\n"                                                                                                                                                // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_NOBITS\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "8\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains uninitialized space; does\n"                                                                                                                                       // Colorize: green
                            "not occupy any space in the file\n"                                                                                                                                         // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_REL\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "9\n"                                                                                                                                                                        // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains \"Rel\" type relocation\n"                                                                                                                                         // Colorize: green
                            "entries\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_SHLIB\n"                                                                                                                                                                // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "10\n"                                                                                                                                                                       // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Reserved\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_DYNSYM\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "11\n"                                                                                                                                                                       // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Contains a dynamic loader symbol\n"                                                                                                                                         // Colorize: green
                            "table\n"                                                                                                                                                                    // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_LOOS\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x60000000\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Environment-specific use\n"                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_HIOS\n"                                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x6FFFFFFF\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_LOPROC\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x70000000\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHT_HIPROC\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x7FFFFFFF\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Processor-specific use";                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionTypeText))                                                                                                                                                      // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF section type specification didn't match with the stored one");                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionTypeText.split('\n');                                                                                                                                                     // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section type specification");                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "SHT_LOOS")                                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (                                                                                                                                                                                         // Colorize: green
                field == "SHT_PROGBITS"                                                                                                                                                                  // Colorize: green
                ||                                                                                                                                                                                       // Colorize: green
                field == "SHT_RELA"                                                                                                                                                                      // Colorize: green
                ||                                                                                                                                                                                       // Colorize: green
                field == "SHT_NOBITS"                                                                                                                                                                    // Colorize: green
                ||                                                                                                                                                                                       // Colorize: green
                field == "SHT_REL"                                                                                                                                                                       // Colorize: green
                ||                                                                                                                                                                                       // Colorize: green
                field == "SHT_DYNSYM"                                                                                                                                                                    // Colorize: green
               )                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 5;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 4;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames; // ELF field name => NGOS field name                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NULL",     "NONE");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_PROGBITS", "PROGBITS");                                                                                                                                // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_SYMTAB",   "SYMTAB");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_STRTAB",   "STRTAB");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_RELA",     "RELA");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_HASH",     "HASH");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_DYNAMIC",  "DYNAMIC");                                                                                                                                 // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NOTE",     "NOTE");                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_NOBITS",   "NOBITS");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_REL",      "REL");                                                                                                                                     // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_SHLIB",    "SHLIB");                                                                                                                                   // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHT_DYNSYM",   "DYNSYM");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionTypeLines;                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeLines.append("enum class ElfSectionType: u32");                                                                                                                                       // Colorize: green
        sectionTypeLines.append("{");                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = "0x" + QString("%1").arg(values.at(i).toUShort(), 8, 16, QChar('0')).toUpper();                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "0x00000000")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                value = "0";                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionTypeLines.append(QString("    %1 = %2,")                                                                                                                                              // Colorize: green
                                        .arg(field, -14, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(value));                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionTypeLines.append("};");                                                                                                                                                                   // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionTypeLines.insert(14, "    INIT_ARRAY     = 0x0000000E,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(15, "    FINI_ARRAY     = 0x0000000F,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(16, "    PREINIT_ARRAY  = 0x00000010,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(17, "    GROUP          = 0x00000011,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(18, "    SYMTAB_SHNDX   = 0x00000012,");                                                                                                                                 // Colorize: green
        sectionTypeLines.insert(19, "    NUM            = 0x00000013");                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionTypeLines, thread->getPath() + "/" + ELF_SECTION_TYPE_H))                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF section type with specification");                                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
void ElfSpecVerifier::checkElfSectionFlags(SpecVerifyThread *thread, const QString &specContent)                                                                                                         // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    Q_ASSERT(thread      != nullptr);                                                                                                                                                                    // Colorize: green
    Q_ASSERT(specContent != "");                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QString sectionFlagsText;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Init sectionFlagsText                                                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsText = "Table 9. Section Attributes, sh_flags\n"                                                                                                                                     // Colorize: green
                            "Name\n"                                                                                                                                                                     // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Value\n"                                                                                                                                                                    // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Meaning\n"                                                                                                                                                                  // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHF_WRITE\n"                                                                                                                                                                // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x1\n"                                                                                                                                                                      // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Section contains writable data\n"                                                                                                                                           // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHF_ALLOC\n"                                                                                                                                                                // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x2\n"                                                                                                                                                                      // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Section is allocated in memory\n"                                                                                                                                           // Colorize: green
                            "image of program\n"                                                                                                                                                         // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHF_EXECINSTR\n"                                                                                                                                                            // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x4\n"                                                                                                                                                                      // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Section contains executable\n"                                                                                                                                              // Colorize: green
                            "instructions\n"                                                                                                                                                             // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHF_MASKOS\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0x0F000000\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Environment-specific use\n"                                                                                                                                                 // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "SHF_MASKPROC\n"                                                                                                                                                             // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "0xF0000000\n"                                                                                                                                                               // Colorize: green
                            "\n"                                                                                                                                                                         // Colorize: green
                            "Processor-specific use";                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check that specification contains required text                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (!specContent.contains(sectionFlagsText))                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("ELF section flags specification didn't match with the stored one");                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList lines = sectionFlagsText.split('\n');                                                                                                                                                    // Colorize: green
    qint64      i     = 0;                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Skip lines                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (lines.at(5) != "Meaning" || lines.at(6) != "")                                                                                                                                               // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            thread->addError("Failed to parse ELF section flags specification");                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return;                                                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        i = 7;                                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList fields;                                                                                                                                                                                  // Colorize: green
    QStringList values;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get fields                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (i < lines.size())                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = lines.at(i);                                                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "SHF_MASKOS")                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                break;                                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            fields.append(field);                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            i += 2;                                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            values.append(lines.at(i));                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (                                                                                                                                                                                         // Colorize: green
                field == "SHF_ALLOC"                                                                                                                                                                     // Colorize: green
                ||                                                                                                                                                                                       // Colorize: green
                field == "SHF_EXECINSTR"                                                                                                                                                                 // Colorize: green
               )                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 5;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                i += 4;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QHash<QString, QString> elfFieldNamesToNgosFieldNames;   // ELF field name  => NGOS field name                                                                                                       // Colorize: green
    QHash<QString, QString> elfFieldValuesToNgosFieldValues; // ELF field value => NGOS field value                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill elfFieldNamesToNgosFieldNames                                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_WRITE",     "WRITE");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_ALLOC",     "ALLOC");                                                                                                                                  // Colorize: green
        elfFieldNamesToNgosFieldNames.insert("SHF_EXECINSTR", "EXECINSTR");                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x1", "(1ULL << 0)");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x2", "(1ULL << 1)");                                                                                                                                    // Colorize: green
        elfFieldValuesToNgosFieldValues.insert("0x4", "(1ULL << 2)");                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    QStringList sectionFlagsLines;                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Prepare lines for comparing with source code                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.append("typedef u64 elf_section_flags;");                                                                                                                                      // Colorize: green
        sectionFlagsLines.append("");                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.append("enum class ElfSectionFlag: elf_section_flags");                                                                                                                        // Colorize: green
        sectionFlagsLines.append("{");                                                                                                                                                                   // Colorize: green
        sectionFlagsLines.append("    NONE             = 0,");                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        for (qint64 i = 0; i < fields.size(); ++i)                                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            QString field = elfFieldNamesToNgosFieldNames.value(fields.at(i), "");                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (field == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field name: %1").arg(fields.at(i)));                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            QString value = elfFieldValuesToNgosFieldValues.value(values.at(i), "");                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (value == "")                                                                                                                                                                             // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                thread->addError(QString("Failed to convert ELF field value: %1").arg(values.at(i)));                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return;                                                                                                                                                                                  // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            sectionFlagsLines.append(QString("    %1 = %2,")                                                                                                                                             // Colorize: green
                                        .arg(field, -16, QChar(' '))                                                                                                                                     // Colorize: green
                                        .arg(value));                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        sectionFlagsLines.append("};");                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Insert some specific fields                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        sectionFlagsLines.insert(8,  "    MERGE            = (1ULL << 4),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(9,  "    STRINGS          = (1ULL << 5),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(10, "    INFO_LINK        = (1ULL << 6),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(11, "    LINK_ORDER       = (1ULL << 7),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(12, "    OS_NONCONFORMING = (1ULL << 8),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(13, "    GROUP            = (1ULL << 9),");                                                                                                                             // Colorize: green
        sectionFlagsLines.insert(14, "    TLS              = (1ULL << 10),");                                                                                                                            // Colorize: green
        sectionFlagsLines.insert(15, "    ORDERED          = (1ULL << 26),");                                                                                                                            // Colorize: green
        sectionFlagsLines.insert(16, "    EXCLUDE          = (1ULL << 27)");                                                                                                                             // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!checkLinesInFile(sectionFlagsLines, thread->getPath() + "/" + ELF_SECTION_FLAGS_H))                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        thread->addError("Failed to check ELF section flags with specification");                                                                                                                        // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
ElfSpecVerifier elfSpecVerifierInstance;                                                                                                                                                                 // Colorize: green
