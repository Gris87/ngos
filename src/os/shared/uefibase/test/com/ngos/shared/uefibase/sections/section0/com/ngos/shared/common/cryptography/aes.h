#ifndef COM_NGOS_SHARED_UEFIBASE_SECTIONS_SECTION0_COM_NGOS_SHARED_COMMON_CRYPTOGRAPHY_AES_H                                                                                                             // Colorize: green
#define COM_NGOS_SHARED_UEFIBASE_SECTIONS_SECTION0_COM_NGOS_SHARED_COMMON_CRYPTOGRAPHY_AES_H                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <buildconfig.h>                                                                                                                                                                                 // Colorize: green
#include <com/ngos/shared/common/checksum/adler.h>                                                                                                                                                       // Colorize: green
#include <com/ngos/shared/common/checksum/crc.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/checksum/md5.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/cpu/cpu.h>                                                                                                                                                              // Colorize: green
#include <com/ngos/shared/common/cryptography/aes.h>                                                                                                                                                     // Colorize: green
#include <com/ngos/shared/common/memory/malloc.h>                                                                                                                                                        // Colorize: green
#include <com/ngos/shared/common/memory/memory.h>                                                                                                                                                        // Colorize: green
#include <com/ngos/shared/common/string/string.h>                                                                                                                                                        // Colorize: green
#include <com/ngos/shared/uefibase/testengine.h>                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#if NGOS_BUILD_TEST_MODE == OPTION_YES                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
TEST_CASES(section0, com_ngos_shared_common_cryptography_aes);                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    TEST_CASE("AES()");                                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (CPU::hasFeature(X86Feature::AESNI))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            AES aes;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKeyAllocated,  nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKeyAllocated,  nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKey,           nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKey,           nullptr);                                                                                                                                       // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            UEFI_LVV(("X86Feature::AESNI not supported"));                                                                                                                                               // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    TEST_CASE_END();                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    TEST_CASE("setKey()/releaseKey()");                                                                                                                                                                  // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (CPU::hasFeature(X86Feature::AESNI))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            AES aes;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKeyAllocated,  nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKeyAllocated,  nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKey,           nullptr);                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKey,           nullptr);                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_U8 key16[16] = { 3, 1, 9, 4, 6, 8, 9, 2, 3, 7, 9, 1, 6, 7, 9, 1 };                                                                                                                           // Colorize: green
            good_U8 key24[24] = { 3, 1, 9, 4, 6, 8, 9, 2, 3, 7, 9, 1, 6, 7, 9, 1, 3, 4, 7, 8, 9, 2, 3, 4 };                                                                                                   // Colorize: green
            good_U8 key32[32] = { 3, 1, 9, 4, 6, 8, 9, 2, 3, 7, 9, 1, 6, 7, 9, 1, 3, 4, 7, 8, 9, 2, 3, 4, 3, 4, 7, 8, 9, 2, 3, 4 };                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(key16, sizeof(key16)), NgosStatus::OK);                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKey,           nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKey,           nullptr);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 11 * 16), 0x98C94D76);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     11 * 16), 0x0495671B);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     11 * 16), 0xAA263E486D960ACD);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       11 * 16), Md5Hash(0x22BD8D8930A3C4DE, 0x939E6E4870ADDE14));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 11 * 16), 0xB5635614);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     11 * 16), 0xC4C8131C);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     11 * 16), 0xF4C91CB7B40C7925);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       11 * 16), Md5Hash(0x152CEB119DAFA637, 0xD250D862DBDEFC9D));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.releaseKey(), NgosStatus::OK);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKey,               nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKey,               nullptr);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(key24, sizeof(key24)), NgosStatus::OK);                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKey,           nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKey,           nullptr);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 13 * 16), 0xAEAA587C);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     13 * 16), 0xDA69EE0E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     13 * 16), 0xAA956958D3E85FAD);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       13 * 16), Md5Hash(0xBD9117A66B49132E, 0x8B684C3733A38E37));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 13 * 16), 0x05505C78);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     13 * 16), 0x0D554BB2);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     13 * 16), 0x98F4BE8CB01C793B);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       13 * 16), Md5Hash(0x6202BFDFF0F08B2A, 0x8202E5D3C1C6D7C0));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.releaseKey(), NgosStatus::OK);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKey,               nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKey,               nullptr);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(key32, sizeof(key32)), NgosStatus::OK);                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKeyAllocated,  nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeKey,           nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeKey,           nullptr);                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 15 * 16), 0x2DA4612C);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     15 * 16), 0x4EBCB0FB);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     15 * 16), 0xE076BD5EE0F7DF77);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       15 * 16), Md5Hash(0x3B9102904F2F836E, 0xA3493207A5791FB4));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 15 * 16), 0x7C186DA0);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     15 * 16), 0x3FDADD3E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     15 * 16), 0x321FE632D2A16B24);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       15 * 16), Md5Hash(0xF3B30806DB05973B, 0x5044BEC4E1DCB262));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.releaseKey(), NgosStatus::OK);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mEncodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_NOT_EQUALS(aes.mDecodeBlockFunction, nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKeyAllocated,      nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mEncodeKey,               nullptr);                                                                                                                                   // Colorize: green
            TEST_ASSERT_EQUALS(aes.mDecodeKey,               nullptr);                                                                                                                                   // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            UEFI_LVV(("X86Feature::AESNI not supported"));                                                                                                                                               // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    TEST_CASE_END();                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    TEST_CASE("encode()");                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (CPU::hasFeature(X86Feature::AESNI))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            AES aes;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            const good_Char8 *key16 = "NGOS is the best";                                                                                                                                                     // Colorize: green
            const good_Char8 *key24 = "NGOS is the best OS ever";                                                                                                                                             // Colorize: green
            const good_Char8 *key32 = "NGOS is the best OS ever !!!!!!!";                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key16), 16);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key24), 24);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key32), 32);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_U8  in[16] __attribute__((aligned(16)));                                                                                                                                                // Colorize: green
            good_I64 inSize;                                                                                                                                                                             // Colorize: green
            good_U8  out[16] __attribute__((aligned(16)));                                                                                                                                               // Colorize: green
            good_I64 outSize;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            in[0]  = 'H';                                                                                                                                                                                // Colorize: green
            in[1]  = 'e';                                                                                                                                                                                // Colorize: green
            in[2]  = 'l';                                                                                                                                                                                // Colorize: green
            in[3]  = 'l';                                                                                                                                                                                // Colorize: green
            in[4]  = 'o';                                                                                                                                                                                // Colorize: green
            in[5]  = 0;                                                                                                                                                                                  // Colorize: green
            inSize = 5;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key16), strlen(key16)), NgosStatus::OK);                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 11 * 16), 0x5C545A98);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     11 * 16), 0xE5F76028);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     11 * 16), 0xC172975B03490927);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       11 * 16), Md5Hash(0x0EB7F80E6350F4EC, 0x2C03CB2F2CEBA577));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 11 * 16), 0xE613559E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     11 * 16), 0x6F98A19E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     11 * 16), 0xB1E3801C9D9249A0);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       11 * 16), Md5Hash(0x0BEBD7D3B1AFDD78, 0x869209C8940EDC53));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in, inSize, out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 16);                                                                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  0x88);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  0x10);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  0x31);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  0x80);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  0xE2);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0x9E);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0xCD);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0x89);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0x28);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0x33);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0x85);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0xC6);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0xDC);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0xC0);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0xB8);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0xB0);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key24), strlen(key24)), NgosStatus::OK);                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 13 * 16), 0xA9345D34);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     13 * 16), 0xA6ABF5AF);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     13 * 16), 0x2D83EF2BAC5302FD);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       13 * 16), Md5Hash(0xD9D0B897B9857F3E, 0x9698542CAB8C71E5));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 13 * 16), 0x069D64BA);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     13 * 16), 0xA46830FD);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     13 * 16), 0x6B6E204D03AB08EC);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       13 * 16), Md5Hash(0x2A4A2B867F6D6348, 0x9BA73FFF38F4A186));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in, inSize, out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 16);                                                                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  0x2F);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  0xD0);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  0x6A);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  0x96);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  0xEA);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0x2A);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0xF4);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0xAE);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0x34);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0xCC);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0x59);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0x69);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0x4B);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0x50);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0xAC);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0xB0);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key32), strlen(key32)), NgosStatus::OK);                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 15 * 16), 0x629D6DB5);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     15 * 16), 0xD9A5C95B);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     15 * 16), 0x642CBC3BEEBFBA69);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       15 * 16), Md5Hash(0x54593CE37EFC37C6, 0xDBD85BC517C940D3));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 15 * 16), 0x7D687607);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     15 * 16), 0x701A88A1);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     15 * 16), 0x1FE81C032BFC3548);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       15 * 16), Md5Hash(0x3307EC988BACCCF4, 0xB3B524FFBAFEC9D2));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in, inSize, out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 16);                                                                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  0x93);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  0xAB);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  0x63);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  0x70);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  0xC5);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0x68);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0x33);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0x81);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0x71);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0x7B);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0x90);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0x63);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0x64);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0xFF);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0x11);                                                                                                                                                           // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0x27);                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            UEFI_LVV(("X86Feature::AESNI not supported"));                                                                                                                                               // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    TEST_CASE_END();                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    TEST_CASE("decode()");                                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (CPU::hasFeature(X86Feature::AESNI))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            AES aes;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            const good_Char8 *key16 = "NGOS is the best";                                                                                                                                                     // Colorize: green
            const good_Char8 *key24 = "NGOS is the best OS ever";                                                                                                                                             // Colorize: green
            const good_Char8 *key32 = "NGOS is the best OS ever !!!!!!!";                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key16), 16);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key24), 24);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key32), 32);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_U8 in1[16] __attribute__((aligned(16))) = { 0x88, 0x10, 0x31, 0x80, 0xE2, 0x9E, 0xCD, 0x89, 0x28, 0x33, 0x85, 0xC6, 0xDC, 0xC0, 0xB8, 0xB0 };                                           // Colorize: green
            good_U8 in2[16] __attribute__((aligned(16))) = { 0x2F, 0xD0, 0x6A, 0x96, 0xEA, 0x2A, 0xF4, 0xAE, 0x34, 0xCC, 0x59, 0x69, 0x4B, 0x50, 0xAC, 0xB0 };                                           // Colorize: green
            good_U8 in3[16] __attribute__((aligned(16))) = { 0x93, 0xAB, 0x63, 0x70, 0xC5, 0x68, 0x33, 0x81, 0x71, 0x7B, 0x90, 0x63, 0x64, 0xFF, 0x11, 0x27 };                                           // Colorize: green
            good_U8 out[16] __attribute__((aligned(16)));                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key16), strlen(key16)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 11 * 16), 0x5C545A98);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     11 * 16), 0xE5F76028);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     11 * 16), 0xC172975B03490927);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       11 * 16), Md5Hash(0x0EB7F80E6350F4EC, 0x2C03CB2F2CEBA577));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 11 * 16), 0xE613559E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     11 * 16), 0x6F98A19E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     11 * 16), 0xB1E3801C9D9249A0);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       11 * 16), Md5Hash(0x0BEBD7D3B1AFDD78, 0x869209C8940EDC53));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(in1, sizeof(in1), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  'H');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  'e');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  'o');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0);                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key24), strlen(key24)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 13 * 16), 0xA9345D34);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     13 * 16), 0xA6ABF5AF);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     13 * 16), 0x2D83EF2BAC5302FD);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       13 * 16), Md5Hash(0xD9D0B897B9857F3E, 0x9698542CAB8C71E5));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 13 * 16), 0x069D64BA);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     13 * 16), 0xA46830FD);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     13 * 16), 0x6B6E204D03AB08EC);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       13 * 16), Md5Hash(0x2A4A2B867F6D6348, 0x9BA73FFF38F4A186));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(in2, sizeof(in2), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  'H');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  'e');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  'o');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0);                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key32), strlen(key32)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 15 * 16), 0x629D6DB5);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     15 * 16), 0xD9A5C95B);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     15 * 16), 0x642CBC3BEEBFBA69);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       15 * 16), Md5Hash(0x54593CE37EFC37C6, 0xDBD85BC517C940D3));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 15 * 16), 0x7D687607);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     15 * 16), 0x701A88A1);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     15 * 16), 0x1FE81C032BFC3548);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       15 * 16), Md5Hash(0x3307EC988BACCCF4, 0xB3B524FFBAFEC9D2));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(in3, sizeof(in3), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(out[0],  'H');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[1],  'e');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[2],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[3],  'l');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[4],  'o');                                                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(out[5],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[6],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[7],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[8],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[9],  0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[10], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[11], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[12], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[13], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[14], 0);                                                                                                                                                              // Colorize: green
            TEST_ASSERT_EQUALS(out[15], 0);                                                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            UEFI_LVV(("X86Feature::AESNI not supported"));                                                                                                                                               // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    TEST_CASE_END();                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    TEST_CASE("encode()/decode(). Huge data");                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (CPU::hasFeature(X86Feature::AESNI))                                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            AES aes;                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            const good_Char8 *key16 = "My dear password";                                                                                                                                                     // Colorize: green
            const good_Char8 *key24 = "My dear password. Don't ";                                                                                                                                             // Colorize: green
            const good_Char8 *key32 = "My dear password. Don't touch it";                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key16), 16);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key24), 24);                                                                                                                                                       // Colorize: green
            TEST_ASSERT_EQUALS(strlen(key32), 32);                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_U8 in1[1024] __attribute__((aligned(16)));                                                                                                                                              // Colorize: green
            good_U8 in2[1021] __attribute__((aligned(16)));                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_U8  out[1024] __attribute__((aligned(16)));                                                                                                                                             // Colorize: green
            good_I64 outSize;                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            memzero(in1, sizeof(in1));                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            for (good_I64 i = 0; i < (i64)sizeof(in2); ++i)                                                                                                                                              // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                in2[i] = i;                                                                                                                                                                              // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(in1, sizeof(in1)), 0x04000001);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(in1,     sizeof(in1)), 0xEFB5AF2E);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(in1,     sizeof(in1)), 0xC37863972069270C);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(in1,       sizeof(in1)), Md5Hash(0x206A1231093B340F, 0x3B8A012B7CD633F1));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(in2, sizeof(in2)), 0xED68FB16);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(in2,     sizeof(in2)), 0xB02C88C3);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(in2,     sizeof(in2)), 0xD48B50F4AEA8861E);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(in2,       sizeof(in2)), Md5Hash(0xC98DADC0305B4A9D, 0xF1622901D278C2D3));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key16), strlen(key16)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 11 * 16), 0x83F04CEB);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     11 * 16), 0xAA4FEC5B);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     11 * 16), 0xFF7AD7EC97BE945E);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       11 * 16), Md5Hash(0x65D6157850007260, 0x51B3416E46443988));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 11 * 16), 0x270154F9);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     11 * 16), 0x67C493F8);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     11 * 16), 0x117874F11820B404);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       11 * 16), Md5Hash(0x974F07476FCE564C, 0xB550BC83C3A0442B));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in1, sizeof(in1), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0x79CFE010);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0x29C10B16);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0xDF44F11A5775710B);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0x48F1A963D4489632, 0x4C45775772CAA0F9));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in1, sizeof(in1)), 0);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in2, sizeof(in2), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0xC4B3F413);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0x0D272E99);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0x5C47870B657D6457);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0x737DDBB38D05E8B7, 0x1AAD0DA1F50CC84B));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in2, sizeof(in2)), 0);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key24), strlen(key24)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 13 * 16), 0xD48767CA);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     13 * 16), 0x59253515);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     13 * 16), 0x408DB89C7B6580BB);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       13 * 16), Md5Hash(0x4A6631D2919DE41F, 0x7AD4844F2E801AD2));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 13 * 16), 0x09796A2E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     13 * 16), 0xADC7B273);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     13 * 16), 0x3173486106C406BE);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       13 * 16), Md5Hash(0xA100C88D79338823, 0x09216994C7140985));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in1, sizeof(in1), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0xFDC367DF);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0x7C6BCE5E);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0xDCAC84C2AC7D4534);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0x43E20F001ADEBA15, 0x3B246605611C3CDF));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in1, sizeof(in1)), 0);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in2, sizeof(in2), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0x4BDDF59E);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0xC201D676);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0x543E6CD575B19B5D);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0x591370C08768A9A2, 0xE5B9090B68F362F1));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in2, sizeof(in2)), 0);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.setKey(reinterpret_cast<const good_U8 *>(key32), strlen(key32)), NgosStatus::OK);                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mEncodeKey, 15 * 16), 0xCECE76DC);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mEncodeKey,     15 * 16), 0x9D3D1B5B);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mEncodeKey,     15 * 16), 0xD8C69E0E57F05BDD);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mEncodeKey,       15 * 16), Md5Hash(0x188DC615BE7B86D5, 0x3BF8BF81DC3F0CFA));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(aes.mDecodeKey, 15 * 16), 0x971F7B4E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(aes.mDecodeKey,     15 * 16), 0x7ECC1A9E);                                                                                                                     // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(aes.mDecodeKey,     15 * 16), 0x34E2C4D3702F8599);                                                                                                             // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(aes.mDecodeKey,       15 * 16), Md5Hash(0x4C44CA6392F9BC30, 0x21D8368F400C237C));                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in1, sizeof(in1), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0x16B5DCD0);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0x49B097FA);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0xCFD697AFB71E04A1);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0x54F0277BB35CACA3, 0x7167925636792BEC));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in1, sizeof(in1)), 0);                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.encode(in2, sizeof(in2), out, sizeof(out), &outSize), NgosStatus::OK);                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(outSize, 1024);                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(Adler::adler32(out, sizeof(out)), 0x8706007E);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc32(out,     sizeof(out)), 0xD6247745);                                                                                                                            // Colorize: green
            TEST_ASSERT_EQUALS(Crc::crc64(out,     sizeof(out)), 0x165E3E713FA071A9);                                                                                                                    // Colorize: green
            TEST_ASSERT_EQUALS(MD5::md5(out,       sizeof(out)), Md5Hash(0xF1416DF0D4C16F49, 0xC710F24BB1203434));                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(aes.decode(out, sizeof(out), out, sizeof(out)), NgosStatus::OK);                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            TEST_ASSERT_EQUALS(memcmp(out, in2, sizeof(in2)), 0);                                                                                                                                        // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            UEFI_LVV(("X86Feature::AESNI not supported"));                                                                                                                                               // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
    TEST_CASE_END();                                                                                                                                                                                     // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
TEST_CASES_END();                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif                                                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_UEFIBASE_SECTIONS_SECTION0_COM_NGOS_SHARED_COMMON_CRYPTOGRAPHY_AES_H                                                                                                           // Colorize: green
