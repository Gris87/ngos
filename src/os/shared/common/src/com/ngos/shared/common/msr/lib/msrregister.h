#ifndef COM_NGOS_SHARED_COMMON_MSR_LIB_MSRREGISTER_H                                                                                                                                                     // Colorize: green
#define COM_NGOS_SHARED_COMMON_MSR_LIB_MSRREGISTER_H                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/cpu/lib/cpuvendor.h>                                                                                                                                                    // Colorize: green
#include <com/ngos/shared/common/log/assert.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/log/log.h>                                                                                                                                                              // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/printf/printf.h>                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
enum class MsrRegister: good_U32 // Ignore CppEnumVerifier // TODO: Validate with spec_verifier // https://cdrdv2.intel.com/v1/dl/getContent/671098                                                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    NONE                         = 0,                                                                                                                                                                    // Colorize: green
    KVM_CLOCKSOURCE_WALL_CLOCK   = 0x00000011, // KVM clock 1 wall clock                                                                                                                                 // Colorize: green
    KVM_CLOCKSOURCE_SYSTEM_TIME  = 0x00000012, // KVM clock 1 system time                                                                                                                                // Colorize: green
    IA32_BIOS_SIGN_ID            = 0x0000008B, // BIOS Update Signature (R/W)                                                                                                                                     // Colorize: green
    IA32_ARCH_CAPABILITIES       = 0x0000010A, // Enumeration of Architectural Features (R/O)                                                                                                                              // Colorize: green
    IA32_MISC_ENABLE             = 0x000001A0, // Enable Misc. Processor Features (R/W)                                                                                                                                      // Colorize: green
    KVM_CLOCKSOURCE2_WALL_CLOCK  = 0x4B564D00, // KVM clock 2 wall clock                                                                                                                                 // Colorize: green
    KVM_CLOCKSOURCE2_SYSTEM_TIME = 0x4B564D01, // KVM clock 2 system time                                                                                                                                // Colorize: green
    IA32_EFER                    = 0xC0000080, // Extended Feature Enables                                                                                                                       // Colorize: green
    IA32_FS_BASE                 = 0xC0000100, // Map of BASE Address of FS (R/W)                                                                                                                                         // Colorize: green
    IA32_GS_BASE                 = 0xC0000101  // Map of BASE Address of GS (R/W)                                                                                                                                         // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* enumToString(MsrRegister reg) // TEST: NO                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | reg = %u", reg)); // Commented to avoid bad looking logs                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    switch (reg)                                                                                                                                                                                         // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        case MsrRegister::NONE: return "NONE";                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        default: return "UNKNOWN";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* enumToFullString(MsrRegister reg) // TEST: NO                                                                                                                                        // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | reg = %u", reg)); // Commented to avoid bad looking logs                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[50];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    sprintf(res, "0x%08X (%s)", static_cast<good_U32>(reg), enumToString(reg));                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_COMMON_MSR_LIB_MSRREGISTER_H                                                                                                                                                   // Colorize: green
