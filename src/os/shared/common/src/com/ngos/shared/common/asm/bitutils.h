#ifndef COM_NGOS_SHARED_COMMON_ASM_BITUTILS_H                                                                                                                                                            // Colorize: green
#define COM_NGOS_SHARED_COMMON_ASM_BITUTILS_H                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/asm/asmutils.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/linkage.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/status.h>                                                                                                                                                          // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/ngos/utils.h>                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define CONST_BIT_ADDRESS(address, bit) (reinterpret_cast<good_U8 *>(address) + (bit) / 8)                                                                                                                    // Colorize: green
#define CONST_BIT_IN_U8(bit)            (1ULL << (7 - ((bit) & 7)))                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
class BitUtils                                                                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
public:                                                                                                                                                                                                  // Colorize: green
    static inline bool test(good_U8 *address, good_U64 bit)                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return *CONST_BIT_ADDRESS(address, bit) & CONST_BIT_IN_U8(bit);                                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::bt(address, bit);                                                                                                                                                           // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus set(good_U8 *address, good_U64 bit)                                                                                                                                                   // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "orb    %1, %0"                                 // orb    %rax, (%rbx)  # Sets bit RAX starting from address RBX. %rax == bit. %rbx == address                                           // Colorize: green
                    :                                           // Output parameters                                                                                                                     // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit)) // 'm' - use memory, '+' - read and write                                                                                                // Colorize: green
                    :                                           // Input parameters                                                                                                                      // Colorize: green
                        "i" (CONST_BIT_IN_U8(bit))              // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                                // Colorize: green
                    :                                           // Clobber list                                                                                                                          // Colorize: green
                        "memory"                                // Inform gcc that memory will be changed                                                                                                // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btsPure(address, bit);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus setSafe(good_U8 *address, good_U64 bit)                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "lock orb   %1, %0"                             // lock orb   %rax, (%rbx)  # lock - CPU will lock system Bus until instruction finish # Sets bit RAX starting from address RBX. %rax == bit. %rbx == address // Colorize: green
                    :                                           // Output parameters                                                                                                                     // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit)) // 'm' - use memory, '+' - read and write                                                                                                // Colorize: green
                    :                                           // Input parameters                                                                                                                      // Colorize: green
                        "i" (CONST_BIT_IN_U8(bit))              // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                                // Colorize: green
                    :                                           // Clobber list                                                                                                                          // Colorize: green
                        "memory"                                // Inform gcc that memory will be changed                                                                                                // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btsPureSafe(address, bit);                                                                                                                                                  // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus clear(good_U8 *address, good_U64 bit)                                                                                                                                                 // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "andb   %1, %0"                                         // andb   %rax, (%rbx)  # Clears bit RAX starting from address RBX. %rax == bit. %rbx == address                                 // Colorize: green
                    :                                                   // Output parameters                                                                                                             // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit))         // 'm' - use memory, '+' - read and write                                                                                        // Colorize: green
                    :                                                   // Input parameters                                                                                                              // Colorize: green
                        "i" (static_cast<good_U8>(~CONST_BIT_IN_U8(bit)))    // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                        // Colorize: green
                    :                                                   // Clobber list                                                                                                                  // Colorize: green
                        "memory"                                        // Inform gcc that memory will be changed                                                                                        // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btrPure(address, bit);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus clearSafe(good_U8 *address, good_U64 bit)                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "lock andb  %1, %0"                                     // lock andb  %rax, (%rbx)  # lock - CPU will lock system Bus until instruction finish # Clears bit RAX starting from address RBX. %rax == bit. %rbx == address // Colorize: green
                    :                                                   // Output parameters                                                                                                             // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit))         // 'm' - use memory, '+' - read and write                                                                                        // Colorize: green
                    :                                                   // Input parameters                                                                                                              // Colorize: green
                        "i" (static_cast<good_U8>(~CONST_BIT_IN_U8(bit)))    // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                        // Colorize: green
                    :                                                   // Clobber list                                                                                                                  // Colorize: green
                        "memory"                                        // Inform gcc that memory will be changed                                                                                        // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btrPureSafe(address, bit);                                                                                                                                                  // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus invert(good_U8 *address, good_U64 bit)                                                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "xorb   %1, %0"                                 // xorb   %rax, (%rbx)  # Inverts bit RAX starting from address RBX. %rax == bit. %rbx == address                                        // Colorize: green
                    :                                           // Output parameters                                                                                                                     // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit)) // 'm' - use memory, '+' - read and write                                                                                                // Colorize: green
                    :                                           // Input parameters                                                                                                                      // Colorize: green
                        "i" (CONST_BIT_IN_U8(bit))              // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                                // Colorize: green
                    :                                           // Clobber list                                                                                                                          // Colorize: green
                        "memory"                                // Inform gcc that memory will be changed                                                                                                // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btcPure(address, bit);                                                                                                                                                      // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline NgosStatus invertSafe(good_U8 *address, good_U64 bit)                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_CONSTANT(bit))                                                                                                                                                                            // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                       // Colorize: green
            asm volatile(                                                                                                                                                                                // Colorize: green
                "lock xorb  %1, %0"                             // lock xorb  %rax, (%rbx)  # lock - CPU will lock system Bus until instruction finish # Inverts bit RAX starting from address RBX. %rax == bit. %rbx == address // Colorize: green
                    :                                           // Output parameters                                                                                                                     // Colorize: green
                        "+m" (*CONST_BIT_ADDRESS(address, bit)) // 'm' - use memory, '+' - read and write                                                                                                // Colorize: green
                    :                                           // Input parameters                                                                                                                      // Colorize: green
                        "i" (CONST_BIT_IN_U8(bit))              // 'i' - integer constant // Ignore CppSingleCharVerifier                                                                                // Colorize: green
                    :                                           // Clobber list                                                                                                                          // Colorize: green
                        "memory"                                // Inform gcc that memory will be changed                                                                                                // Colorize: green
            );                                                                                                                                                                                           // Colorize: green
            // Ignore CppAlignmentVerifier [END]                                                                                                                                                         // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return AsmUtils::btcPureSafe(address, bit);                                                                                                                                                  // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return NgosStatus::OK;                                                                                                                                                                           // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstBit16(good_U16 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U16 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfw   %1, %0"     // bsfw   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                      // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstBit32(good_U32 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U32 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfl   %1, %0"     // bsfl   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                      // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstBit64(good_U64 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U64 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfq   %1, %0"     // bsfq   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                      // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstZero16(good_U16 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U16>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U16 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfw   %1, %0"                         // bsfw   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                  // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U16>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstZero32(good_U32 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U32>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U32 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfl   %1, %0"                         // bsfl   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                  // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U32>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findFirstZero64(good_U64 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U64>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U64 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsfq   %1, %0"                         // bsfq   %rdx, %rax    # Find first bit in RDX and store result in RAX. %rax == res. %rdx == value                                                  // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U64>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastBit16(good_U16 value)                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U16 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrw   %1, %0"     // bsrw   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                       // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastBit32(good_U32 value)                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U32 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrl   %1, %0"     // bsrl   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                       // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastBit64(good_U64 value)                                                                                                                                                            // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == 0)                                                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U64 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrq   %1, %0"     // bsrq   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                                       // Colorize: green
                :               // Output parameters                                                                                                                                                     // Colorize: green
                    "=r" (res)  // 'r' - any general register, '=' - write only                                                                                                                          // Colorize: green
                :               // Input parameters                                                                                                                                                      // Colorize: green
                    "r" (value) // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                                            // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastZero16(good_U16 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U16>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U16 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrw   %1, %0"                         // bsrw   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                   // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U16>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastZero32(good_U32 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U32>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U32 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrl   %1, %0"                         // bsrl   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                   // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U32>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 findLastZero64(good_U64 value)                                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (value == static_cast<good_U64>(-1LL))                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return -1;                                                                                                                                                                                    // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        good_U64 res;                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Ignore CppAlignmentVerifier [BEGIN]                                                                                                                                                           // Colorize: green
        asm volatile(                                                                                                                                                                                    // Colorize: green
            "bsrq   %1, %0"                         // bsrq   %rdx, %rax    # Find last bit in RDX and store result in RAX. %rax == res. %rdx == value                                                   // Colorize: green
                :                                   // Output parameters                                                                                                                                 // Colorize: green
                    "=r" (res)                      // 'r' - any general register, '=' - write only                                                                                                      // Colorize: green
                :                                   // Input parameters                                                                                                                                  // Colorize: green
                    "r" (static_cast<good_U64>(~value))  // 'r' - any general register // Ignore CppSingleCharVerifier                                                                                        // Colorize: green
        );                                                                                                                                                                                               // Colorize: green
        // Ignore CppAlignmentVerifier [END]                                                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        return res;                                                                                                                                                                                  // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 getCountOrder16(good_U16 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_POWER_OF_2(value))                                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit16(value);                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit16(value) + 1;                                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 getCountOrder32(good_U32 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_POWER_OF_2(value))                                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit32(value);                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit32(value) + 1;                                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static inline good_I8 getCountOrder64(good_U64 value)                                                                                                                                                          // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (IS_POWER_OF_2(value))                                                                                                                                                                        // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit64(value);                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return findLastBit64(value) + 1;                                                                                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_COMMON_ASM_BITUTILS_H                                                                                                                                                          // Colorize: green
