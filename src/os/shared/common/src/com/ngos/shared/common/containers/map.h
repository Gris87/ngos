#ifndef COM_NGOS_SHARED_COMMON_CONTAINERS_MAP_H                                                                                                                                                          // Colorize: green
#define COM_NGOS_SHARED_COMMON_CONTAINERS_MAP_H                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/containers/arraylist.h>                                                                                                                                                 // Colorize: green
#include <com/ngos/shared/common/containers/lib/mapelement.h>                                                                                                                                            // Colorize: green
#include <com/ngos/shared/common/log/assert.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/log/log.h>                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
class Map                                                                                                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
public:                                                                                                                                                                                                  // Colorize: green
    Map();                                                                                                                                                                                               // Colorize: green
    ~Map(); // TEST: NO                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    NgosStatus insert(const Key &key, const Value &value);                                                                                                                                               // Colorize: green
    NgosStatus remove(const Key &key);                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    NgosStatus clear();                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    bool contains(const Key &key) const;                                                                                                                                                                 // Colorize: green
    const Value& value(const Key &key, const Value &defaultValue) const;                                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 getSize() const;                                                                                                                                                                            // Colorize: green
    bool isEmpty() const;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    const ArrayList<MapElement<Key, Value>>& getPairs() const;                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#if NGOS_BUILD_TEST_MODE == OPTION_YES                                                                                                                                                                   // Colorize: green
public:                                                                                                                                                                                                  // Colorize: green
#else                                                                                                                                                                                                    // Colorize: green
private:                                                                                                                                                                                                 // Colorize: green
#endif                                                                                                                                                                                                   // Colorize: green
    ArrayList<MapElement<Key, Value>> mPairs;                                                                                                                                                            // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
Map<Key, Value>::Map()                                                                                                                                                                                   // Colorize: green
    : mPairs()                                                                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
Map<Key, Value>::~Map()                                                                                                                                                                                  // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Free memory                                                                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        COMMON_ASSERT_EXECUTION(clear());                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
NgosStatus Map<Key, Value>::insert(const Key &key, const Value &value)                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | key = ..., value = ...")); // Commented to avoid too frequent logs                                                                                                                 // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Special cases to improve performance                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // If there is no any pair then simply insert first one                                                                                                                                          // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            if (mPairs.isEmpty())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return mPairs.append(MapElement(key, value));                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the last key                                                                                                                                                                 // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &lastElement = mPairs.last();                                                                                                                                   // Colorize: green
            const Key                    &lastKey     = lastElement.getKey();                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key > lastKey)                                                                                                                                                                           // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return mPairs.append(MapElement(key, value));                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == lastKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                COMMON_ASSERT_EXECUTION(mPairs[mPairs.getSize() - 1].setValue(value), NgosStatus::ASSERTION);                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return NgosStatus::OK;                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the first key                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &firstElement = mPairs.first();                                                                                                                                 // Colorize: green
            const Key                    &firstKey     = firstElement.getKey();                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key < firstKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return mPairs.prepend(MapElement(key, value));                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == firstKey)                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                COMMON_ASSERT_EXECUTION(mPairs[0].setValue(value), NgosStatus::ASSERTION);                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return NgosStatus::OK;                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 left  = 0;                                                                                                                                                                                  // Colorize: green
    good_I64 right = mPairs.getSize();                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Binary search for the element or for position for insertion                                                                                                                                       // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (left < right)                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            good_I64 middle = (left + right) / 2;                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key <= mPairs.at(middle).getKey())                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                right = middle;                                                                                                                                                                          // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                left = middle + 1;                                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // COMMON_LVVV(("left  = %u", left));  // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
    // COMMON_LVVV(("right = %u", right)); // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(left == right,           NgosStatus::ASSERTION);                                                                                                                                  // Colorize: green
    COMMON_TEST_ASSERT(left < mPairs.getSize(), NgosStatus::ASSERTION);                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Check for the element at found position and update its value or insert new element                                                                                                                // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        MapElement<Key, Value> &element = mPairs[left];                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (element.getKey() == key)                                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            COMMON_ASSERT_EXECUTION(element.setValue(value), NgosStatus::ASSERTION);                                                                                                                     // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            COMMON_ASSERT_EXECUTION(mPairs.insert(left, MapElement(key, value)), NgosStatus::ASSERTION);                                                                                                 // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::OK;                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
NgosStatus Map<Key, Value>::remove(const Key &key)                                                                                                                                                       // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((" | key = ..."));                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Special cases to improve performance                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // If there is no any pair then there is no required entry                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            if (mPairs.isEmpty())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return NgosStatus::NOT_FOUND;                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the last key                                                                                                                                                                 // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &lastElement = mPairs.last();                                                                                                                                   // Colorize: green
            const Key                    &lastKey     = lastElement.getKey();                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key > lastKey)                                                                                                                                                                           // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return NgosStatus::NOT_FOUND;                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == lastKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                COMMON_ASSERT_EXECUTION(mPairs.removeAt(mPairs.getSize() - 1), NgosStatus::ASSERTION);                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return NgosStatus::OK;                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the first key                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &firstElement = mPairs.first();                                                                                                                                 // Colorize: green
            const Key                    &firstKey     = firstElement.getKey();                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key < firstKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return NgosStatus::NOT_FOUND;                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == firstKey)                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                COMMON_ASSERT_EXECUTION(mPairs.removeAt(0), NgosStatus::ASSERTION);                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                return NgosStatus::OK;                                                                                                                                                                   // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 left  = 0;                                                                                                                                                                                  // Colorize: green
    good_I64 right = mPairs.getSize();                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Binary search for the element                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (left < right)                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            good_I64 middle = (left + right) / 2;                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key <= mPairs.at(middle).getKey())                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                right = middle;                                                                                                                                                                          // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                left = middle + 1;                                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // COMMON_LVVV(("left  = %u", left));  // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
    // COMMON_LVVV(("right = %u", right)); // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(left == right,           NgosStatus::ASSERTION);                                                                                                                                  // Colorize: green
    COMMON_TEST_ASSERT(left < mPairs.getSize(), NgosStatus::ASSERTION);                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // If found element is the required element then remove it                                                                                                                                           // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (mPairs.at(left).getKey() == key)                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            COMMON_ASSERT_EXECUTION(mPairs.removeAt(left), NgosStatus::ASSERTION);                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            return NgosStatus::OK;                                                                                                                                                                       // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::NOT_FOUND;                                                                                                                                                                        // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
NgosStatus Map<Key, Value>::clear()                                                                                                                                                                      // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_ASSERT_EXECUTION(mPairs.clear(), NgosStatus::ASSERTION);                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::OK;                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
bool Map<Key, Value>::contains(const Key &key) const                                                                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((" | key = ..."));                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Special cases to improve performance                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // If there is no any pair then there is no required entry                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            if (mPairs.isEmpty())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return false;                                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the last key                                                                                                                                                                 // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &lastElement = mPairs.last();                                                                                                                                   // Colorize: green
            const Key                    &lastKey     = lastElement.getKey();                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key > lastKey)                                                                                                                                                                           // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return false;                                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == lastKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return true;                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the first key                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &firstElement = mPairs.first();                                                                                                                                 // Colorize: green
            const Key                    &firstKey     = firstElement.getKey();                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key < firstKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return false;                                                                                                                                                                            // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == firstKey)                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return true;                                                                                                                                                                             // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 left  = 0;                                                                                                                                                                                  // Colorize: green
    good_I64 right = mPairs.getSize();                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Binary search for the element                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (left < right)                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            good_I64 middle = (left + right) / 2;                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key <= mPairs.at(middle).getKey())                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                right = middle;                                                                                                                                                                          // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                left = middle + 1;                                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // COMMON_LVVV(("left  = %u", left));  // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
    // COMMON_LVVV(("right = %u", right)); // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(left == right,           false);                                                                                                                                                  // Colorize: green
    COMMON_TEST_ASSERT(left < mPairs.getSize(), false);                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return mPairs.at(left).getKey() == key;                                                                                                                                                              // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
const Value& Map<Key, Value>::value(const Key &key, const Value &defaultValue) const                                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | key = ..., defaultValue = ...")); // Commented to avoid too frequent logs                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Special cases to improve performance                                                                                                                                                              // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // If there is no any pair then there is no required entry                                                                                                                                       // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            if (mPairs.isEmpty())                                                                                                                                                                        // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return defaultValue;                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the last key                                                                                                                                                                 // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &lastElement = mPairs.last();                                                                                                                                   // Colorize: green
            const Key                    &lastKey     = lastElement.getKey();                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key > lastKey)                                                                                                                                                                           // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return defaultValue;                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == lastKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return lastElement.getValue();                                                                                                                                                           // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Compare key with the first key                                                                                                                                                                // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            const MapElement<Key, Value> &firstElement = mPairs.first();                                                                                                                                 // Colorize: green
            const Key                    &firstKey     = firstElement.getKey();                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key < firstKey)                                                                                                                                                                          // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return defaultValue;                                                                                                                                                                     // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key == firstKey)                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                return firstElement.getValue();                                                                                                                                                          // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 left  = 0;                                                                                                                                                                                  // Colorize: green
    good_I64 right = mPairs.getSize();                                                                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Binary search for the element                                                                                                                                                                     // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        while (left < right)                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            good_I64 middle = (left + right) / 2;                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            if (key <= mPairs.at(middle).getKey())                                                                                                                                                       // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                right = middle;                                                                                                                                                                          // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
            else                                                                                                                                                                                         // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                left = middle + 1;                                                                                                                                                                       // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // COMMON_LVVV(("left  = %u", left));  // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
    // COMMON_LVVV(("right = %u", right)); // Commented to avoid too frequent logs                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(left == right,           defaultValue);                                                                                                                                           // Colorize: green
    COMMON_TEST_ASSERT(left < mPairs.getSize(), defaultValue);                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // If found element is the required element then return its value                                                                                                                                    // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        const MapElement<Key, Value> &element = mPairs.at(left);                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        if (element.getKey() == key)                                                                                                                                                                     // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            return element.getValue();                                                                                                                                                                   // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return defaultValue;                                                                                                                                                                                 // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
good_I64 Map<Key, Value>::getSize() const                                                                                                                                                                // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT(("")); // Commented to avoid too frequent logs                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return mPairs.getSize();                                                                                                                                                                             // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
bool Map<Key, Value>::isEmpty() const                                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT(("")); // Commented to avoid too frequent logs                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return mPairs.isEmpty();                                                                                                                                                                             // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
template <typename Key, typename Value>                                                                                                                                                                  // Colorize: green
const ArrayList<MapElement<Key, Value>>& Map<Key, Value>::getPairs() const                                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT(("")); // Commented to avoid too frequent logs                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return mPairs;                                                                                                                                                                                       // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_COMMON_CONTAINERS_MAP_H                                                                                                                                                        // Colorize: green
