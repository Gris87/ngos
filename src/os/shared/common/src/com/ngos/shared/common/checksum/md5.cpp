#include "md5.h"                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/asm/bitutils.h>                                                                                                                                                                  // Colorize: green
#include <com/ngos/shared/common/log/assert.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/log/log.h>                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#define S11 7                                                                                                                                                                                            // Colorize: green
#define S12 12                                                                                                                                                                                           // Colorize: green
#define S13 17                                                                                                                                                                                           // Colorize: green
#define S14 22                                                                                                                                                                                           // Colorize: green
#define S21 5                                                                                                                                                                                            // Colorize: green
#define S22 9                                                                                                                                                                                            // Colorize: green
#define S23 14                                                                                                                                                                                           // Colorize: green
#define S24 20                                                                                                                                                                                           // Colorize: green
#define S31 4                                                                                                                                                                                            // Colorize: green
#define S32 11                                                                                                                                                                                           // Colorize: green
#define S33 16                                                                                                                                                                                           // Colorize: green
#define S34 23                                                                                                                                                                                           // Colorize: green
#define S41 6                                                                                                                                                                                            // Colorize: green
#define S42 10                                                                                                                                                                                           // Colorize: green
#define S43 15                                                                                                                                                                                           // Colorize: green
#define S44 21                                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline good_U32 F(good_U32 x, good_U32 y, good_U32 z)                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | x = %u, y = %u, z = %u", x, y, z)); // Commented to avoid too frequent logs                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return (x & y) | ((~x) & z);                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline good_U32 G(good_U32 x, good_U32 y, good_U32 z)                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | x = %u, y = %u, z = %u", x, y, z)); // Commented to avoid too frequent logs                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return (x & z) | (y & (~z));                                                                                                                                                                         // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline good_U32 H(good_U32 x, good_U32 y, good_U32 z)                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | x = %u, y = %u, z = %u", x, y, z)); // Commented to avoid too frequent logs                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return x ^ y ^ z;                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline good_U32 I(good_U32 x, good_U32 y, good_U32 z)                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | x = %u, y = %u, z = %u", x, y, z)); // Commented to avoid too frequent logs                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return y ^ (x | (~z));                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline void FF(good_U32 &a, good_U32 b, good_U32 c, good_U32 d, good_U32 x, good_U32 s, good_U32 ac)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | a = %u, b = %u, c = %u, d = %u, x = %u, s = %u, ac = %u", a, b, c, d, x, s, ac)); // Commented to avoid too frequent logs                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    a = BitUtils::rotateLeft32(a + F(b, c, d) + x + ac, s) + b;                                                                                                                                                      // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline void GG(good_U32 &a, good_U32 b, good_U32 c, good_U32 d, good_U32 x, good_U32 s, good_U32 ac)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | a = %u, b = %u, c = %u, d = %u, x = %u, s = %u, ac = %u", a, b, c, d, x, s, ac)); // Commented to avoid too frequent logs                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    a = BitUtils::rotateLeft32(a + G(b, c, d) + x + ac, s) + b;                                                                                                                                                      // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline void HH(good_U32 &a, good_U32 b, good_U32 c, good_U32 d, good_U32 x, good_U32 s, good_U32 ac)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | a = %u, b = %u, c = %u, d = %u, x = %u, s = %u, ac = %u", a, b, c, d, x, s, ac)); // Commented to avoid too frequent logs                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    a = BitUtils::rotateLeft32(a + H(b, c, d) + x + ac, s) + b;                                                                                                                                                      // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline void II(good_U32 &a, good_U32 b, good_U32 c, good_U32 d, good_U32 x, good_U32 s, good_U32 ac)                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | a = %u, b = %u, c = %u, d = %u, x = %u, s = %u, ac = %u", a, b, c, d, x, s, ac)); // Commented to avoid too frequent logs                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    a = BitUtils::rotateLeft32(a + I(b, c, d) + x + ac, s) + b;                                                                                                                                                      // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
MD5::MD5()                                                                                                                                                                                               // Colorize: green
    : mFinished(false)                                                                                                                                                                                   // Colorize: green
    , mBuffer()                                                                                                                                                                                          // Colorize: green
    , mCount(0)                                                                                                                                                                                          // Colorize: green
    , mResult(0xEFCDAB8967452301, 0x1032547698BADCFE)                                                                                                                                                    // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
MD5::~MD5()                                                                                                                                                                                              // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
Md5Hash MD5::md5(const good_U8 *data, good_I64 length)                                                                                                                                                   // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((" | data = 0x%p, length = %d", data, length));                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_ASSERT(data != nullptr, "data is null",      Md5Hash());                                                                                                                                      // Colorize: green
    COMMON_ASSERT(length >= 0,     "length is invalid", Md5Hash());                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    MD5 temp;                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_ASSERT_EXECUTION(temp.update(data, length), Md5Hash());                                                                                                                                       // Colorize: green
    COMMON_ASSERT_EXECUTION(temp.finish(),             Md5Hash());                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return temp.getResult();                                                                                                                                                                             // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
NgosStatus MD5::update(const good_U8 *data, good_I64 length)                                                                                                                                             // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((" | data = 0x%p, length = %d", data, length));                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_ASSERT(data != nullptr, "data is null",      NgosStatus::ASSERTION);                                                                                                                          // Colorize: green
    COMMON_ASSERT(length >= 0,     "length is invalid", NgosStatus::ASSERTION);                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(!mFinished, NgosStatus::ASSERTION);                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_I64 index;                                                                                                                                                                                      // Colorize: green
    good_I64 firstPart;                                                                                                                                                                                  // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Get index of mBuffer filling                                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        index     = (mCount / 8) % MD5_BLOCK_SIZE;                                                                                                                                                       // Colorize: green
        firstPart = MD5_BLOCK_SIZE - index;                                                                                                                                                              // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Validation                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        COMMON_LVVV(("index     = %d", index));                                                                                                                                                          // Colorize: green
        COMMON_LVVV(("firstPart = %d", firstPart));                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        COMMON_TEST_ASSERT(index     >= 0 && index     <  MD5_BLOCK_SIZE, NgosStatus::ASSERTION);                                                                                                         // Colorize: green
        COMMON_TEST_ASSERT(firstPart >= 0 && firstPart <= MD5_BLOCK_SIZE, NgosStatus::ASSERTION);                                                                                                         // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Fill mBuffer and perform transform on the filled data                                                                                                                                             // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        if (length >= firstPart)                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Complete mBuffer with the remaining bytes and perform transform on it                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                memcpy(&mBuffer[index], data, firstPart);                                                                                                                                                // Colorize: green
                COMMON_ASSERT_EXECUTION(transform(mBuffer), NgosStatus::ASSERTION);                                                                                                                      // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Transform blocks directly from data if we have enough data and put tail into mBuffer                                                                                                      // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                good_I64 blockIndex = firstPart;                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                while (blockIndex <= length - MD5_BLOCK_SIZE)                                                                                                                                            // Colorize: green
                {                                                                                                                                                                                        // Colorize: green
                    COMMON_ASSERT_EXECUTION(transform(&data[blockIndex]), NgosStatus::ASSERTION);                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                    blockIndex += MD5_BLOCK_SIZE;                                                                                                                                                        // Colorize: green
                }                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                memcpy(mBuffer, &data[blockIndex], length - blockIndex);                                                                                                                                 // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
        else                                                                                                                                                                                             // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            // Fill mBuffer with the provided data                                                                                                                                                       // Colorize: green
            memcpy(&mBuffer[index], data, length);                                                                                                                                                       // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Increment mCount with the length                                                                                                                                                                  // Colorize: green
    mCount += length * 8;                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::OK;                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
NgosStatus MD5::finish()                                                                                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    COMMON_LT((""));                                                                                                                                                                                     // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(!mFinished, NgosStatus::ASSERTION);                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    if (!mFinished)                                                                                                                                                                                      // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        good_U8        bits[8];                                                                                                                                                                                 // Colorize: green
        const good_I64 sizeOfBits = sizeof(bits);                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Fill bits with mCount                                                                                                                                                                         // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            COMMON_TEST_ASSERT(sizeOfBits == sizeof(mCount), NgosStatus::ASSERTION);                                                                                                                   // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            *reinterpret_cast<good_I64 *>(bits) = mCount;                                                                                                                                                // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Update with padded mBuffer and with the bits                                                                                                                                                  // Colorize: green
        {                                                                                                                                                                                                // Colorize: green
            static good_U8 padding[MD5_BLOCK_SIZE] =                                                                                                                                                     // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                0x80, 0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0,                                                                                                                                                               // Colorize: green
                0,    0, 0, 0, 0, 0, 0, 0                                                                                                                                                                // Colorize: green
            };                                                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            good_I64 index;                                                                                                                                                                              // Colorize: green
            good_I64 paddingLength;                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Calculate paddingLength                                                                                                                                                                   // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                index         = (mCount / 8) % MD5_BLOCK_SIZE;                                                                                                                                      // Colorize: green
                paddingLength = (index < MD5_BLOCK_SIZE - sizeOfBits) ? (MD5_BLOCK_SIZE - sizeOfBits - index) : ((MD5_BLOCK_SIZE * 2) - sizeOfBits - index);                                        // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            // Validation                                                                                                                                                                                // Colorize: green
            {                                                                                                                                                                                            // Colorize: green
                COMMON_LVVV(("index         = %d", index));                                                                                                                                              // Colorize: green
                COMMON_LVVV(("paddingLength = %d", paddingLength));                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                COMMON_TEST_ASSERT(index         >= 0 && index         <  MD5_BLOCK_SIZE, NgosStatus::ASSERTION);                                                                                         // Colorize: green
                COMMON_TEST_ASSERT(paddingLength >= 0 && paddingLength <= MD5_BLOCK_SIZE, NgosStatus::ASSERTION);                                                                                         // Colorize: green
            }                                                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
            COMMON_ASSERT_EXECUTION(update(padding, paddingLength), NgosStatus::ASSERTION);                                                                                                              // Colorize: green
            COMMON_ASSERT_EXECUTION(update(bits,    sizeOfBits),    NgosStatus::ASSERTION);                                                                                                              // Colorize: green
        }                                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        mFinished = true;                                                                                                                                                                                // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::OK;                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
Md5Hash MD5::getResult() const                                                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT(("")); // Commented to avoid too frequent logs                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(mFinished, Md5Hash());                                                                                                                                                            // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return mResult;                                                                                                                                                                                      // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
NgosStatus MD5::transform(const good_U8 *block)                                                                                                                                                          // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | block = 0x%p", block)); // Commented to avoid too frequent logs                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_ASSERT(block != nullptr, "block is null", NgosStatus::ASSERTION);                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    COMMON_TEST_ASSERT(!mFinished, NgosStatus::ASSERTION);                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    const good_U32 *x = reinterpret_cast<const good_U32 *>(block);                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    good_U32 a = mResult.dwords[0];                                                                                                                                                                      // Colorize: green
    good_U32 b = mResult.dwords[1];                                                                                                                                                                      // Colorize: green
    good_U32 c = mResult.dwords[2];                                                                                                                                                                      // Colorize: green
    good_U32 d = mResult.dwords[3];                                                                                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    // Perform MD5 hash calculation rounds                                                                                                                                                               // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        // Round 1                                                                                                                                                                                       // Colorize: green
        FF(a, b, c, d, x[0],  S11, 0xD76AA478); // 1                                                                                                                                                     // Colorize: green
        FF(d, a, b, c, x[1],  S12, 0xE8C7B756); // 2                                                                                                                                                     // Colorize: green
        FF(c, d, a, b, x[2],  S13, 0x242070DB); // 3                                                                                                                                                     // Colorize: green
        FF(b, c, d, a, x[3],  S14, 0xC1BDCEEE); // 4                                                                                                                                                     // Colorize: green
        FF(a, b, c, d, x[4],  S11, 0xF57C0FAF); // 5                                                                                                                                                     // Colorize: green
        FF(d, a, b, c, x[5],  S12, 0x4787C62A); // 6                                                                                                                                                     // Colorize: green
        FF(c, d, a, b, x[6],  S13, 0xA8304613); // 7                                                                                                                                                     // Colorize: green
        FF(b, c, d, a, x[7],  S14, 0xFD469501); // 8                                                                                                                                                     // Colorize: green
        FF(a, b, c, d, x[8],  S11, 0x698098D8); // 9                                                                                                                                                     // Colorize: green
        FF(d, a, b, c, x[9],  S12, 0x8B44F7AF); // 10                                                                                                                                                    // Colorize: green
        FF(c, d, a, b, x[10], S13, 0xFFFF5BB1); // 11                                                                                                                                                    // Colorize: green
        FF(b, c, d, a, x[11], S14, 0x895CD7BE); // 12                                                                                                                                                    // Colorize: green
        FF(a, b, c, d, x[12], S11, 0x6B901122); // 13                                                                                                                                                    // Colorize: green
        FF(d, a, b, c, x[13], S12, 0xFD987193); // 14                                                                                                                                                    // Colorize: green
        FF(c, d, a, b, x[14], S13, 0xA679438E); // 15                                                                                                                                                    // Colorize: green
        FF(b, c, d, a, x[15], S14, 0x49B40821); // 16                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Round 2                                                                                                                                                                                       // Colorize: green
        GG(a, b, c, d, x[1],  S21, 0xF61E2562); // 17                                                                                                                                                    // Colorize: green
        GG(d, a, b, c, x[6],  S22, 0xC040B340); // 18                                                                                                                                                    // Colorize: green
        GG(c, d, a, b, x[11], S23, 0x265E5A51); // 19                                                                                                                                                    // Colorize: green
        GG(b, c, d, a, x[0],  S24, 0xE9B6C7AA); // 20                                                                                                                                                    // Colorize: green
        GG(a, b, c, d, x[5],  S21, 0xD62F105D); // 21                                                                                                                                                    // Colorize: green
        GG(d, a, b, c, x[10], S22, 0x02441453); // 22                                                                                                                                                    // Colorize: green
        GG(c, d, a, b, x[15], S23, 0xD8A1E681); // 23                                                                                                                                                    // Colorize: green
        GG(b, c, d, a, x[4],  S24, 0xE7D3FBC8); // 24                                                                                                                                                    // Colorize: green
        GG(a, b, c, d, x[9],  S21, 0x21E1CDE6); // 25                                                                                                                                                    // Colorize: green
        GG(d, a, b, c, x[14], S22, 0xC33707D6); // 26                                                                                                                                                    // Colorize: green
        GG(c, d, a, b, x[3],  S23, 0xF4D50D87); // 27                                                                                                                                                    // Colorize: green
        GG(b, c, d, a, x[8],  S24, 0x455A14ED); // 28                                                                                                                                                    // Colorize: green
        GG(a, b, c, d, x[13], S21, 0xA9E3E905); // 29                                                                                                                                                    // Colorize: green
        GG(d, a, b, c, x[2],  S22, 0xFCEFA3F8); // 30                                                                                                                                                    // Colorize: green
        GG(c, d, a, b, x[7],  S23, 0x676F02D9); // 31                                                                                                                                                    // Colorize: green
        GG(b, c, d, a, x[12], S24, 0x8D2A4C8A); // 32                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Round 3                                                                                                                                                                                       // Colorize: green
        HH(a, b, c, d, x[5],  S31, 0xFFFA3942); // 33                                                                                                                                                    // Colorize: green
        HH(d, a, b, c, x[8],  S32, 0x8771F681); // 34                                                                                                                                                    // Colorize: green
        HH(c, d, a, b, x[11], S33, 0x6D9D6122); // 35                                                                                                                                                    // Colorize: green
        HH(b, c, d, a, x[14], S34, 0xFDE5380C); // 36                                                                                                                                                    // Colorize: green
        HH(a, b, c, d, x[1],  S31, 0xA4BEEA44); // 37                                                                                                                                                    // Colorize: green
        HH(d, a, b, c, x[4],  S32, 0x4BDECFA9); // 38                                                                                                                                                    // Colorize: green
        HH(c, d, a, b, x[7],  S33, 0xF6BB4B60); // 39                                                                                                                                                    // Colorize: green
        HH(b, c, d, a, x[10], S34, 0xBEBFBC70); // 40                                                                                                                                                    // Colorize: green
        HH(a, b, c, d, x[13], S31, 0x289B7EC6); // 41                                                                                                                                                    // Colorize: green
        HH(d, a, b, c, x[0],  S32, 0xEAA127FA); // 42                                                                                                                                                    // Colorize: green
        HH(c, d, a, b, x[3],  S33, 0xD4EF3085); // 43                                                                                                                                                    // Colorize: green
        HH(b, c, d, a, x[6],  S34, 0x04881D05); // 44                                                                                                                                                    // Colorize: green
        HH(a, b, c, d, x[9],  S31, 0xD9D4D039); // 45                                                                                                                                                    // Colorize: green
        HH(d, a, b, c, x[12], S32, 0xE6DB99E5); // 46                                                                                                                                                    // Colorize: green
        HH(c, d, a, b, x[15], S33, 0x1FA27CF8); // 47                                                                                                                                                    // Colorize: green
        HH(b, c, d, a, x[2],  S34, 0xC4AC5665); // 48                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        // Round 4                                                                                                                                                                                       // Colorize: green
        II(a, b, c, d, x[0],  S41, 0xF4292244); // 49                                                                                                                                                    // Colorize: green
        II(d, a, b, c, x[7],  S42, 0x432AFF97); // 50                                                                                                                                                    // Colorize: green
        II(c, d, a, b, x[14], S43, 0xAB9423A7); // 51                                                                                                                                                    // Colorize: green
        II(b, c, d, a, x[5],  S44, 0xFC93A039); // 52                                                                                                                                                    // Colorize: green
        II(a, b, c, d, x[12], S41, 0x655B59C3); // 53                                                                                                                                                    // Colorize: green
        II(d, a, b, c, x[3],  S42, 0x8F0CCC92); // 54                                                                                                                                                    // Colorize: green
        II(c, d, a, b, x[10], S43, 0xFFEFF47D); // 55                                                                                                                                                    // Colorize: green
        II(b, c, d, a, x[1],  S44, 0x85845DD1); // 56                                                                                                                                                    // Colorize: green
        II(a, b, c, d, x[8],  S41, 0x6FA87E4F); // 57                                                                                                                                                    // Colorize: green
        II(d, a, b, c, x[15], S42, 0xFE2CE6E0); // 58                                                                                                                                                    // Colorize: green
        II(c, d, a, b, x[6],  S43, 0xA3014314); // 59                                                                                                                                                    // Colorize: green
        II(b, c, d, a, x[13], S44, 0x4E0811A1); // 60                                                                                                                                                    // Colorize: green
        II(a, b, c, d, x[4],  S41, 0xF7537E82); // 61                                                                                                                                                    // Colorize: green
        II(d, a, b, c, x[11], S42, 0xBD3AF235); // 62                                                                                                                                                    // Colorize: green
        II(c, d, a, b, x[2],  S43, 0x2AD7D2BB); // 63                                                                                                                                                    // Colorize: green
        II(b, c, d, a, x[9],  S44, 0xEB86D391); // 64                                                                                                                                                    // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    mResult.dwords[0] += a;                                                                                                                                                                              // Colorize: green
    mResult.dwords[1] += b;                                                                                                                                                                              // Colorize: green
    mResult.dwords[2] += c;                                                                                                                                                                              // Colorize: green
    mResult.dwords[3] += d;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return NgosStatus::OK;                                                                                                                                                                               // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
