#ifndef COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                              // Colorize: green
#define COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/bits/flags.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/bits/macros.h>                                                                                                                                                          // Colorize: green
#include <com/ngos/shared/common/ngos/linkage.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/printf/printf.h>                                                                                                                                                        // Colorize: green
#include <com/ngos/shared/common/string/string.h>                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
// Verified with X86RegistersSpecVerifier [BEGIN] // https://cdrdv2.intel.com/v1/dl/getContent/671436                                                                                                    // Colorize: green
typedef good_U64 x86_flags;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
enum class X86Flag: x86_flags                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    NONE                                   = 0,                                                                                                                                                          // Colorize: green
    CARRY_FLAG                             = BIT_0,  // Set if an arithmetic operation generates a carry or a borrow out of the mostsignificant bit of the result; cleared otherwise               // Colorize: green
    FIXED                                  = BIT_1,  // Reserved, always 1 in EFLAGS                                                                                                               // Colorize: green
    PARITY_FLAG                            = BIT_2,  // Set if the least-significant byte of the result contains an even number of 1 bits; cleared otherwise                                       // Colorize: green
    AUXILIARY_CARRY_FLAG                   = BIT_4,  // Set if an arithmetic operation generates a carry or a borrow out of bit 3 of the result; cleared otherwise                                 // Colorize: green
    ZERO_FLAG                              = BIT_6,  // Set if the result is zero; cleared otherwise                                                                                               // Colorize: green
    SIGN_FLAG                              = BIT_7,  // Set equal to the most-significant bit of the result, which is the sign bit of a signed integer                                             // Colorize: green
    TRAP_FLAG                              = BIT_8,  // Set to enable single-step mode for debugging; clear to disable single-step mode                                                            // Colorize: green
    INTERRUPT_ENABLE_FLAG                  = BIT_9,  // Controls the response of the processor to maskable interrupt requests                                                                      // Colorize: green
    DIRECTION_FLAG                         = BIT_10, // Controls string instructions (MOVS, CMPS, SCAS, LODS, and STOS). Setting the DF flag causes the string instructions to auto-decrement (to process strings from high addresses to low addresses) // Colorize: green
    OVERFLOW_FLAG                          = BIT_11, // Set if the integer result is too large a positive number or too small a negative number (excluding the sign-bit) to fit in the destination operand; cleared otherwise // Colorize: green
    IO_PRIVELEGE_LEVEL_BIT_0               = BIT_12, // Indicates the I/O privilege level of the currently running program or task                                                                 // Colorize: green
    IO_PRIVELEGE_LEVEL_BIT_1               = BIT_13, // Indicates the I/O privilege level of the currently running program or task                                                                 // Colorize: green
    NESTED_TASK_FLAG                       = BIT_14, // Controls the chaining of interrupted and called tasks                                                                                      // Colorize: green
    RESUME_FLAG                            = BIT_16, // Controls the processor's response to debug exceptions                                                                                      // Colorize: green
    VIRTUAL_8086_MODE_FLAG                 = BIT_17, // Set to enable virtual-8086 mode; clear to return to protected mode without virtual-8086 mode semantics                                     // Colorize: green
    ALIGNMENT_CHECK_OR_ACCESS_CONTROL_FLAG = BIT_18, // If the AM bit is set in the CR0 register, alignment checking of user-mode data accesses is enabled if and only if this flag is 1           // Colorize: green
    VIRTUAL_INTERRUPT_FLAG                 = BIT_19, // Virtual image of the IF flag                                                                                                               // Colorize: green
    VIRTUAL_INTERRUPT_PENDING_FLAG         = BIT_20, // Set to indicate that an interrupt is pending; clear when no interrupt is pending                                                           // Colorize: green
    IDENTIFICATION_FLAG                    = BIT_21  // The ability of a program to set or clear this flag indicates support for the CPUID instruction                                             // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DEFINE_FLAGS(X86Flags, x86_flags); // TEST: NO                                                                                                                                                           // Colorize: green
// Verified with X86RegistersSpecVerifier [END] // https://cdrdv2.intel.com/v1/dl/getContent/671436                                                                                                      // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToString(X86Flag flag) // TEST: NO                                                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    switch (flag)                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        case X86Flag::NONE: return "NONE";                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        default: return "UNKNOWN";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToFullString(X86Flag flag) // TEST: NO                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[43];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    sprintf(res, "0x%08X (%s)", static_cast<x86_flags>(flag), flagToString(flag));                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToString(const X86Flags &flags) // TEST: NO                                                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[184];                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    FLAGS_TO_STRING(res, flags.flags, X86Flag);                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToFullString(const X86Flags &flags) // TEST: NO                                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[191];                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    FLAGS_TO_FULL_STRING(res, flags.flags, X86Flag, "0x%016llX");                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                            // Colorize: green
