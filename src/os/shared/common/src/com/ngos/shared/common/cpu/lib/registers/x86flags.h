#ifndef COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                              // Colorize: green
#define COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/flags.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/ngos/linkage.h>                                                                                                                                                         // Colorize: green
#include <com/ngos/shared/common/ngos/types.h>                                                                                                                                                           // Colorize: green
#include <com/ngos/shared/common/printf/printf.h>                                                                                                                                                        // Colorize: green
#include <com/ngos/shared/common/string/string.h>                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
typedef good_U32 x86_flags;                                                                                                                                                                              // Colorize: green
                                                                                                                                                                                                         // Colorize: green
enum class X86Flag: x86_flags // TODO: Validate with spec_verifier                                                                                                                                                                            // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    NONE                      = 0,                                                                                                                                                                       // Colorize: green
    CARRY_FLAG                = (1ULL << 0),  // Carry flag                                                                                                                                              // Colorize: green
    FIXED                     = (1ULL << 1),  // Reserved, always 1 in EFLAGS                                                                                                                            // Colorize: green
    PARITY_FLAG               = (1ULL << 2),  // Parity flag                                                                                                                                             // Colorize: green
    ADJUST_FLAG               = (1ULL << 4),  // Adjust flag                                                                                                                                             // Colorize: green
    ZERO_FLAG                 = (1ULL << 6),  // Zero flag                                                                                                                                               // Colorize: green
    SIGN_FLAG                 = (1ULL << 7),  // Sign flag                                                                                                                                               // Colorize: green
    TRAP_FLAG                 = (1ULL << 8),  // Trap flag (single step)                                                                                                                                 // Colorize: green
    INTERRUPT_ENABLE_FLAG     = (1ULL << 9),  // Interrupt enable flag                                                                                                                                   // Colorize: green
    DIRECTION_FLAG            = (1ULL << 10), // Direction flag                                                                                                                                          // Colorize: green
    OVERFLOW_FLAG             = (1ULL << 11), // Overflow flag                                                                                                                                           // Colorize: green
    IO_PRIVELEGE_LEVEL_BIT0   = (1ULL << 12), // I/O privilege level (286+ only), always 1[clarification needed] on 8086 and 186                                                                         // Colorize: green
    IO_PRIVELEGE_LEVEL_BIT1   = (1ULL << 13), // I/O privilege level (286+ only), always 1[clarification needed] on 8086 and 186                                                                         // Colorize: green
    NESTED_TASK_FLAG          = (1ULL << 14), // Nested task flag (286+ only), always 1 on 8086 and 186                                                                                                  // Colorize: green
    RESUME_FLAG               = (1ULL << 16), // Resume flag (386+ only)                                                                                                                                 // Colorize: green
    VIRTUAL_8086_MODE_FLAG    = (1ULL << 17), // Virtual 8086 mode flag (386+ only)                                                                                                                      // Colorize: green
    ALIGNMENT_CHECK           = (1ULL << 18), // Alignment check (486SX+ only)                                                                                                                           // Colorize: green
    VIRTUAL_INTERRUPT_FLAG    = (1ULL << 19), // Virtual interrupt flag (Pentium+)                                                                                                                       // Colorize: green
    VIRTUAL_INTERRUPT_PENDING = (1ULL << 20), // Virtual interrupt pending (Pentium+)                                                                                                                    // Colorize: green
    CPUID_SUPPORTED           = (1ULL << 21), // Able to use CPUID instruction (Pentium+)                                                                                                                // Colorize: green
};                                                                                                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
DEFINE_FLAGS(X86Flags, x86_flags); // TEST: NO                                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToString(X86Flag flag) // TEST: NO                                                                                                                                               // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    switch (flag)                                                                                                                                                                                        // Colorize: green
    {                                                                                                                                                                                                    // Colorize: green
        case X86Flag::NONE: return "NONE";                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
        default: return "UNKNOWN";                                                                                                                                                                       // Colorize: green
    }                                                                                                                                                                                                    // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagToFullString(X86Flag flag) // TEST: NO                                                                                                                                           // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flag = %u", flag)); // Commented to avoid bad looking logs                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[43];                                                                                                                                                                                // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    sprintf(res, "0x%08X (%s)", static_cast<x86_flags>(flag), flagToString(flag));                                                                                                                       // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToString(const X86Flags &flags) // TEST: NO                                                                                                                                     // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[184];                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    FLAGS_TO_STRING(res, flags.flags, X86Flag);                                                                                                                                                          // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
inline const char8* flagsToFullString(const X86Flags &flags) // TEST: NO                                                                                                                                 // Colorize: green
{                                                                                                                                                                                                        // Colorize: green
    // COMMON_LT((" | flags = ...")); // Commented to avoid bad looking logs                                                                                                                             // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    static char8 res[191];                                                                                                                                                                               // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    FLAGS_TO_FULL_STRING(res, flags.flags, X86Flag, "0x%08X");                                                                                                                                           // Colorize: green
                                                                                                                                                                                                         // Colorize: green
    return res;                                                                                                                                                                                          // Colorize: green
}                                                                                                                                                                                                        // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
                                                                                                                                                                                                         // Colorize: green
#endif // COM_NGOS_SHARED_COMMON_CPU_LIB_REGISTERS_X86FLAGS_H                                                                                                                                            // Colorize: green
