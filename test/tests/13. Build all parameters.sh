#!/bin/bash
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
#    PARAMETERS                                                                                                                                                                                          # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
CURRENT_PATH=`pwd`                                                                                                                                                                                       # Colorize: green
BUILD_CONFIG=include/buildconfig.h                                                                                                                                                                       # Colorize: green
BUILD_CFG_BACKUP=`mktemp -t ngos_test_buildconfig_XXXX.h`                                                                                                                                                # Colorize: green
BUILD_LOG=`mktemp -t ngos_test_build_XXXX.log`                                                                                                                                                           # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
#    FUNCTIONS                                                                                                                                                                                           # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
function run_build                                                                                                                                                                                       # Colorize: green
{                                                                                                                                                                                                        # Colorize: green
    echo "Building with $1"                                                                                                                                                                              # Colorize: green
                                                                                                                                                                                                         # Colorize: green
    tools/qt/build_config_maker/build/build_config_maker ${BUILD_CONFIG} --reset $1 >  ${BUILD_LOG} 2>&1                                                                                                         # Colorize: green
    make all                                                                        >> ${BUILD_LOG} 2>&1                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
    if [ $? -ne 0 ]; then                                                                                                                                                                                # Colorize: green
        cat ${BUILD_LOG}                                                                                                                                                                            # Colorize: green
                                                                                                                                                                                                         # Colorize: green
        cp ${BUILD_CFG_BACKUP} ${BUILD_CONFIG}                                                                                                                                                           # Colorize: green
        cd ${CURRENT_PATH}/                                                                                                                                                                               # Colorize: green
                                                                                                                                                                                                         # Colorize: green
        exit 1                                                                                                                                                                                           # Colorize: green
    fi                                                                                                                                                                                                   # Colorize: green
}                                                                                                                                                                                                        # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
#    PROCESSING                                                                                                                                                                                          # Colorize: green
###########################################################################################                                                                                                              # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
echo -e "\e[36m==================================================\e[0m"                                                                                                                                  # Colorize: green
echo -e "\e[36m           Test: Build all parameters\e[0m"                                                                                                                                               # Colorize: green
echo -e "\e[36m==================================================\e[0m"                                                                                                                                  # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
cd ../../                                                                                                                                                                                                # Colorize: green
cp ${BUILD_CONFIG} ${BUILD_CFG_BACKUP}                                                                                                                                                                   # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
make tool-build_config_maker > ${BUILD_LOG} 2>&1                                                                                                                                                                     # Colorize: green
                                                                                                                                                                                                         # Colorize: green
if [ $? -ne 0 ]; then                                                                                                                                                                                    # Colorize: green
    cat ${BUILD_LOG}                                                                                                                                                                                # Colorize: green
                                                                                                                                                                                                         # Colorize: green
    cp ${BUILD_CFG_BACKUP} ${BUILD_CONFIG}                                                                                                                                                               # Colorize: green
    cd ${CURRENT_PATH}/                                                                                                                                                                                   # Colorize: green
                                                                                                                                                                                                         # Colorize: green
    exit 1                                                                                                                                                                                               # Colorize: green
fi                                                                                                                                                                                                       # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_ARCH=OPTION_ARCH_X86_64                                                                                                                                                             # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_RELEASE=OPTION_YES                                                                                                                                                                  # Colorize: green
run_build NGOS_BUILD_RELEASE=OPTION_NO                                                                                                                                                                   # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_TEST_MODE=OPTION_NO                                                                                                                                                                 # Colorize: green
run_build NGOS_BUILD_TEST_MODE=OPTION_YES                                                                                                                                                                # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_OPTIMIZATION_LEVEL=OPTION_OPTIMIZATION_LEVEL_3                                                                                                                                      # Colorize: green
run_build NGOS_BUILD_OPTIMIZATION_LEVEL=OPTION_OPTIMIZATION_LEVEL_2                                                                                                                                      # Colorize: green
run_build NGOS_BUILD_OPTIMIZATION_LEVEL=OPTION_OPTIMIZATION_LEVEL_1                                                                                                                                      # Colorize: green
run_build NGOS_BUILD_OPTIMIZATION_LEVEL=OPTION_OPTIMIZATION_LEVEL_0                                                                                                                                      # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_KERNEL_COMPRESSION=OPTION_KERNEL_COMPRESSION_NONE                                                                                                                                   # Colorize: green
run_build NGOS_BUILD_KERNEL_COMPRESSION=OPTION_KERNEL_COMPRESSION_GZIP                                                                                                                                   # Colorize: green
run_build NGOS_BUILD_KERNEL_COMPRESSION=OPTION_KERNEL_COMPRESSION_XZ                                                                                                                                     # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_5_LEVEL_PAGING=OPTION_YES                                                                                                                                                           # Colorize: green
run_build NGOS_BUILD_5_LEVEL_PAGING=OPTION_NO                                                                                                                                                            # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_LOG_TO_SCREEN=OPTION_NO                                                                                                                                                             # Colorize: green
run_build NGOS_BUILD_LOG_TO_SCREEN=OPTION_YES                                                                                                                                                            # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_LOG_WITH_TIMESTAMP=OPTION_NO                                                                                                                                                        # Colorize: green
run_build NGOS_BUILD_LOG_WITH_TIMESTAMP=OPTION_YES                                                                                                                                                       # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_LOG_TO_UEFI_FILE=OPTION_YES                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_LOG_TO_UEFI_FILE=OPTION_NO                                                                                                                                                          # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_LOG_LEVEL=OPTION_LOG_LEVEL_FATAL                                                                                                                                                    # Colorize: green
run_build NGOS_BUILD_LOG_LEVEL=OPTION_LOG_LEVEL_TRACE                                                                                                                                                    # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_COMMON_LOG_LEVEL=OPTION_LOG_LEVEL_INHERIT                                                                                                                                           # Colorize: green
run_build NGOS_BUILD_COMMON_LOG_LEVEL=OPTION_LOG_LEVEL_FATAL                                                                                                                                             # Colorize: green
run_build NGOS_BUILD_COMMON_LOG_LEVEL=OPTION_LOG_LEVEL_TRACE                                                                                                                                             # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_UEFI_LOG_LEVEL=OPTION_LOG_LEVEL_INHERIT                                                                                                                                             # Colorize: green
run_build NGOS_BUILD_UEFI_LOG_LEVEL=OPTION_LOG_LEVEL_FATAL                                                                                                                                               # Colorize: green
run_build NGOS_BUILD_UEFI_LOG_LEVEL=OPTION_LOG_LEVEL_TRACE                                                                                                                                               # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_EARLY_LOG_LEVEL=OPTION_LOG_LEVEL_INHERIT                                                                                                                                            # Colorize: green
run_build NGOS_BUILD_EARLY_LOG_LEVEL=OPTION_LOG_LEVEL_FATAL                                                                                                                                              # Colorize: green
run_build NGOS_BUILD_EARLY_LOG_LEVEL=OPTION_LOG_LEVEL_TRACE                                                                                                                                              # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_REALTIME=OPTION_NO                                                                                                                                                                  # Colorize: green
run_build NGOS_BUILD_REALTIME=OPTION_YES                                                                                                                                                                 # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_LOWEST                                                                                                                                 # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_LOWER                                                                                                                                  # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_LOW                                                                                                                                    # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_MEDIUM                                                                                                                                 # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_HIGH                                                                                                                                   # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_HIGHER                                                                                                                                 # Colorize: green
run_build NGOS_BUILD_REALTIME_RAM_USAGE=OPTION_REALTIME_RAM_USAGE_HIGHEST                                                                                                                                # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_KERNEL_ALIGN=0x0000000000200000                                                                                                                                                     # Colorize: green
run_build NGOS_BUILD_KERNEL_ALIGN=0x0000000001000000                                                                                                                                                     # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_SSE2                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_SSE3                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_SSE4                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_AVX                                                                                                                      # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_AVX2                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_AVX_512_V1                                                                                                               # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_AVX_512_V2                                                                                                               # Colorize: green
run_build NGOS_BUILD_X86_64_VECTORIZATION_MODE=OPTION_X86_64_VECTORIZATION_MODE_AVX_512_V3                                                                                                               # Colorize: green
                                                                                                                                                                                                         # Colorize: green
run_build NGOS_BUILD_X86_64_FUSED_MULTIPLY_ADD=OPTION_X86_64_FUSED_MULTIPLY_ADD_NONE                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_FUSED_MULTIPLY_ADD=OPTION_X86_64_FUSED_MULTIPLY_ADD_FMA4                                                                                                                     # Colorize: green
run_build NGOS_BUILD_X86_64_FUSED_MULTIPLY_ADD=OPTION_X86_64_FUSED_MULTIPLY_ADD_FMA3                                                                                                                     # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
cp ${BUILD_CFG_BACKUP} ${BUILD_CONFIG}                                                                                                                                                                   # Colorize: green
cd ${CURRENT_PATH}/                                                                                                                                                                                       # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
                                                                                                                                                                                                         # Colorize: green
exit 0                                                                                                                                                                                                   # Colorize: green
